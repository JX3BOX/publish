{"version":3,"sources":["webpack:///./src/views/draft.vue?8198","webpack:///src/views/draft.vue","webpack:///./src/views/draft.vue?09b3","webpack:///./src/views/draft.vue","webpack:///./src/views/draft.vue?aec4"],"names":["component","_vm","this","_h","$createElement","_c","_self","staticClass","_m","attrs","isNotNull","on","clean","_v","_l","item","i","key","class","active","_s","_f","$event","stopPropagation","preview","del","slot"],"mappings":"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","file":"js/chunk-0210ea4e.7419e3ed.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"m-publish m-draft\"},[_c('div',{staticClass:\"m-draft-header\"},[_vm._m(0),_c('div',{staticClass:\"u-op\"},[_c('el-button',{attrs:{\"type\":\"danger\",\"plain\":\"\",\"icon\":\"el-icon-delete\",\"size\":\"small\",\"disabled\":!_vm.isNotNull},on:{\"click\":_vm.clean}},[_vm._v(\"清空\")])],1)]),(_vm.isSupported)?[_c('div',{staticClass:\"m-draft-warning\"},[_c('el-alert',{attrs:{\"title\":\"以下草稿为编辑器为该浏览器产生的临时本地草稿HTML源码，并不存在于服务器中，仅用于断网或窗口异常关闭时恢复。\",\"type\":\"warning\",\"show-icon\":\"\"}})],1),(_vm.isNotNull)?_c('div',{staticClass:\"m-draft-list\"},[_c('ul',{staticClass:\"u-list\"},_vm._l((_vm.data),function(item,i){return _c('li',{key:i,staticClass:\"u-item\"},[_c('div',{staticClass:\"u-label\",class:{ on: !!item.active }},[_c('i',{staticClass:\"u-item-icon\",class:!!item.active\n                                    ? 'el-icon-folder-opened'\n                                    : 'el-icon-folder'}),_c('span',{staticClass:\"u-item-key\"},[_vm._v(_vm._s(_vm._f(\"itemName\")(item)))]),_c('div',{staticClass:\"u-op\"},[_c('el-button',{staticClass:\"u-delete\",attrs:{\"type\":\"info\",\"icon\":\"el-icon-view\",\"size\":\"mini\"},on:{\"click\":function($event){$event.stopPropagation();return _vm.preview(item)}}},[_vm._v(\"预览\")]),_c('el-popconfirm',{attrs:{\"title\":\"确定删除吗？\"},on:{\"confirm\":function($event){return _vm.del(item, i)}}},[_c('el-button',{staticClass:\"u-delete\",attrs:{\"slot\":\"reference\",\"type\":\"danger\",\"icon\":\"el-icon-delete\",\"size\":\"mini\"},on:{\"click\":function($event){$event.stopPropagation();}},slot:\"reference\"},[_vm._v(\"删除\")])],1)],1)])])}),0)]):_c('div',{staticClass:\"m-draft-null\"},[_c('i',{staticClass:\"el-icon-warning-outline\"}),_vm._v(\" 暂无任何内容 \")])]:[_c('el-alert',{attrs:{\"title\":\"您的浏览器太旧了，不支持本功能。\",\"type\":\"error\",\"show-icon\":\"\"}})]],2)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('h1',{staticClass:\"m-title\"},[_c('i',{staticClass:\"el-icon-receiving\"}),_vm._v(\" 草稿箱 \"),_c('a',{staticClass:\"u-help\",attrs:{\"href\":\"/tool/21933\",\"target\":\"_blank\"}},[_c('i',{staticClass:\"el-icon-question\"}),_vm._v(\" 使用帮助 \")])])}]\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"m-publish m-draft\">\n        <div class=\"m-draft-header\">\n            <h1 class=\"m-title\">\n                <i class=\"el-icon-receiving\"></i> 草稿箱\n                <a class=\"u-help\" href=\"/tool/21933\" target=\"_blank\">\n                    <i class=\"el-icon-question\"></i> 使用帮助\n                </a>\n            </h1>\n            <div class=\"u-op\">\n                <el-button\n                    type=\"danger\"\n                    plain\n                    icon=\"el-icon-delete\"\n                    size=\"small\"\n                    @click=\"clean\"\n                    :disabled=\"!isNotNull\"\n                    >清空</el-button\n                >\n            </div>\n        </div>\n        <template v-if=\"isSupported\">\n            <div class=\"m-draft-warning\">\n                <el-alert\n                    title=\"以下草稿为编辑器为该浏览器产生的临时本地草稿HTML源码，并不存在于服务器中，仅用于断网或窗口异常关闭时恢复。\"\n                    type=\"warning\"\n                    show-icon\n                ></el-alert>\n            </div>\n            <div class=\"m-draft-list\" v-if=\"isNotNull\">\n                <ul class=\"u-list\">\n                    <li\n                        class=\"u-item\"\n                        v-for=\"(item, i) in data\"\n                        :key=\"i\"\n                    >\n                        <div class=\"u-label\" :class=\"{ on: !!item.active }\">\n                            <i\n                                class=\"u-item-icon\"\n                                :class=\"\n                                    !!item.active\n                                        ? 'el-icon-folder-opened'\n                                        : 'el-icon-folder'\n                                \"\n                            ></i>\n                            <span class=\"u-item-key\">{{ item | itemName }}</span>\n                            <div class=\"u-op\">\n                                <el-button\n                                    type=\"info\"\n                                    icon=\"el-icon-view\"\n                                    size=\"mini\"\n                                    class=\"u-delete\"\n                                    @click.stop=\"preview(item)\"\n                                    >预览</el-button\n                                >\n                                <el-popconfirm\n                                    title=\"确定删除吗？\"\n                                    @confirm=\"del(item, i)\"\n                                >\n                                    <el-button\n                                        slot=\"reference\"\n                                        type=\"danger\"\n                                        icon=\"el-icon-delete\"\n                                        size=\"mini\"\n                                        class=\"u-delete\"\n                                        @click.stop\n                                        >删除</el-button\n                                    >\n                                </el-popconfirm>\n                            </div>\n                        </div>\n                    </li>\n                </ul>\n            </div>\n            <div class=\"m-draft-null\" v-else>\n                <i class=\"el-icon-warning-outline\"></i> 暂无任何内容\n            </div>\n        </template>\n        <template v-else>\n            <el-alert\n                title=\"您的浏览器太旧了，不支持本功能。\"\n                type=\"error\"\n                show-icon\n            ></el-alert>\n        </template>\n    </div>\n</template>\n\n<script>\n// TINYMCE AUTOSAVE\nconst DRAFT_PREFIX = \"tinymce-autosave-\";\n\nexport default {\n    name: \"draft\",\n    props: [],\n    components: {},\n    data: function () {\n        return {\n            data: [],\n        };\n    },\n    computed: {\n        isSupported: function () {\n            return !!window.localStorage;\n        },\n        isNotNull: function () {\n            return !!this.data && !!this.data.length;\n        },\n        isWeb({ activeName }) {\n            return activeName === \"web\";\n        },\n        db() {\n            return this.$store.state.db\n        }\n    },\n    methods: {\n        // 加载\n        loadDrafts: async function () {\n            let len = await this.db.length();\n            for (let i = 0; i < len; i++) {\n                let key = await this.db.key(i);\n                // if (key.startsWith(DRAFT_PREFIX)) {\n                this.data.push({\n                    key,\n                    data: await this.db.getItem(key),\n                });\n                // }\n            }\n        },\n        // 清空\n        clean: function () {\n            this.$alert(\"此操作不可逆！请谨慎操作！\", \"警告\", {\n                confirmButtonText: \"确定清空\",\n                callback: (action) => {\n                    // 清空localstorage\n                    this.db.clear()\n                    // 清空缓存数据\n                    this.data = [];\n                    // 通知\n                    this.$notify({\n                        title: \"清空成功\",\n                        type: \"success\",\n                        message: `本地草稿清空成功`,\n                    });\n                },\n            });\n        },\n        // 预览\n        preview: function (item) {\n            this.$router.push(`/${item.data.post_type}/${item.data.ID}?mode=draft&key=${item.key}`)\n        },\n        // 删除\n        del: function (item, i) {\n            this.db.removeItem(item.key).then(() => {\n                this.data.splice(i, 1);\n            })\n        },\n        // 复制\n        onCopy: function (val) {\n            this.$notify({\n                title: \"复制成功\",\n                message: \"草稿源码复制成功\",\n                type: \"success\",\n            });\n        },\n        onError: function () {\n            this.$notify.error({\n                title: \"复制失败\",\n                message: \"请手动复制\",\n            });\n        },\n    },\n    filters: {\n        itemName(item) {\n            return item.data.post_title || `${item.key}(无标题)`\n        }\n    },\n    created: function () {\n        this.loadDrafts();\n    },\n    mounted: function () {},\n};\n</script>\n\n<style lang=\"less\">\n@import \"../assets/css/draft.less\";\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./draft.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./draft.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./draft.vue?vue&type=template&id=e79fddd2&\"\nimport script from \"./draft.vue?vue&type=script&lang=js&\"\nexport * from \"./draft.vue?vue&type=script&lang=js&\"\nimport style0 from \"./draft.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./draft.vue?vue&type=style&index=0&lang=less&\""],"sourceRoot":""}
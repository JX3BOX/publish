{"version":3,"sources":["webpack:///./src/post/collection.vue?980e","webpack:///./src/service/collection.js","webpack:///./src/components/publish_header.vue?17ab","webpack:///./src/components/publish_header.vue?814f","webpack:///src/components/publish_header.vue","webpack:///./src/components/publish_header.vue?3a87","webpack:///./src/components/publish_header.vue","webpack:///./src/service/face.js","webpack:///./src/post/collection.vue?94a8","webpack:///src/post/collection.vue","webpack:///./src/post/collection.vue?5d07","webpack:///./src/post/collection.vue"],"names":["qs","require","get_legal_tags","$helper","method","url","get_collection","collection_id","concat","get_my_collections","params","submit_collection","collection","data","stringify","action","id","remove_collection","appendToCollection","$cms","post","post_type","post_id","post_collection","title","post_title","name","props","computed","methods","goBack","window","history","length","$router","go","push","mounted","components","component","_c","this","_self","staticClass","attrs","on","_t","uploadFile","$next","addFace","getFace","get","updateFace","put","getFaceList","getAllFaceList","faceOnline","faceOffline","getAttachmentOfPost","postId","source_types","Object","assign","custom","__postType","__wikiType","face","jx3dat","notice","public","CollectionPublic","image","description","tags","posts","tag","legal_tags","show_description","processing","$route","tags_search","query","cb","_this","then","res","code","tags_filters","_step","output","_iterator","_createForOfIteratorHelper","s","n","done","value","split","err","e","f","title_fill","item","add_posts_item","type","search_handle","queryString","_res$data$data$list","list","reduce","acc","cur","get_posts_by_type","keyword","init","_this2","i","$message","message","submit","_this3","JSON","parse","console","log","lodash","setTimeout","location","href","getLink","finally","watch","immediate","handler","val","Tinymce","draggable","header","_vm","_v","model","callback","$$v","$set","expression","PUBLIC","_n","PRIVATE","_l","key","$event","splice","k","_e","trim","directives","rawName"],"mappings":"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","file":"js/chunk-127545a8.644e5248.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./collection.vue?vue&type=style&index=0&id=adc9fa18&prod&scoped=true&lang=less&\"","import { $helper, $cms } from \"@jx3box/jx3box-common/js/https.js\";\n\nconst qs = require(\"qs\");\n\nfunction get_legal_tags() {\n    return $helper()({\n        method: \"GET\",\n        url: `/api/post/collection/legal_tags`,\n    });\n}\n\nfunction get_collection(collection_id) {\n    return $helper()({\n        method: \"GET\",\n        url: `/api/post/collection/${collection_id}`,\n    });\n}\n\nfunction get_my_collections(params) {\n    return $helper()({\n        method: \"GET\",\n        url: `/api/my/post/collections`,\n        params: params,\n    });\n}\n\nfunction submit_collection(collection) {\n    return $helper()({\n        method: \"POST\",\n        url: `/api/post/collection`,\n        data: qs.stringify({\n            action: collection.id ? \"update\" : \"create\",\n            collection: collection,\n        }),\n    });\n}\n\nfunction remove_collection(collection_id) {\n    if (collection_id) {\n        return $helper()({\n            method: \"PUT\",\n            url: `/api/post/collection/remove`,\n            data: qs.stringify({ id: collection_id }),\n        });\n    } else return null;\n}\n\nfunction appendToCollection(data) {\n    return $cms().post(`/api/cms/post/${data.post_type}-${data.post_id}/append-to-collection/${data.post_collection}`, {\n        title: data.post_title,\n    });\n}\n\nexport { get_legal_tags, get_collection, get_my_collections, submit_collection, remove_collection, appendToCollection };\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_header.vue?vue&type=style&index=0&id=36319e52&prod&lang=less&\"","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_header.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_header.vue?vue&type=script&lang=js&\"","<template>\n    <div class=\"m-publish-header\">\n        <el-page-header @back=\"goBack\" :content=\"name\"></el-page-header>\n        <slot></slot>\n    </div>\n</template>\n\n<script>\nexport default {\n    name: \"publish_header\",\n    props: [\"name\"],\n    data: function() {\n        return {\n        };\n    },\n    computed: {},\n    methods: {\n        goBack: function() {\n            if(window.history.length){\n                this.$router.go(-1);\n            }else{\n                this.$router.push('/')\n            }\n        },\n    },\n    mounted: function() {},\n    components: {\n    },\n};\n</script>\n\n<style lang=\"less\">\n    .m-publish-header{\n        .pr;\n    }\n    \n</style>","import { render, staticRenderFns } from \"./publish_header.vue?vue&type=template&id=36319e52&\"\nimport script from \"./publish_header.vue?vue&type=script&lang=js&\"\nexport * from \"./publish_header.vue?vue&type=script&lang=js&\"\nimport style0 from \"./publish_header.vue?vue&type=style&index=0&id=36319e52&prod&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"m-publish-header\"},[_c('el-page-header',{attrs:{\"content\":_vm.name},on:{\"back\":_vm.goBack}}),_vm._t(\"default\")],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { $next } from \"@jx3box/jx3box-common/js/https\";\n\n/**\n * 上传付费附件\n * @param {*} data\n */\nexport function uploadFile(data) {\n    return $next().post(\"/api/face/file-upload\", data);\n}\n\n/**\n * 新增捏脸\n * @params {Object} data\n */\nexport function addFace(data) {\n    return $next().post(\"/api/face\", data);\n}\n\n/**\n * 获取捏脸数据\n * @params {*} id\n */\nexport function getFace(id) {\n    return $next().get(`/api/face/${id}`);\n}\n\n/**\n * 更新捏脸数据\n * @params {*} id\n * @params {*} data\n */\nexport function updateFace(id, data) {\n    return $next().put(`/api/face/${id}`, data);\n}\n\n/**\n * 移除关联作品\n * @param {*} id 附件id\n * @param {*} postType 作品类型\n * @param {*} postId 作品id\n */\nexport function attachmentRemoveRelatePost(id, postType, postId) {\n    return $next().delete(`/api/charge_attachment/${postType}/${postId}/${id}`);\n}\n\n/**\n * 获取捏脸列表\n * @param {*} params\n */\nexport function getFaceList(params) {\n    return $next().get(\"/api/face/my-list\", { params });\n}\n\n/**\n * 获取所有捏脸列表\n * @param {*} params\n */\nexport function getAllFaceList(params) {\n    return $next().get(\"/api/face\", { params });\n}\n\n/**\n * 上架一个捏脸数据\n * @param {*} id\n */\nexport function faceOnline(id) {\n    return $next().put(`/api/face/${id}/online`);\n}\n\n/**\n * 下架一个捏脸数据\n * @param {*} id\n */\nexport function faceOffline(id) {\n    return $next().put(`/api/face/${id}/offline`);\n}\n\n/**\n * 作品关联的附件\n * @param {*} postType 作品类型\n * @param {*} postId 作品id\n */\nexport function getAttachmentOfPost(postId) {\n    return $next().get(`/api/charge_attachment/face/${postId}/edit`);\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./collection.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./collection.vue?vue&type=script&lang=js&\"","<template>\n    <div class=\"m-publish-box\">\n        <!-- 头部 -->\n        <publish-header name=\"剑三小册\" :localDraft=\"false\">\n            <slot name=\"header\"></slot>\n        </publish-header>\n\n        <el-form label-position=\"left\" class=\"m-publish-collection\">\n            <!-- 💛 栏目字段 -->\n            <div class=\"m-publish-title\">\n                <el-divider content-position=\"left\">标题</el-divider>\n                <el-input\n                    v-model=\"collection.title\"\n                    placeholder=\"请输入小册标题\"\n                    maxlength=\"30\"\n                    show-word-limit\n                ></el-input>\n            </div>\n\n            <div class=\"m-publish-primary\">\n                <div class=\"m-publish-primary-block\">\n                    <el-divider content-position=\"left\">可见性</el-divider>\n                    <el-radio v-model.number=\"collection.public\" :label=\"this.public.PUBLIC\">公开</el-radio>\n                    <el-radio v-model.number=\"collection.public\" :label=\"this.public.PRIVATE\">私有</el-radio>\n                </div>\n                <div class=\"m-publish-primary-block m-publish-collection-posts\">\n                    <el-divider content-position=\"left\">内容</el-divider>\n                    <draggable\n                        class=\"m-list-style\"\n                        tag=\"ul\"\n                        v-if=\"collection.posts && collection.posts.length\"\n                        :list=\"collection.posts\"\n                        handle=\".u-move\"\n                    >\n                        <li v-for=\"(item, key) in collection.posts\" :key=\"key\" class=\"c-posts-item\">\n                            <i class=\"u-move el-icon-more\"></i>\n                            <i class=\"u-delete el-icon-close\" @click=\"collection.posts.splice(key, 1)\"></i>\n                            <el-row class=\"m-posts-item\" :gutter=\"10\">\n                                <el-col :span=\"4\" class=\"u-collection-type\">\n                                    <el-select\n                                        class=\"u-item-key\"\n                                        v-model=\"item.type\"\n                                        placeholder=\"请选择作品类型\"\n                                        @change=\"\n                                            () => {\n                                                search_handle(null, item);\n                                                item.url = item.title = '';\n                                            }\n                                        \"\n                                    >\n                                        <el-option\n                                            v-for=\"(type, k) in source_types\"\n                                            :label=\"type\"\n                                            :key=\"k\"\n                                            :value=\"k\"\n                                        ></el-option>\n                                    </el-select>\n                                </el-col>\n                                <el-col :span=\"8\" class=\"u-collection-id\">\n                                    <el-select\n                                        v-if=\"item.type !== 'custom'\"\n                                        class=\"u-item-value\"\n                                        v-model=\"item.id\"\n                                        filterable\n                                        remote\n                                        placeholder=\"通过输入作品标题进行搜索\"\n                                        :remote-method=\"\n                                            (query) => {\n                                                search_handle(query, item);\n                                            }\n                                        \"\n                                        @change=\"\n                                            (post_id) => {\n                                                title_fill(post_id, item);\n                                            }\n                                        \"\n                                    >\n                                        <template v-for=\"post in item.posts\">\n                                            <el-option\n                                                v-if=\"post.id && post.title\"\n                                                :key=\"post.id\"\n                                                :value=\"post.id\"\n                                                :label=\"post.title\"\n                                            ></el-option>\n                                        </template>\n                                    </el-select>\n                                    <el-input\n                                        class=\"u-item-value\"\n                                        placeholder=\"请输入完整网页链接（需以HTTP或HTTPS开头）\"\n                                        v-else\n                                        v-model.trim=\"item.url\"\n                                    ></el-input>\n                                </el-col>\n                                <el-col :span=\"12\" class=\"u-collection-url\" v-if=\"item.url\">\n                                    <el-input v-model=\"item.title\" placeholder=\"请输入自定义标题\"></el-input>\n                                </el-col>\n                            </el-row>\n                        </li>\n                    </draggable>\n                    <div v-else class=\"u-posts-items-empty\">暂无作品信息，请进行作品添加</div>\n                    <div class=\"u-posts-add\" @click=\"add_posts_item\">\n                        <i class=\"el-icon-plus\"></i>\n                        <span>添加作品</span>\n                    </div>\n                </div>\n\n                <div class=\"m-publish-primary-block m-publish-description\">\n                    <el-divider content-position=\"left\" @click=\"show_description = !show_description\"\n                        >描述（选填）</el-divider\n                    >\n                    <span v-if=\"!show_description\" @click=\"show_description = true\" class=\"u-show\">▼ 展开</span>\n                    <span v-if=\"show_description\" @click=\"show_description = false\" class=\"u-hide\">▲ 收起</span>\n                    <Tinymce\n                        v-show=\"show_description\"\n                        v-model=\"collection.description\"\n                        :attachmentEnable=\"true\"\n                        :resourceEnable=\"true\"\n                        :height=\"300\"\n                    />\n                </div>\n                <!-- <div class=\"m-publish-primary-block\">\n                    <publish-banner v-model=\"collection.image\"></publish-banner>\n                </div> -->\n\n                <!-- <div class=\"m-publish-primary-block m-publish-tags\">\n                    <el-divider content-position=\"left\">标签（选填）</el-divider>\n                    <ul class=\"m-list-style\">\n                        <li v-for=\"(t, key) in collection.tags\" :key=\"key\" class=\"m-tag\">\n                            <span v-text=\"t\"></span>\n                            <i class=\"el-icon-close\" @click=\"collection.tags.splice(key, 1)\"></i>\n                        </li>\n                    </ul>\n                    <div class=\"m-tag-add\" v-if=\"collection.tags.length < 5\">\n                        <el-autocomplete\n                            class=\"u-tag-add-value\"\n                            placeholder=\"请输入标签（最多为5个）\"\n                            v-model=\"tag\"\n                            :fetch-suggestions=\"tags_search\"\n                        ></el-autocomplete>\n                        <el-button\n                            class=\"u-tag-add\"\n                            @click=\"\n                                () => {\n                                    if (tag) collection.tags.push(tag);\n                                    tag = '';\n                                }\n                            \"\n                        >\n                            <i class=\"el-icon-plus\"></i>\n                        </el-button>\n                    </div>\n                </div>-->\n            </div>\n            <div class=\"m-publish-collection-publish\">\n                <el-button class=\"u-button\" type=\"primary\" @click=\"submit\" :loading=\"processing\" :disabled=\"processing\"\n                    >发 &nbsp;&nbsp; 布</el-button\n                >\n            </div>\n        </el-form>\n    </div>\n</template>\n\n<script>\nimport { __Root, __postType, __wikiType, __appType } from \"@jx3box/jx3box-common/data/jx3box.json\";\nimport Tinymce from \"@jx3box/jx3box-editor/src/Tinymce\";\nimport CollectionPublic from \"@jx3box/jx3box-editor/service/enum/CollectionPublic\";\nimport header from \"@/components/publish_header.vue\";\n// import publish_banner from \"@/components/publish_banner.vue\";\nimport draggable from \"vuedraggable\";\n\n// 本地依赖\nimport { get_legal_tags, get_collection, submit_collection } from \"../service/collection\";\nimport { get_posts_by_type } from \"../service/post\";\nimport { getAllFaceList } from \"@/service/face\";\nimport { getLink } from \"@jx3box/jx3box-common/js/utils\";\nimport lodash from \"lodash\";\n\nexport default {\n    name: \"collection\",\n    props: [],\n    data() {\n        // 作品类型加载\n        let source_types = Object.assign({ custom: \"自定义\" }, __postType, __wikiType, { face: \"捏脸\" });\n        delete source_types.jx3dat;\n        delete source_types.notice;\n\n        return {\n            source_types: source_types,\n            public: CollectionPublic,\n            // 剑三小册主体\n            collection: {\n                id: \"\",\n                title: \"\",\n                public: 1,\n                image: \"\",\n                description: \"\",\n                tags: [],\n                posts: [],\n            },\n            tag: \"\",\n            legal_tags: null,\n            show_description: true,\n            processing: false,\n        };\n    },\n    computed: {\n        id: function () {\n            return this.$route.params.collection_id;\n        },\n    },\n    methods: {\n        // 合法标签搜索仅请求数据一次\n        tags_search(query, cb) {\n            if (this.legal_tags === null) {\n                get_legal_tags().then((res) => {\n                    res = res.data;\n                    this.legal_tags = res.code === 200 ? res.data.tags : [];\n                    cb(this.tags_filters(query));\n                });\n            } else cb(this.tags_filters(query));\n        },\n        tags_filters(query) {\n            let output = [];\n            for (let tag of this.legal_tags) {\n                if (tag.split(query).length > 1) output.push({ value: tag });\n            }\n            return output;\n        },\n        // 帖子标题填充\n        title_fill(post_id, item) {\n            let post = item.posts[post_id];\n            item.title = post && post.title ? post.title : \"\";\n        },\n        add_posts_item() {\n            this.collection.posts.push({\n                title: \"\",\n                type: \"\",\n                id: \"\",\n                url: \"\",\n                posts: null,\n            });\n        },\n        search_handle(queryString, item) {\n            if (queryString === null) item.id = queryString = \"\";\n            if (item.type === 'face') {\n                getAllFaceList({\n                    title: queryString,\n\n                }).then(res => {\n                    item.posts = res.data.data.list?.reduce((acc, cur) => {\n                        acc[cur.id] = {\n                            id: cur.id,\n                            title: cur.title,\n                            type: 'face'\n                        }\n                        return acc\n                    }, {}) || {};\n                })\n            } else {\n                get_posts_by_type(item.type, {\n                    public: 1,\n                    keyword: queryString,\n                }).then((res) => {\n                    res = res.data;\n                    if (res.code === 200) {\n                        item.posts = res.data.posts;\n                    }\n                });\n            }\n        },\n        init: function () {\n            get_collection(this.id).then((res) => {\n                res = res.data;\n                if (res.code === 200) {\n                    let collection = res.data.collection;\n                    if (collection) {\n                        for (let i in collection.posts) {\n                            let item = collection.posts[i];\n                            collection.posts[i].posts =\n                                item.type === \"custom\" ? null : [{ id: item.id, title: item.title }];\n                        }\n                        this.collection = collection;\n                    } else {\n                        this.$message({\n                            message: \"该剑三小册已被删除或无权限访问\",\n                            type: \"warning\",\n                        });\n                    }\n                }\n            });\n        },\n        submit: function () {\n            // this.$confirm(\"确定提交剑三小册信息？\", \"提示\", {\n            //     type: \"info\",\n            // }).then(() => {\n            // 标题长度限制\n            // this.collection.title = this.collection.title.slice(0,40);\n\n            let collection = JSON.parse(JSON.stringify(this.collection));\n\n            if (!collection.posts) {\n                collection.posts = [];\n            }\n\n            // 去除多余字段\n            for (let i in collection.posts) delete collection.posts[i].posts;\n            collection.posts = JSON.stringify(collection.posts);\n\n            console.log(collection)\n\n            // return\n\n            this.processing = true;\n            submit_collection(collection)\n                .then((data) => {\n                    data = data.data;\n                    if (data.code === 200) {\n                        this.$message({\n                            message: data.message,\n                            type: \"success\",\n                        });\n                        let collection_id = lodash.get(data, \"data.collection.id\");\n                        let id = this.id || collection_id;\n                        setTimeout(() => {\n                            location.href = getLink(\"collection\", id);\n                        }, 500);\n                    } else {\n                        this.$message({\n                            message: `${data.message}`,\n                            type: \"warning\",\n                        });\n                    }\n                })\n                .finally(() => {\n                    this.processing = false;\n                });\n            // });\n        },\n    },\n    watch: {\n        id: {\n            immediate: true,\n            handler: function (val) {\n                val && this.init();\n            },\n        },\n    },\n    components: {\n        Tinymce,\n        draggable,\n        \"publish-header\": header,\n        // \"publish-banner\": publish_banner,\n    },\n};\n</script>\n\n<style scoped lang=\"less\">\n@import \"../assets/css/collection.less\";\n</style>\n","import { render, staticRenderFns } from \"./collection.vue?vue&type=template&id=adc9fa18&scoped=true&\"\nimport script from \"./collection.vue?vue&type=script&lang=js&\"\nexport * from \"./collection.vue?vue&type=script&lang=js&\"\nimport style0 from \"./collection.vue?vue&type=style&index=0&id=adc9fa18&prod&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"adc9fa18\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"m-publish-box\"},[_c('publish-header',{attrs:{\"name\":\"剑三小册\",\"localDraft\":false}},[_vm._t(\"header\")],2),_c('el-form',{staticClass:\"m-publish-collection\",attrs:{\"label-position\":\"left\"}},[_c('div',{staticClass:\"m-publish-title\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"标题\")]),_c('el-input',{attrs:{\"placeholder\":\"请输入小册标题\",\"maxlength\":\"30\",\"show-word-limit\":\"\"},model:{value:(_vm.collection.title),callback:function ($$v) {_vm.$set(_vm.collection, \"title\", $$v)},expression:\"collection.title\"}})],1),_c('div',{staticClass:\"m-publish-primary\"},[_c('div',{staticClass:\"m-publish-primary-block\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"可见性\")]),_c('el-radio',{attrs:{\"label\":this.public.PUBLIC},model:{value:(_vm.collection.public),callback:function ($$v) {_vm.$set(_vm.collection, \"public\", _vm._n($$v))},expression:\"collection.public\"}},[_vm._v(\"公开\")]),_c('el-radio',{attrs:{\"label\":this.public.PRIVATE},model:{value:(_vm.collection.public),callback:function ($$v) {_vm.$set(_vm.collection, \"public\", _vm._n($$v))},expression:\"collection.public\"}},[_vm._v(\"私有\")])],1),_c('div',{staticClass:\"m-publish-primary-block m-publish-collection-posts\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"内容\")]),(_vm.collection.posts && _vm.collection.posts.length)?_c('draggable',{staticClass:\"m-list-style\",attrs:{\"tag\":\"ul\",\"list\":_vm.collection.posts,\"handle\":\".u-move\"}},_vm._l((_vm.collection.posts),function(item,key){return _c('li',{key:key,staticClass:\"c-posts-item\"},[_c('i',{staticClass:\"u-move el-icon-more\"}),_c('i',{staticClass:\"u-delete el-icon-close\",on:{\"click\":function($event){return _vm.collection.posts.splice(key, 1)}}}),_c('el-row',{staticClass:\"m-posts-item\",attrs:{\"gutter\":10}},[_c('el-col',{staticClass:\"u-collection-type\",attrs:{\"span\":4}},[_c('el-select',{staticClass:\"u-item-key\",attrs:{\"placeholder\":\"请选择作品类型\"},on:{\"change\":() => {\n                                            _vm.search_handle(null, item);\n                                            item.url = item.title = '';\n                                        }},model:{value:(item.type),callback:function ($$v) {_vm.$set(item, \"type\", $$v)},expression:\"item.type\"}},_vm._l((_vm.source_types),function(type,k){return _c('el-option',{key:k,attrs:{\"label\":type,\"value\":k}})}),1)],1),_c('el-col',{staticClass:\"u-collection-id\",attrs:{\"span\":8}},[(item.type !== 'custom')?_c('el-select',{staticClass:\"u-item-value\",attrs:{\"filterable\":\"\",\"remote\":\"\",\"placeholder\":\"通过输入作品标题进行搜索\",\"remote-method\":(query) => {\n                                            _vm.search_handle(query, item);\n                                        }},on:{\"change\":(post_id) => {\n                                            _vm.title_fill(post_id, item);\n                                        }},model:{value:(item.id),callback:function ($$v) {_vm.$set(item, \"id\", $$v)},expression:\"item.id\"}},[_vm._l((item.posts),function(post){return [(post.id && post.title)?_c('el-option',{key:post.id,attrs:{\"value\":post.id,\"label\":post.title}}):_vm._e()]})],2):_c('el-input',{staticClass:\"u-item-value\",attrs:{\"placeholder\":\"请输入完整网页链接（需以HTTP或HTTPS开头）\"},model:{value:(item.url),callback:function ($$v) {_vm.$set(item, \"url\", (typeof $$v === 'string'? $$v.trim(): $$v))},expression:\"item.url\"}})],1),(item.url)?_c('el-col',{staticClass:\"u-collection-url\",attrs:{\"span\":12}},[_c('el-input',{attrs:{\"placeholder\":\"请输入自定义标题\"},model:{value:(item.title),callback:function ($$v) {_vm.$set(item, \"title\", $$v)},expression:\"item.title\"}})],1):_vm._e()],1)],1)}),0):_c('div',{staticClass:\"u-posts-items-empty\"},[_vm._v(\"暂无作品信息，请进行作品添加\")]),_c('div',{staticClass:\"u-posts-add\",on:{\"click\":_vm.add_posts_item}},[_c('i',{staticClass:\"el-icon-plus\"}),_c('span',[_vm._v(\"添加作品\")])])],1),_c('div',{staticClass:\"m-publish-primary-block m-publish-description\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"},on:{\"click\":function($event){_vm.show_description = !_vm.show_description}}},[_vm._v(\"描述（选填）\")]),(!_vm.show_description)?_c('span',{staticClass:\"u-show\",on:{\"click\":function($event){_vm.show_description = true}}},[_vm._v(\"▼ 展开\")]):_vm._e(),(_vm.show_description)?_c('span',{staticClass:\"u-hide\",on:{\"click\":function($event){_vm.show_description = false}}},[_vm._v(\"▲ 收起\")]):_vm._e(),_c('Tinymce',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.show_description),expression:\"show_description\"}],attrs:{\"attachmentEnable\":true,\"resourceEnable\":true,\"height\":300},model:{value:(_vm.collection.description),callback:function ($$v) {_vm.$set(_vm.collection, \"description\", $$v)},expression:\"collection.description\"}})],1)]),_c('div',{staticClass:\"m-publish-collection-publish\"},[_c('el-button',{staticClass:\"u-button\",attrs:{\"type\":\"primary\",\"loading\":_vm.processing,\"disabled\":_vm.processing},on:{\"click\":_vm.submit}},[_vm._v(\"发    布\")])],1)])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }"],"sourceRoot":""}
(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-d3aae0f0"],{3408:function(t,i,e){"use strict";e("6f23")},"6f23":function(t,i,e){},e4f6:function(t,i,e){"use strict";e.d(i,"f",(function(){return s})),e.d(i,"c",(function(){return l})),e.d(i,"g",(function(){return n})),e.d(i,"d",(function(){return o})),e.d(i,"a",(function(){return c})),e.d(i,"h",(function(){return u})),e.d(i,"e",(function(){return r})),e.d(i,"b",(function(){return d}));var a=e("41cb");function s(t){return Object(a.b)().post("/api/cms/post/emotion",t)}function n(t,i){return Object(a.b)().put("/api/cms/post/emotion/".concat(t),i)}function l(t){return Object(a.b)().get("/api/cms/post/emotion/".concat(t))}function o(t){return Object(a.b)().get("/api/cms/post/emotions/my",{params:t})}function c(t){return Object(a.b)().delete("/api/cms/post/emotion/".concat(t))}function u(t){return Object(a.b)().post("/api/cms/upload",t)}function r(t){return Object(a.b)().get("/api/cms/post/jokes/my",{params:t})}function d(t){return Object(a.b)().delete("/api/cms/post/joke/".concat(t))}},ef77:function(t,i,e){"use strict";var a={name:"publish_header",props:["name"],data:function(){return{}},computed:{},methods:{goBack:function(){this.$router.push("/")}},mounted:function(){},components:{}},s=e("2877"),n=Object(s.a)(a,(function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"m-publish-header"},[i("el-page-header",{attrs:{content:this.name},on:{back:this.goBack}}),this._t("default")],2)}),[],!1,null,null,null);i.a=n.exports},f18d:function(t,i,e){"use strict";e.r(i);e("d3b7"),e("159b"),e("b0c0"),e("99af"),e("a434");var a=e("85e4"),s=e("ef77"),n=e("9530"),l=e("e4f6"),o={name:"emotion",components:{UploadImages:n.a,"publish-header":s.a},data:function(){return{loading:!1,processing:!1,supportTypes:"image/png, image/jpeg, image/gif, image/bmp, image/webp",list:[],data:{},dialogImageUrl:"",dialogVisible:!1}},computed:{id:function(){return~~this.$route.params.id},fileInput:function(){return this.$refs.uploadInput}},methods:{init:function(){var t=this;this.loading=!0,Object(l.c)(this.id).then((function(i){var e;t.data=null==i||null===(e=i.data)||void 0===e?void 0:e.data})).finally((function(){t.loading=!1}))},updateFileList:function(t){var i=t.list,e=[];i.forEach((function(t){t.is_img&&e.push({desc:t.name,url:t.url,original:0,author:""})})),this.list=this.list.concat(e)},previewHandle:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},deleteHandle:function(t){this.list.splice(t,1)},publish:function(){var t=this;this.processing=!0,Object(l.f)(this.list).then((function(i){t.$message({message:"发布成功",type:"success"}),setTimeout((function(){location.href=Object(a.getLink)("emotion")}),500)})).finally((function(){t.processing=!1}))},update:function(){var t,i=this;null!==(t=this.data)&&void 0!==t&&t.url?(this.processing=!0,Object(l.g)(this.id,this.data).then((function(t){i.$message({message:"更新成功",type:"success"}),setTimeout((function(){location.href=Object(a.getLink)("emotion",i.id)}),500)})).finally((function(){i.processing=!1}))):this.$message({message:"图片不能为空",type:"warning"})},removePic:function(){this.data.url=""},select:function(){this.fileInput.dispatchEvent(new MouseEvent("click"))},upload:function(){var t=this,i=new FormData;i.append("file",this.fileInput.files[0]),Object(l.h)(i).then((function(i){t.data.url=i.data.data[0],t.$message({message:"上传成功",type:"success"}),t.fileInput.files=[]}))},handleRemove:function(){this.data.url=""}},watch:{"$route.params.id":{immediate:!0,handler:function(t){t&&this.init()}}},filters:{showThumbnail:function(t){return Object(a.getThumbnail)(t,146)}}},c=(e("3408"),e("2877")),u=Object(c.a)(o,(function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-publish-box m-publish-box-emotion"},[e("publish-header",{attrs:{name:"剑三表情"}}),e("el-form",{attrs:{"label-position":"left","label-width":"80px"}},[t.id?e("div",{staticClass:"m-publish-emotion m-publish-emotion-edit"},[e("el-form-item",{attrs:{label:"图片"}},[t.data&&t.data.url?e("div",{staticClass:"u-pic"},[e("img",{staticClass:"u-img",attrs:{src:t._f("showThumbnail")(t.data.url)}}),e("i",{staticClass:"u-mask"}),e("i",{staticClass:"u-preview",on:{click:function(i){return t.previewHandle(t.data)}}},[e("i",{staticClass:"el-icon-zoom-in"})])]):t._e(),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.data.url,expression:"!data.url"}],staticClass:"c-upload-logo"},[t.data&&t.data.url?e("div",{staticClass:"u-logo"},[e("img",{attrs:{src:t.data.url}}),e("i",{staticClass:"u-logo-mask"}),e("i",{staticClass:"u-logo-delete el-icon-delete",attrs:{title:"移除"},on:{click:t.handleRemove}})]):e("div",{staticClass:"u-upload el-upload el-upload--picture-card",on:{click:t.select}},[e("i",{staticClass:"el-icon-plus"})]),e("input",{ref:"uploadInput",staticClass:"u-upload-input",attrs:{type:"file"},on:{change:t.upload}})]),t.data&&t.data.url?e("el-button",{staticClass:"u-remove-btn",attrs:{icon:"el-icon-delete",size:"mini"},on:{click:t.removePic}},[t._v("移除")]):t._e()],1),e("el-form-item",{attrs:{label:"描述"}},[e("el-input",{attrs:{placeholder:"图片说明"},model:{value:t.data.desc,callback:function(i){t.$set(t.data,"desc",i)},expression:"data.desc"}})],1),e("el-form-item",{attrs:{label:"原创"}},[e("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:t.data.original,callback:function(i){t.$set(t.data,"original",t._n(i))},expression:"data.original"}})],1),e("el-form-item",{attrs:{label:"原作者"}},[e("el-input",{attrs:{placeholder:"（非必填）"},model:{value:t.data.author,callback:function(i){t.$set(t.data,"author",i)},expression:"data.author"}})],1),e("div",{staticClass:"m-publish-buttons"},[e("el-button",{attrs:{type:"primary",disabled:t.processing},on:{click:t.update}},[t._v("更    新")])],1)],1):e("div",{staticClass:"m-publish-emotion m-publish-emotion-create"},[e("div",{staticClass:"m-publish-emotion-bulk"},[e("h1",{staticClass:"u-title"},[t._v("上传表情")]),e("UploadImages",{attrs:{text:"批量上传图片",onlyImage:!0,desc:"一次最多同时上传10个文件（不超过5M）",accept:t.supportTypes},on:{insert:t.updateFileList}}),e("div",{staticClass:"u-tip"},[e("i",{staticClass:"el-icon-info"}),t._v(" 图片格式支持gif/png/jpg/bmp/webp ")])],1),t.list&&t.list.length?e("div",{staticClass:"m-publish-emotion-list"},[e("div",{staticClass:"u-list"},t._l(t.list,(function(i,a){return e("div",{key:a,staticClass:"u-item"},[e("div",{staticClass:"u-div"},[e("i",{staticClass:"u-order"},[t._v(t._s(a+1))]),e("div",{staticClass:"u-op"},[e("el-button",{staticClass:"u-delete",attrs:{icon:"el-icon-delete",type:"info",size:"mini"},on:{click:function(i){return t.deleteHandle(a)}}},[t._v("删除")])],1)]),e("div",{staticClass:"u-pic"},[e("img",{staticClass:"u-img",attrs:{src:t._f("showThumbnail")(i.url)}}),e("i",{staticClass:"u-mask"}),e("i",{staticClass:"u-preview",on:{click:function(e){return t.previewHandle(i)}}},[e("i",{staticClass:"el-icon-zoom-in"})])]),e("div",{staticClass:"u-desc"},[e("el-input",{attrs:{placeholder:"图片说明"},model:{value:i.desc,callback:function(e){t.$set(i,"desc",e)},expression:"item.desc"}},[e("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("描述")])])],1),e("div",{staticClass:"u-extend"},[e("el-switch",{attrs:{"inactive-text":"原创","active-value":1,"inactive-value":0},model:{value:i.original,callback:function(e){t.$set(i,"original",t._n(e))},expression:"item.original"}}),i.original?t._e():e("el-input",{staticClass:"u-author",attrs:{placeholder:"（非必填）",size:"mini"},model:{value:i.author,callback:function(e){t.$set(i,"author",e)},expression:"item.author"}},[e("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("原作者")])])],1)])})),0),e("div",{staticClass:"m-publish-buttons"},[e("el-button",{attrs:{type:"primary",disabled:t.processing},on:{click:t.publish}},[t._v("发    布")])],1)]):t._e()])]),e("el-dialog",{staticClass:"m-publish-emotion-preview",attrs:{visible:t.dialogVisible,title:"预览"},on:{"update:visible":function(i){t.dialogVisible=i}}},[e("img",{attrs:{src:t.dialogImageUrl}})])],1)}),[],!1,null,null,null);i.default=u.exports}}]);
//# sourceMappingURL=chunk-d3aae0f0.4656c879.js.map
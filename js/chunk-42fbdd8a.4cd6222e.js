(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-42fbdd8a"],{"0711":function(t,e,i){"use strict";var a={name:"",props:["data"],components:{},data:function(){return{visible:"0"}},model:{prop:"data",event:"update"},watch:{data:function(t){this.visible=t},visible:{deep:!0,handler:function(t){this.$emit("update",t)}}},computed:{},methods:{},filters:{},created:function(){},mounted:function(){}},n=(i("9b2a"),i("2877")),s=Object(n.a)(a,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-publish-visible"},[e("el-form-item",{attrs:{label:"阅读权限"}},[e("el-radio-group",{model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[e("el-radio",{attrs:{label:"0"}},[t._v("公开")]),e("el-radio",{attrs:{label:"1"}},[t._v("仅自己可见")]),e("el-radio",{attrs:{label:"2"}},[t._v("仅亲友可见")]),e("el-radio",{attrs:{label:"3",disabled:""}},[t._v("密码可见")]),e("el-radio",{attrs:{label:"4",disabled:""}},[t._v("付费可见")]),e("el-radio",{attrs:{label:"5",disabled:""}},[t._v("粉丝可见")])],1)],1)],1)}),[],!1,null,"509226a0",null);e.a=s.exports},"11ed":function(t,e,i){},1558:function(t,e,i){"use strict";i.r(e);var a=i("2909"),n=(i("ac1f"),i("5319"),i("d3b7"),i("159b"),i("14d9"),i("2ef0")),s=i.n(n),o=i("46d4"),l=i("c9d2"),c=i("221a"),r=i("e84a"),u=i("ef77"),d=i("d0a1"),p=i("1fb2"),m=i("505f"),f=i("d0b4"),h=i("d95e"),v=(i("b0c0"),i("a434"),i("25f0"),i("b64b"),i("d81d"),i("bd13")),b=i("65c2"),_=i("7c7e"),g=(i("841c"),i("caad"),i("2532"),i("99af"),i("85e4")),k=i("f475"),x=[function(){var t=this._self._c;return t("div",{staticClass:"u-title"},[t("span",{staticClass:"u-title-name"},[this._v("奇穴技能")]),t("img",{staticClass:"u-title-img",attrs:{src:i("590f"),alt:""}})])},function(){var t=this._self._c;return t("div",{staticClass:"u-title"},[t("span",{staticClass:"u-title-name"},[this._v("江湖轻功")]),t("img",{staticClass:"u-title-img",attrs:{src:i("590f"),alt:""}})])}],C=i("c7eb"),y=i("1da1"),I=i("3835"),D=(i("07ac"),i("a15b"),i("4fadc"),i("7db0"),i("4de4"),i("41cb")),w=D.g.create({baseURL:b.__dataPath});function O(){return j.apply(this,arguments)}function j(){return(j=Object(y.a)(Object(C.a)().mark((function t(){var e;return Object(C.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.get("talent/talents.json");case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var A=i("fc1a"),S=i("df53"),N=i("4397"),z={name:"pvp_martial",props:{subtype:{type:String,default:"通用"}},emits:[],data:function(){return{talents:[],data:[],loading:!1}},computed:{mountId:function(){var t;return null===(t=o[this.subtype])||void 0===t?void 0:t.id},client:function(){return this.$store.state.client},skillIds:function(){var t,e;return Object(n.flattenDeep)(Object.values(null===(t=this.kungfumap)||void 0===t||null===(e=t[this.mountId])||void 0===e?void 0:e.skills))},ids:function(){return[].concat(Object(a.a)(this.skillIds),Object(a.a)(this.talentSkillIds),Object(a.a)(this.commonIds)).join(",")},kungfumap:function(){return"origin"==this.client?S:A},params:function(){return{ids:this.ids,client:this.client}},talentSkillIds:function(){var t;return Object(n.flattenDeep)(this.mountId&&(null===(t=this.talents)||void 0===t?void 0:t[this.mountId]))||[]},commonIds:function(){return[9007,9003,9002,9005,9006,9004]},kungfusSkills:function(){var t=this,e={};return Object.entries(this.kungfumap[this.mountId].skills).forEach((function(i){var a=Object(I.a)(i,2),n=a[0],s=a[1];e[n]=s.map((function(e){return t.data.find((function(t){return t.SkillID==e}))}))})),e},kungfus:function(){return this.kungfumap[this.mountId].kungfus},talentSkills:function(){var t=this;return this.talentSkillIds.map((function(e){return t.data.find((function(t){return t.SkillID==e}))})).filter((function(t){return t&&0==t.IsPassiveSkill}))},commonSkills:function(){var t=this;return this.commonIds.map((function(e){return t.data.find((function(t){return t.SkillID==e}))})).filter(Boolean)}},mounted:function(){var t=this;return Object(y.a)(Object(C.a)().mark((function e(){return Object(C.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O();case 2:return t.talents=e.sent,e.next=5,t.loadSkills();case 5:case"end":return e.stop()}}),e)})))()},watch:{mountId:{handler:function(){this.loadSkills()}}},methods:{iconLink:g.iconLink,loadSkills:function(){var t=this;return Object(y.a)(Object(C.a)().mark((function e(){return Object(C.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.abrupt("return",(i=t.params,Object(D.d)().get("/skills",{params:i})).then((function(e){t.data=Object(n.uniqBy)(e.data,"Name")})).finally((function(){t.loading=!1})));case 2:case"end":return e.stop()}var i}),e)})))()},showKungfuName:function(t){return N[t]},selectSkill:function(t){this.$emit("selectSkill",t)},formatSkill:function(t){return t.filter((function(t){return null==t?void 0:t.SkillID}))}}},q=i("2877"),B={name:"skillDialog",components:{"pvp-martial":Object(q.a)(z,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-pvp-martial"},[t._l(t.kungfus,(function(a){return e("div",{key:a,staticClass:"m-martial-skill"},[e("div",{staticClass:"u-title"},[e("span",{staticClass:"u-title-name"},[t._v(t._s(t.showKungfuName(a)))]),e("img",{staticClass:"u-title-img",attrs:{src:i("590f"),alt:""}})]),t.kungfusSkills[a]?e("div",{staticClass:"m-skills"},t._l(t.formatSkill(t.kungfusSkills[a]),(function(i,a){return e("div",{key:a,staticClass:"m-skill",on:{click:function(e){return t.selectSkill(i)}}},[i&&i.IconID?e("div",{staticClass:"u-skill"},[e("img",{staticClass:"u-skill-icon",attrs:{src:t.iconLink(i.IconID),alt:i.IconID}}),e("span",{staticClass:"u-name",attrs:{title:i.Name}},[t._v(t._s(i.Name))])]):t._e()])})),0):t._e()])})),t.talentSkills&&t.talentSkills.length?e("div",{staticClass:"m-martial-skill"},[t._m(0),e("div",{staticClass:"m-skills"},t._l(t.talentSkills,(function(i,a){return e("div",{key:a,staticClass:"m-skill",on:{click:function(e){return t.selectSkill(i)}}},[i&&i.IconID?e("div",{staticClass:"u-skill"},[e("img",{staticClass:"u-skill-icon",attrs:{src:t.iconLink(i.IconID),alt:i.IconID}}),e("span",{staticClass:"u-name",attrs:{title:i.Name}},[t._v(t._s(i.Name))])]):t._e()])})),0)]):t._e(),e("div",{staticClass:"m-martial-skill"},[t._m(1),e("div",{staticClass:"m-skills"},t._l(t.commonSkills,(function(i,a){return e("div",{key:a,staticClass:"m-skill",on:{click:function(e){return t.selectSkill(i)}}},[i&&i.IconID?e("div",{staticClass:"u-skill"},[e("img",{staticClass:"u-skill-icon",attrs:{src:t.iconLink(i.IconID),alt:i.IconID}}),e("span",{staticClass:"u-name",attrs:{title:i.Name}},[t._v(t._s(i.Name))])]):t._e()])})),0)])],2)}),x,!1,null,null,null).exports},props:{modelValue:{type:Boolean,default:!1},subtype:{type:String,default:"通用"}},model:{prop:"modelValue",event:"update:modelValue"},data:function(){return{client:location.href.includes("origin")?"origin":"std",skill:[],done:!1,per:10,page:1,total:1,pages:1,query:"",activeName:"special",selected:[]}},computed:{hasNextPage:function(){return this.total>1&&this.page<this.pages},multipage:function(){return this.done&&this.pages>1},isBlank:function(){return!this.query&&!this.skill.length},buttonTXT:function(){return"确 定"}},methods:{getData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.query){this.loading=!0,this.per=10,this.done=!1;var a=this.query,n={strict:~~this.strict,per:this.per,page:e,client:this.client};Object(k.a)(a,n).then((function(e){i||(t.skill=[]);var a=t.transformData(e.list||[]);t.pages=e.pages,t.total=e.total,t.skill=t.skill.concat(a)})).finally((function(){t.done=!0,t.loading=!1}))}},selectSkill:function(t){this.selected.push(t)},removeSelected:function(t){this.selected.splice(t,1)},submit:function(){this.$emit("submit",this.selected),this.close(),this.selected=[]},close:function(){this.$emit("update:modelValue",!1)},iconURL:function(t){return Object(g.iconLink)(t,this.client)},filterRaw:function(t){return t&&t.replace(/\\n/g,"\n")},search:function(){this.page=1,this.getData()},appendPage:function(){this.getData(++this.page,!0)},changePage:function(t){this.getData(t)},transformData:function(t){return t.forEach((function(t){t.isSelected=!1})),t}}},$=Object(q.a)(B,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"c-large-dialog",attrs:{visible:t.modelValue,title:"技能库","append-to-body":"","custom-class":"m-skill-dialog"},on:{close:t.close}},[e("el-tabs",{staticClass:"m-skill-tabs",attrs:{type:"card"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:"门派武学",name:"special"},scopedSlots:t._u([{key:"label",fn:function(){return[e("div",{staticClass:"u-tab-label"},[e("i",{staticClass:"el-icon-s-order"}),e("b",[t._v("门派武学")])])]},proxy:!0}])}),e("el-tab-pane",{attrs:{label:"全部技能",name:"all"},scopedSlots:t._u([{key:"label",fn:function(){return[e("div",{staticClass:"u-tab-label"},[e("i",{staticClass:"el-icon-menu"}),e("b",[t._v("全部技能")])])]},proxy:!0}])})],1),e("div",{staticClass:"m-select-content"},[e("div",{directives:[{name:"show",rawName:"v-show",value:"all"===t.activeName,expression:"activeName === 'all'"}]},[e("div",{staticClass:"m-database-search"},[e("el-radio-group",{staticClass:"u-client",on:{change:t.search},model:{value:t.client,callback:function(e){t.client=e},expression:"client"}},[e("el-radio-button",{attrs:{label:"std"}},[t._v("重制")]),e("el-radio-button",{attrs:{label:"origin"}},[t._v("缘起")])],1),e("el-input",{staticClass:"u-input",attrs:{placeholder:"请输入 ID 或 名称"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search.apply(null,arguments)}},model:{value:t.query,callback:function(e){t.query=e},expression:"query"}},[e("template",{slot:"prepend"},[t._v("ID ／名称")])],2)],1),t.total&&t.done?e("div",{staticClass:"m-resource-count"},[e("i",{staticClass:"el-icon-s-data"}),t._v(" 共找到 "),e("b",[t._v(t._s(t.total))]),t._v(" 条记录 ")]):t._e(),e("ul",{staticClass:"m-resource-list"},t._l(t.skill,(function(i,a){return e("li",{key:a,ref:"skill",refInFor:!0,staticClass:"u-item",on:{click:function(e){return t.selectSkill(i,a)}}},[e("span",{staticClass:"u-id"},[t._v("ID:"+t._s(i.SkillID))]),e("img",{staticClass:"u-pic",attrs:{title:"IconID:"+i.IconID,src:t.iconURL(i.IconID)}}),e("span",{staticClass:"u-primary"},[e("span",{staticClass:"u-name"},[t._v(" "+t._s(i.Name)+" "),i.SkillName?e("em",[t._v("("+t._s(i.SkillName)+")")]):t._e()]),e("span",{staticClass:"u-content"},[t._v(" "+t._s(t.filterRaw(i.Desc))+" ")])])])})),0),!t.skill.length&&t.done?e("el-alert",{attrs:{title:"没有找到相关条目",type:"info","show-icon":""}}):t._e(),t.multipage?[e("el-button",{staticClass:"m-archive-more",class:{show:t.hasNextPage},attrs:{type:"primary",icon:"el-icon-arrow-down"},on:{click:t.appendPage}},[t._v("加载更多")]),e("el-pagination",{staticClass:"m-archive-pages",attrs:{background:"",layout:"total, prev, pager, next,jumper","hide-on-single-page":!0,"page-size":t.per,total:t.total,"current-page":t.page},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e},"current-change":t.changePage}})]:t._e(),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isBlank,expression:"isBlank"}],staticClass:"m-database-tip"},[t._v("❤ 请输入搜索条件查询")])],2),e("pvp-martial",{directives:[{name:"show",rawName:"v-show",value:"special"===t.activeName,expression:"activeName === 'special'"}],attrs:{subtype:t.subtype},on:{selectSkill:t.selectSkill}})],1),e("el-divider",[t._v("已选技能")]),e("div",{staticClass:"m-selected-skills"},[e("ul",{staticClass:"m-skills-list"},t._l(t.selected,(function(i,a){return e("li",{key:a,staticClass:"m-skill"},[i&&i.IconID?e("div",{staticClass:"u-skill"},[e("img",{staticClass:"u-skill-icon",attrs:{src:t.iconURL(i.IconID),alt:i.IconID}}),e("span",{staticClass:"u-name",attrs:{title:i.Name}},[t._v(t._s(i.Name))])]):t._e(),e("div",{staticClass:"u-mask",on:{click:function(e){return t.removeSelected(a)}}},[e("i",{staticClass:"el-icon-delete"})])])})),0)]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.close}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v(" "+t._s(t.buttonTXT)+" ")])],1)],1)}),[],!1,null,null,null).exports,R=i("aa47"),T=(i("e9c4"),i("31de")),P=(i("78c9"),i("1157")),E=i.n(P),G=i("c402"),W={name:"publish_qixue",props:{subtype:{type:String,default:"通用"},editable:{type:Boolean,default:!0},value:{type:String,default:""}},model:{prop:"value",event:"update"},data:function(){return{driver:null,version:"",sq:"1,1,1,1,1,1,1,1,1,1,1,1"}},watch:{value:{immediate:!0,deep:!0,handler:function(t){if(t)try{var e=JSON.parse(t);this.version=e.version,this.sq=e.sq,this.reloadTalent()}catch(t){console.log(t)}}},subtype:{immediate:!0,handler:function(t){this.reloadTalent()}}},mounted:function(){this.installTalent()},methods:{installTalent:function(){var t=this;Object(G.c)("pvp_talent_version").then((function(e){var i,a;t.version=t.version||(null===(i=e.data)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.html),t.driver=new T.a({version:t.version,editable:t.editable}),t.reloadTalent();var n=t;E()(document).on("JX3_QIXUE_Change",(function(t,e){var i={};i.version=e.version,i.xf=e.xf,i.sq=e.sq.join(","),n.$emit("update",JSON.stringify(i))}))}))},reloadTalent:function(){var t=this;this.subtype&&"通用"!=this.subtype&&this.$nextTick((function(){var e;t.driver&&(null===(e=t.driver)||void 0===e||e.then((function(e){e.load({xf:t.subtype,sq:t.sq})})))}))}}},L=Object(q.a)(W,(function(){this._self._c;return this._m(0)}),[function(){var t=this._self._c;return t("div",{staticClass:"m-publish-qixue"},[t("div",{staticClass:"m-talent-box qx-container"})])}],!1,null,null,null).exports,J={talent:"",talent_desc:"",content:"",combo:[{name:"",sq:[],desc:""}]},Y={name:"publishPvp",props:["data","client","subtype"],components:{SkillDialog:$,"publish-qixue":L},data:function(){return{maxlength:20,pvpData:this.data,activeIndex:"1",nickname:l.a.getInfo().name,zhNum:["一","二","三","四","五","六","七","八","九","十"],showSkillDialog:!1}},model:{prop:"data",event:"update"},watch:{data:{immediate:!0,deep:!0,handler:function(t){!t||Object(_.a)(t)?this.pvpData=Object(n.cloneDeep)(J):this.pvpData=t}},pvpData:{deep:!0,handler:function(t){this.$emit("update",t)}},activeIndex:{immediate:!0,handler:function(){var t=this;this.$nextTick((function(){t.initSkillSort()}))}}},methods:{addCombo:function(){if(this.pvpData.data.length>7)this.$alert("已经达到添加上限","消息",{confirmButtonText:"确定"});else{var t=this.pvpData.data.length+1+"";this.pvpData.data.push({name:"",sq:[],desc:""}),this.activeIndex=t}},removeCombo:function(t){var e=this;this.pvpData.data.length<2?this.$alert("必须保留1个宏","消息",{confirmButtonText:"确定"}):this.$alert("确定删除这个连招吗，删除后无法找回","消息",{confirmButtonText:"确定",callback:function(i){if("confirm"==i){var a=~~t-1;e.pvpData.data.splice(a,1),e.activeIndex="1"}}})},check:function(){this.pvpData.data.forEach((function(t,e){t.name||(t.name="未标题-"+e)}))},checkDataName:function(t){var e=Object(v.a)(t.name).removeSpace().kill().toString();e?this.$set(t,"name",e):this.$notify.error({title:"错误",message:"宏名称不允许包含特殊字符,不能为空"})},checkTalent:function(t){try{JSON.parse(t)}catch(t){this.$notify.error({title:"错误",message:"奇穴编码格式错误"})}},addSkill:function(){this.showSkillDialog=!0},removeSkill:function(t){this.pvpData.data[this.activeIndex-1].sq.splice(t,1)},onSubmit:function(t){var e;this.showSkillDialog=!1;var i=t.map((function(t){return Object(n.pick)(t,["SkillID","Name","IconID"])}));null===(e=this.pvpData.data[this.activeIndex-1].sq)||void 0===e||e.push.apply(e,Object(a.a)(i))},iconLink:g.iconLink,initSkillSort:function(){var t=document.querySelector(".tabs-sort .tab-content".concat(this.activeIndex," .u-skills"));if(t){var e=this;R.a.create(t,{animation:200,onEnd:function(t){var i=t.newIndex,a=t.oldIndex,s=Object(n.cloneDeep)(e.pvpData.data[e.activeIndex-1].sq),o=Object(n.cloneDeep)(s.splice(a,1)[0]);s.splice(i,0,o),e.pvpData.data[e.activeIndex-1].sq=[],e.$nextTick((function(){e.$set(e.pvpData.data[e.activeIndex-1],"sq",s)}))}})}},onContextmenu:function(t,e){var i=this;return this.$contextmenu({items:[{label:null!=e&&e.WithoutGcd?"设置为有GCD技能":"设置为无GCD技能",onClick:function(){i.$set(e,"WithoutGcd",!e.WithoutGcd)},icon:null!=e&&e.WithoutGcd?"el-icon-close":"el-icon-check"}],event:t,customClass:"custom-class",zIndex:3,minWidth:230}),!1}},mounted:function(){var t=document.querySelector(".tabs-sort .el-tabs__nav"),e=this;R.a.create(t,{animation:200,filter:".el-icon-close",onEnd:function(t){var i=t.newIndex,a=t.oldIndex,s=Object(n.cloneDeep)(e.pvpData.data),o=Object(n.cloneDeep)(s.splice(a,1)[0]);s.splice(i,0,o),e.pvpData.data=[],e.$nextTick((function(){e.$set(e.pvpData,"data",s)}))}})}},U=Object(q.a)(Y,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-publish-pvp m-publish-macro"},[e("el-divider",{attrs:{"content-position":"left"}},[t._v("技巧分享")]),e("div",{staticClass:"m-macro-box"},[e("div",{staticClass:"m-macro-talent m-macro-item"},[e("h5",{staticClass:"u-title"},[t._v("技巧概述")]),e("el-input",{attrs:{placeholder:"请在此处输入技巧概述，最多200个字。",type:"textarea","show-word-limit":"",maxlength:"200",rows:5},model:{value:t.pvpData.content,callback:function(e){t.$set(t.pvpData,"content",e)},expression:"pvpData.content"}})],1),"origin"!=t.client?e("div",{staticClass:"m-macro-talent m-macro-item"},[e("h5",{staticClass:"u-title"},[t._v("奇穴方案")]),e("publish-qixue",{attrs:{subtype:t.subtype},model:{value:t.pvpData.talent,callback:function(e){t.$set(t.pvpData,"talent",e)},expression:"pvpData.talent"}})],1):t._e(),"origin"===t.client?e("div",{staticClass:"m-macro-talent m-macro-item"},[e("h5",{staticClass:"u-title"},[t._v("镇派方案")]),t._m(0),e("el-input",{attrs:{placeholder:"镇派方案编码"},on:{change:function(e){return t.checkTalent(t.pvpData.talent)}},model:{value:t.pvpData.talent,callback:function(e){t.$set(t.pvpData,"talent",e)},expression:"pvpData.talent"}},[e("template",{slot:"prepend"},[e("a",{staticClass:"u-get",attrs:{target:"_blank",href:"/macro/talent2"}},[e("i",{staticClass:"el-icon-warning"}),t._v(" 获取编码 ")])])],2)],1):t._e(),e("div",{staticClass:"m-macro-talent m-macro-item"},[e("h5",{staticClass:"u-title"},[t._v(t._s("std"===t.client?"奇穴":"镇派")+"讲解")]),e("el-input",{attrs:{placeholder:"输入内容（选填）",type:"textarea","show-word-limit":"",maxlength:"400",rows:4},model:{value:t.pvpData.talent_desc,callback:function(e){t.$set(t.pvpData,"talent_desc",e)},expression:"pvpData.talent_desc"}})],1)]),e("div",{staticClass:"m-macro-box"},[e("div",{staticClass:"m-macro-header"},[e("el-button",{staticClass:"m-macro-addbutton",attrs:{icon:"el-icon-circle-plus-outline",type:"primary"},on:{click:t.addCombo}},[t._v("添加连招")])],1),e("el-tabs",{staticClass:"tabs-sort",attrs:{type:"card",closable:""},on:{"tab-remove":t.removeCombo},model:{value:t.activeIndex,callback:function(e){t.activeIndex=e},expression:"activeIndex"}},t._l(t.pvpData.data,(function(i,a){return e("el-tab-pane",{key:a,class:"tab-content".concat(a+1),attrs:{name:a+1+""}},[e("span",{staticClass:"u-tab-box",attrs:{slot:"label"},slot:"label"},[e("span",{staticClass:"u-tab-name",attrs:{title:i.name}},[t._v(t._s("连招"+t.zhNum[a]+" - "+i.name))])]),e("el-form-item",{staticClass:"m-macro-desc",attrs:{label:"连招名称"}},[e("el-input",{attrs:{placeholder:"请输入连招名称",minlength:1,maxlength:t.maxlength,"show-word-limit":""},on:{change:function(e){return t.checkDataName(i)}},model:{value:i.name,callback:function(e){t.$set(i,"name",e)},expression:"item.name"}})],1),e("el-form-item",{attrs:{label:"技能连招"}},[e("div",{staticClass:"u-skills"},[i.sq?t._l(i.sq,(function(i,a){return e("span",{key:i.SkillID+""+a,staticClass:"u-skill",on:{contextmenu:function(e){return e.preventDefault(),function(e){return t.onContextmenu(e,i)}.apply(null,arguments)}}},[e("img",{staticClass:"u-skill-icon",attrs:{src:t.iconLink(i.IconID),alt:i.IconID,title:i.Name}}),e("i",{directives:[{name:"show",rawName:"v-show",value:i.WithoutGcd,expression:"skill.WithoutGcd"}],staticClass:"u-gcd-icon"},[e("i",{staticClass:"el-icon-time"})]),e("i",{staticClass:"u-remove-icon",attrs:{title:"移除"},on:{click:function(e){return t.removeSkill(a)}}},[e("i",{staticClass:"el-icon-close"})])])})):t._e()],2),e("el-button",{attrs:{type:"primary",size:"medium",icon:"el-icon-plus"},on:{click:t.addSkill}},[t._v("新增技能")])],1),e("el-form-item",{staticClass:"m-macro-desc",attrs:{label:"连招说明"}},[e("el-input",{attrs:{type:"textarea",maxlength:"200",rows:3,"show-word-limit":"",placeholder:"连招简要说明（选填）"},model:{value:i.desc,callback:function(e){t.$set(i,"desc",e)},expression:"item.desc"}})],1),e("div",{staticClass:"m-macro-op"},[e("el-button",{staticClass:"u-macro-remove-fix",attrs:{type:"danger",plain:"",icon:"el-icon-delete",size:"small"},on:{click:function(e){return t.removeCombo(a+1)}}},[t._v("移除本连招")])],1)],1)})),1)],1),t._t("default"),e("skillDialog",{attrs:{subtype:t.subtype},on:{submit:t.onSubmit},model:{value:t.showSkillDialog,callback:function(e){t.showSkillDialog=e},expression:"showSkillDialog"}})],2)}),[function(){var t=this._self._c;return t("div",{staticClass:"m-macro-talent-simulator"},[t("div",{staticClass:"qx-container"})])}],!1,null,null,null).exports,F=i("b13e"),M=i("cc72"),X=i("0711"),V=i("db12"),Z=i("41de"),Q={name:"publish_extend",props:{post:{type:Object,default:function(){return{}}}},model:{prop:"post",event:"update"},data:function(){return{}},watch:{post:{immediate:!0,deep:!0,handler:function(t){}}}},H=Object(q.a)(Q,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-publish-extend"},[e("el-form-item",{attrs:{label:"其它"}},[e("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:t.post.include_video,callback:function(e){t.$set(t.post,"include_video",e)},expression:"post.include_video"}},[t._v("内含视频")])],1)],1)}),[],!1,null,null,null).exports,K=i("6c2b"),tt=i("4a9e"),et=i("bb78"),it=i("3c49"),at={name:"pvp_skill",mixins:[tt.a,et.a,it.a],components:{Tinymce:c.a,Markdown:r.a,"publish-header":u.a,"publish-title":d.a,"publish-original":p.a,"publish-zlp":f.a,"publish-xf":h.a,"publish-pvp":U,"publish-banner":F.a,"publish-comment":M.a,"publish-visible":X.a,"publish-authors":V.a,"publish-revision":Z.a,"publish-client":m.a,"publish-extend":H},data:function(){return{loading:!1,processing:!1,post:{ID:"",post_status:"publish",post_type:"pvp",post_title:"",post_subtype:"通用",post_meta:{talent:"",talent_desc:"",content:"",data:[{name:"",sq:[],desc:""}]},pz:[],post_content:"",post_mode:"tinymce",original:0,client:"std",lang:"cn",zlp:"",post_excerpt:"",post_banner:"",post_collection:"",collection_collapse:0,comment:0,comment_visible:0,allow_gift:1,visible:0,include_video:0}}},computed:{id:function(){return this.isRevision?~~this.post.post_id:~~this.post.ID},data:function(){return this.id?[this.id,this.post]:[this.post]},pz_query:function(){var t,e=null===(t=o[this.post.post_subtype])||void 0===t?void 0:t.id,i={};return e&&(i={mount:e}),i},isSuperAuthor:function(){return l.a.isSuperAuthor()}},watch:{"$route.query":{handler:function(t){null!=t&&t.subtype&&(this.post.post_subtype=t.subtype)},deep:!0,immediate:!0}},mounted:function(){var t=this.$route.params.id;t&&this.loadCommentConfig("post",t)},methods:{init:function(){var t=this;return sessionStorage.removeItem("atAuthor"),this.loadData().then((function(){t.autoSave()}))},publish:function(t,e){var i,n,s,o,l,c=this;return this.post.post_status=t,this.processing=!0,this.build(),this.post.post_meta.talent_desc=(null===(i=this.post.post_meta)||void 0===i||null===(n=i.talent_desc)||void 0===n?void 0:n.replace(/\n{2,}/g,"\n"))||"",this.post.post_meta.content=(null===(s=this.post.post_meta)||void 0===s||null===(o=s.content)||void 0===o?void 0:o.replace(/\n{2,}/g,"\n"))||"",null===(l=this.post.post_meta)||void 0===l||l.data.forEach((function(t){t.desc=t.desc.replace(/\n{2,}/g,"\n")||""})),G.k.apply(void 0,Object(a.a)(this.data)).then((function(t){var e=t.data.data;return c.setHasRead(),e})).then((function(t){c.afterPublish(t).finally((function(){c.done(e,t)})),c.setCommentConfig("post",t.ID)})).finally((function(){c.processing=!1}))},build:function(){this.post.meta_2=~~s.a.get(o[this.post.post_subtype],"id")||0},done:function(t,e){t?(this.$message({message:"发布成功",type:"success"}),setTimeout((function(){location.href="/pvp/"+(null==e?void 0:e.ID)}),500)):(this.$notify({title:"保存成功",message:"云端草稿保存成功",type:"success"}),this.post=e,this.$route.params.id||this.$router.push({params:{id:e.ID}}))},afterPublish:function(t){return~~t.post_collection?Object(K.a)({post_type:t.post_type,post_id:t.ID,post_collection:t.post_collection,post_title:t.post_title}):new Promise((function(t,e){t(!0)}))}}},nt=(i("ab6a"),Object(q.a)(at,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-publish-box p-publish-macro"},[e("publish-header",{attrs:{name:"竞技技巧"}},[e("publish-revision",{attrs:{enable:!0,"post-id":t.id}})],1),e("el-form",{attrs:{"label-position":"left","label-width":"80px"}},[e("publish-title",{model:{value:t.post.post_title,callback:function(e){t.$set(t.post,"post_title",e)},expression:"post.post_title"}}),e("div",{staticClass:"m-publish-info"},[e("el-divider",{attrs:{"content-position":"left"}},[t._v("信息")]),e("publish-original",{model:{value:t.post.original,callback:function(e){t.$set(t.post,"original",e)},expression:"post.original"}}),e("publish-client",{attrs:{forbidAll:!0,showMobile:!0},model:{value:t.post.client,callback:function(e){t.$set(t.post,"client",e)},expression:"post.client"}}),e("publish-zlp",{attrs:{client:t.post.client},model:{value:t.post.zlp,callback:function(e){t.$set(t.post,"zlp",e)},expression:"post.zlp"}}),e("publish-xf",{attrs:{client:t.post.client},model:{value:t.post.post_subtype,callback:function(e){t.$set(t.post,"post_subtype",e)},expression:"post.post_subtype"}}),e("publish-extend",{model:{value:t.post,callback:function(e){t.post=e},expression:"post"}})],1),e("publish-pvp",{attrs:{client:t.post.client,subtype:t.post.post_subtype},model:{value:t.post.post_meta,callback:function(e){t.$set(t.post,"post_meta",e)},expression:"post.post_meta"}}),e("div",{staticClass:"m-publish-content"},[e("el-divider",{attrs:{"content-position":"left"}},[t._v("正文")]),e("el-radio-group",{staticClass:"m-publish-editormode",attrs:{size:"small"},model:{value:t.post.post_mode,callback:function(e){t.$set(t.post,"post_mode",e)},expression:"post.post_mode"}},[e("el-radio-button",{attrs:{label:"tinymce"}},[t._v("可视化编辑器")]),e("el-radio-button",{attrs:{label:"markdown"}},[t._v("Markdown")])],1),e("Markdown",{directives:[{name:"show",rawName:"v-show",value:"markdown"==t.post.post_mode,expression:"post.post_mode == 'markdown'"}],attrs:{editable:!0,readOnly:!1},model:{value:t.post.post_content,callback:function(e){t.$set(t.post,"post_content",e)},expression:"post.post_content"}}),e("Tinymce",{directives:[{name:"show",rawName:"v-show",value:!t.post.post_mode||"tinymce"==t.post.post_mode,expression:"!post.post_mode || post.post_mode == 'tinymce'"}],attrs:{attachmentEnable:!0,resourceEnable:!0},model:{value:t.post.post_content,callback:function(e){t.$set(t.post,"post_content",e)},expression:"post.post_content"}})],1),e("div",{staticClass:"m-publish-extend"},[e("el-divider",{attrs:{"content-position":"left"}},[t._v("设置")]),e("publish-comment",{model:{value:t.post.comment,callback:function(e){t.$set(t.post,"comment",e)},expression:"post.comment"}},[e("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:t.visible_for_self,callback:function(e){t.visible_for_self=e},expression:"visible_for_self"}},[t._v("仅自己可见")]),e("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:t.open_white_list,callback:function(e){t.open_white_list=e},expression:"open_white_list"}},[t._v("开启评论过滤")])],1),e("publish-visible",{model:{value:t.post.visible,callback:function(e){t.$set(t.post,"visible",e)},expression:"post.visible"}}),e("publish-authors",{attrs:{id:t.id,uid:t.post.post_author}})],1),t.isSuperAuthor?e("div",{staticClass:"m-publish-other"},[e("publish-banner",{model:{value:t.post.post_banner,callback:function(e){t.$set(t.post,"post_banner",e)},expression:"post.post_banner"}})],1):t._e(),e("div",{staticClass:"m-publish-doc"},[e("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:t.hasRead,callback:function(e){t.hasRead=e},expression:"hasRead"}},[t._v("我已阅读并了解"),e("a",{attrs:{href:"/notice/119",target:"_blank"},on:{click:function(t){t.stopPropagation()}}},[t._v("《创作发布规范》")])])],1),e("div",{staticClass:"m-publish-buttons"},[t.isDraft||t.isRevision?[e("el-button",{attrs:{type:"primary",disabled:t.processing},on:{click:t.useDraft}},[t._v("使用此版本")])]:[e("el-button",{attrs:{type:"primary",disabled:t.processing||!t.hasRead},on:{click:function(e){return t.publish("publish",!0)}}},[t._v("发    布")]),e("el-button",{attrs:{type:"plain",disabled:t.processing||!t.hasRead},on:{click:function(e){return t.publish("draft",!1)}}},[t._v("保存为草稿")])]],2)],1)],1)}),[],!1,null,null,null));e.default=nt.exports},"1fb2":function(t,e,i){"use strict";var a={name:"publish_original",props:["data"],data:function(){return{original:~~this.data}},model:{prop:"data",event:"update"},watch:{data:function(t){this.original=~~t},original:{deep:!0,handler:function(t){this.$emit("update",~~t)}}},computed:{},methods:{},mounted:function(){},components:{}},n=i("2877"),s=Object(n.a)(a,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-publish-original"},[e("el-form-item",{attrs:{label:"原创"}},[e("el-switch",{attrs:{"active-color":"#13ce66","active-value":1,"inactive-value":0},model:{value:t.original,callback:function(e){t.original=e},expression:"original"}})],1),t._t("default")],2)}),[],!1,null,null,null);e.a=s.exports},"1fb9":function(t){t.exports=JSON.parse('{"b":300000,"a":30000}')},"263c":function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return s})),i.d(e,"c",(function(){return o})),i.d(e,"d",(function(){return l})),i.d(e,"f",(function(){return r})),i.d(e,"e",(function(){return c}));i("99af");var a=i("41cb"),n=function(t,e){return Object(a.a)().post("/api/cms/post/".concat(t,"/revision"),e)},s=function(t,e){return Object(a.a)().get("/api/cms/post/".concat(t,"/revision/").concat(e))},o=function(t,e){return Object(a.a)().get("/api/cms/post/".concat(t,"/revisions"),{params:e})},l=function(t,e,i){return Object(a.a)().put("/api/cms/post/".concat(t,"/revision/").concat(e),i)},c=function(t,e){return Object(a.a)().delete("/api/cms/post/".concat(t,"/revision/").concat(e))},r=function(t,e){return Object(a.a)().delete("/api/cms/post/".concat(t,"/revisions?list=").concat(e))}},"354c":function(t,e,i){},"3c49":function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var a=i("c7eb"),n=i("1da1"),s=(i("b64b"),i("99af"),i("41cb"));var o,l=i("c9d2"),c={computed:{userInfo:function(){return l.a.getInfo()}},methods:{atUser:(o=Object(n.a)(Object(a.a)().mark((function t(e){var i;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!(i=sessionStorage.getItem("atAuthor"))){t.next=6;break}return t.next=5,a={sendUserId:this.userInfo.uid,accessUserId:JSON.parse(i),postId:e||this.id,postType:this.post.post_type},n=void 0,o=void 0,l=void 0,c=void 0,n=a.sendUserId,o=a.accessUserId,l=a.postId,c=a.postType,Object(s.e)({mute:!0}).get("/api/horn/".concat(n,"/to/user/article/").concat(c,"/").concat(l),{params:{accessUserId:o}});case 5:sessionStorage.removeItem("atAuthor");case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0);case 11:case"end":return t.stop()}var a,n,o,l,c}),t,this,[[0,8]])}))),function(t){return o.apply(this,arguments)})}}},"3efa":function(t,e,i){"use strict";i("11ed")},"41de":function(t,e,i){"use strict";i("a9e3"),i("fb6a"),i("d3b7"),i("d81d"),i("14d9"),i("4de4"),i("b0c0"),i("99af"),i("a15b");var a=i("263c"),n=i("e4f1"),s={name:"publish_revision",props:{postId:{type:[String,Number],default:0},visible:{type:Boolean,default:!0},enable:{type:Boolean,default:!1}},data:function(){return{show:!1,data:[],per:10,page:1,total:0,loading:!1,checked:[],checkedAll:!1,isIndeterminate:!1}},computed:{params:function(){return{page:this.page,per:this.per}},isPostMode:function(){return!this.$route.query.mode||"default"==this.$route.query.mode},ready:function(){return this.enable&&this.postId&&this.isPostMode}},filters:{revisionName:function(t){return"版本".concat(t.version)},formatDate:function(t){return Object(n.c)(new Date(t))}},methods:{formatRemark:function(t){return(null==t?void 0:t.length)>10?t.slice(0,10)+"..":t},view:function(){this.postId&&(this.show=!0,this.loadList())},loadList:function(){var t=this;this.loading=!0,Object(a.c)(this.postId,this.params).then((function(e){t.data=e.data.data.list.map((function(e){return t.$set(e,"checked",!1),e})),t.page=e.data.data.page,t.per=e.data.data.per,t.total=e.data.data.total})).finally((function(){t.loading=!1}))},remark:function(t){var e=this;this.$prompt("请输入备注","提示",{confirmButtonText:"确定",cancelButtonText:"取消",closeOnClickModal:!1,inputValue:t.remark||""}).then((function(i){var n=i.value;Object(a.d)(e.postId,t.id,{remark:n}).then((function(){return e.$message.success("备注添加成功"),t.remark=n,!0})).catch((function(){return!1}))}))},checkChange:function(t,e){t?this.checked.push(e.id):this.checked=this.checked.filter((function(t){return t!==e.id})),this.checkedAll=this.checked.length===this.data.length},checkAll:function(t){t?(this.checked=this.data.map((function(t){return t.id})),this.data.map((function(t){return t.checked=!0,t}))):(this.checked=[],this.data.map((function(t){return t.checked=!1,t}))),this.isIndeterminate=!1,console.log(this.checked)},use:function(t){var e=this.$route.name;this.$router.push("/".concat(e,"/").concat(t.post_id,"/?mode=revision&id=").concat(t.id))},del:function(t){var e=this;this.$confirm("确认删除【版本-".concat(t.version,"】吗？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(a.e)(e.postId,t.id).then((function(){e.$notify({type:"success",title:"成功",message:"历史版本删除成功"}),e.loadList()}))}))},delRevisions:function(){var t=this;this.$confirm("确认删除选中的历史版本？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e=t.checked.join(",");Object(a.f)(t.postId,e).then((function(){t.$notify({type:"success",title:"成功",message:"历史版本删除成功"}),t.checkedAll=!1,t.checked=[],1===t.page?t.loadList():t.page=1}))}))}},watch:{params:{deep:!0,handler:function(){this.loadList()}}}},o=(i("3efa"),i("2877")),l=Object(o.a)(s,(function(){var t=this,e=t._self._c;return t.ready?e("div",{staticClass:"m-revision"},[e("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-folder"},on:{click:t.view}},[t._v("历史版本")]),e("el-drawer",{staticClass:"m-revision-drawer",attrs:{title:"历史版本",visible:t.show,"z-index":"2100","append-to-body":""},on:{"update:visible":function(e){t.show=e}}},[e("h3",{staticClass:"u-revision-title",attrs:{slot:"title"},slot:"title"},[t._v("历史版本")]),e("main",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-revision-container"},[e("div",{staticClass:"u-actions"},[e("el-checkbox",{attrs:{indeterminate:t.isIndeterminate},on:{change:t.checkAll},model:{value:t.checkedAll,callback:function(e){t.checkedAll=e},expression:"checkedAll"}},[t._v("全选")]),e("el-button",{staticClass:"u-empty",attrs:{size:"mini",plain:"",icon:"el-icon-delete",disabled:!t.checked||!t.checked.length},on:{click:t.delRevisions}},[t._v("批量删除")])],1),e("div",{staticClass:"m-revision-list"},[t.data&&t.data.length?e("ul",{staticClass:"u-list"},[t._l(t.data,(function(i,a){return e("li",{key:a,staticClass:"m-revision-item"},[e("span",{staticClass:"u-name"},[e("el-checkbox",{staticClass:"u-checkbox",on:{change:function(e){return t.checkChange(e,i)}},model:{value:i.checked,callback:function(e){t.$set(i,"checked",e)},expression:"item.checked"}}),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:i.remark,placement:"top",disabled:!i.remark}},[e("span",[e("i",{staticClass:"u-icon el-icon-tickets"}),e("span",{staticClass:"u-remark"},[t._v(t._s(i.remark?t.formatRemark(i.remark):i.post_title))])])]),e("em",{staticClass:"u-time"},[t._v(t._s(t._f("formatDate")(i.updated_at)))]),i.user_info?e("span",{staticClass:"u-creator",attrs:{title:"创建人"}},[t._v(t._s(i.user_info.display_name))]):t._e(),e("i",{staticClass:"u-edit el-icon-edit",attrs:{title:"添加备注"},on:{click:function(e){return t.remark(i)}}})],1),e("el-button-group",[e("el-button",{attrs:{size:"mini",icon:"el-icon-view",title:"预览"},on:{click:function(e){return t.use(i)}}}),e("el-button",{attrs:{size:"mini",icon:"el-icon-delete",title:"删除"},on:{click:function(e){return t.del(i)}}})],1)],1)})),e("el-pagination",{staticClass:"u-pagination",attrs:{background:"","hide-on-single-page":"",layout:"prev,pager,next,->,total",total:t.total,"page-size":t.per,"current-page":t.page},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e}}})],2):e("el-alert",{staticClass:"u-null",attrs:{title:"当前没有任何历史版本",type:"info","show-icon":""}})],1)])])],1):t._e()}),[],!1,null,null,null);e.a=l.exports},"4a9e":function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));i("d3b7"),i("e9c4"),i("99af");var a=i("c402"),n=i("1fb9"),s=i("263c"),o=i("d442"),l=i.n(o),c=i("2ef0"),r={data:function(){return{localTimer:"",webTimer:""}},beforeDestroy:function(){clearInterval(this.localTimer),this.localTimer=null,clearInterval(this.webTimer),this.webTimer=null},computed:{db:function(){return this.$store.state.db},isDraft:function(){var t;return"draft"===(null===(t=this.$route.query)||void 0===t?void 0:t.mode)},isRevision:function(){var t;return"revision"===(null===(t=this.$route.query)||void 0===t?void 0:t.mode)},isNewPost:function(){return!this.id}},methods:{loadData:function(){var t=this;if(this.loading=!0,this.isDraft){var e,i,n=null===(e=this.$route)||void 0===e||null===(i=e.query)||void 0===i?void 0:i.key;return this.db.getItem(n).then((function(e){t.post=e})).finally((function(){t.loading=!1}))}if(this.isRevision){var o=this.$route.params.id,l=this.$route.query.id;return Object(s.b)(o,l).then((function(e){t.post=e.data.data})).finally((function(){t.loading=!1}))}return this.$route.params.id?Object(a.j)(this.$route.params.id).then((function(e){t.post=e.data.data})).finally((function(){t.loading=!1})):new Promise((function(t,e){t()})).finally((function(){t.loading=!1}))},autoSave:function(){var t=this;this.id&&sessionStorage.setItem(this.post.post_type+"_"+this.id,JSON.stringify(this.post)),this.isDraft||this.isRevision||(this.localTimer=setInterval((function(){t.createLocalDraft()}),n.a),this.id&&(this.webTimer=setInterval((function(){t.createCloudRevision()}),n.b)))},createLocalDraft:function(){var t="";if(this.isNewPost&&this.post.post_content){var e="无标题-"+(new Date).getTime();t=this.post.post_type+"_"+(this.post.post_title||e)}this.id&&(t=this.post.post_type+"_"+this.id);var i=Object(c.cloneDeep)(this.post);i.cache_time=(new Date).getTime(),t&&this.db.setItem(t,i).then((function(){console.log("本地草稿备份完成",t,(new Date).getTime())}))},createCloudRevision:function(){var t=this;l.a.MD5(sessionStorage.getItem("".concat(this.post.post_type,"_").concat(this.post.ID)))===l.a.MD5(JSON.stringify(this.post))||Object(s.a)(this.post.ID,this.post).then((function(){t.$notify({title:"提醒",type:"success",message:"历史版本生成成功"}),sessionStorage.setItem("".concat(t.post.post_type,"_").concat(t.post.ID),JSON.stringify(t.post))}))},useDraft:function(){var t=this;this.$alert("是否使用该版本发布？","确认信息",{confirmButtonText:"确定",callback:function(e){"confirm"===e&&t.publish("publish",!0)}})}}}},"505f":function(t,e,i){"use strict";var a=i("52da"),n={name:"publish_client",props:["data","forbidAll","showMobile"],data:function(){return{client:this.data}},model:{prop:"data",event:"update"},watch:{data:function(t){this.client=t},client:{deep:!0,handler:function(t){this.$emit("update",t)}}},computed:{},methods:{handleChange:function(){a.a.$emit("changeClient",this.client)}},mounted:function(){},components:{}},s=i("2877"),o=Object(s.a)(n,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-publish-client"},[e("el-form-item",{attrs:{label:"版本"}},[e("el-radio-group",{on:{change:t.handleChange},model:{value:t.client,callback:function(e){t.client=e},expression:"client"}},[e("el-radio",{attrs:{label:"std"}},[t._v("重制")]),e("el-radio",{attrs:{label:"origin"}},[t._v("缘起")]),t.showMobile?e("el-radio",{attrs:{label:"wujie"}},[t._v("无界")]):t._e(),t.forbidAll?t._e():e("el-radio",{attrs:{label:"all"}},[t._v("全端")])],1)],1),t._t("default")],2)}),[],!1,null,null,null);e.a=o.exports},"52da":function(t,e,i){"use strict";var a=new(i("2b0e").default);e.a=a},"590f":function(t,e){t.exports="data:image/png;base64,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"},"647d":function(t,e,i){"use strict";i.d(e,"c",(function(){return n})),i.d(e,"d",(function(){return s})),i.d(e,"a",(function(){return l})),i.d(e,"b",(function(){return o})),i.d(e,"f",(function(){return c})),i.d(e,"e",(function(){return r}));i("99af");var a=i("41cb");function n(t){return Object(a.a)().get("/api/cms/posts/user/my/union",{params:t})}function s(t){return Object(a.a)().delete("/api/cms/post/".concat(t,"/authors/quit"))}function o(t){return Object(a.a)().get("/api/cms/post/".concat(t,"/authors"))}function l(t,e){return Object(a.a)().post("/api/cms/post/".concat(t,"/author/").concat(e),{label:"撰稿",r_edit:1})}function c(t,e,i){return Object(a.a)().put("/api/cms/post/".concat(t,"/author/").concat(e),i)}function r(t,e){return Object(a.a)().delete("/api/cms/post/".concat(t,"/author/").concat(e))}},"6c2b":function(t,e,i){"use strict";i.d(e,"d",(function(){return n})),i.d(e,"e",(function(){return l})),i.d(e,"a",(function(){return c})),i.d(e,"b",(function(){return s})),i.d(e,"f",(function(){return o})),i.d(e,"c",(function(){return r}));i("99af");var a=i("41cb");function n(t){return Object(a.a)()({method:"GET",url:"/api/cms/post/collection/mine",params:t})}function s(t){return Object(a.a)().post("/api/cms/post/collection",t)}function o(t,e){return Object(a.a)().put("/api/cms/post/collection/".concat(t),e)}function l(t){return Object(a.a)().delete("/api/cms/post/collection/".concat(t))}function c(t){return Object(a.a)().post("/api/cms/post/".concat(t.post_type,"-").concat(t.post_id,"/append-to-collection/").concat(t.post_collection),{title:t.post_title})}function r(t){return Object(a.a)()({method:"GET",url:"/api/cms/post/collection/".concat(t,"/raw")})}},"6f18":function(t,e,i){"use strict";i("354c")},"7c7e":function(t,e,i){"use strict";var a=i("53ca");i("b64b");e.a=function(t){return!t||(!(!Array.isArray(t)||t.length)||"object"==Object(a.a)(t)&&!Object.keys(t).length)}},"7f6e":function(t,e,i){},"9b2a":function(t,e,i){"use strict";i("f4b8")},"9dc9":function(t,e,i){"use strict";i("c0fb")},ab6a:function(t,e,i){"use strict";i("ccaf")},b13e:function(t,e,i){"use strict";i("a9e3");var a={name:"post_banner",components:{uploadImage:i("5571").a},props:{data:{type:String,default:""},size:{type:[Array,Number],default:148},info:{type:String,default:"非必选。首页海报尺寸1600*280（推荐3200*560支持高分屏），最大30M。"}},data:function(){return{banner:this.data}},model:{prop:"data",event:"update"},watch:{data:function(t){this.banner=t},banner:function(t){this.$emit("update",t)}}},n=(i("9dc9"),i("2877")),s=Object(n.a)(a,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-publish-banner"},[e("el-divider",{attrs:{"content-position":"left"}},[t._v("海报")]),e("uploadImage",{attrs:{info:t.info,"max-size":30,size:t.size},model:{value:t.banner,callback:function(e){t.banner=e},expression:"banner"}})],1)}),[],!1,null,null,null);e.a=s.exports},b3aa:function(t,e,i){},b4e5:function(t,e,i){"use strict";i("b3aa")},b6e6:function(t,e,i){"use strict";i("7f6e")},bb78:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var a=i("a27f"),n={data:function(){return{hasRead:0,open_white_list:0,visible_for_self:0}},mounted:function(){this.initExtend()},methods:{initExtend:function(){this.hasRead=~~localStorage.getItem("jx3box_has_read")||0},setHasRead:function(){localStorage.setItem("jx3box_has_read",this.hasRead)},loadCommentConfig:function(t,e){var i=this;Object(a.b)(t,e).then((function(t){var e,a;i.open_white_list=(null===(e=t.data.data)||void 0===e?void 0:e.open_white_list)||0,i.visible_for_self=(null===(a=t.data.data)||void 0===a?void 0:a.visible_for_self)||0}))},setCommentConfig:function(t,e){Object(a.e)(t,e,this.open_white_list?"open":"close"),Object(a.f)(t,e,this.visible_for_self?"open":"close")}},created:function(){this.post.client=this.$store.state.client},watch:{$route:{immediate:!0,deep:!0,handler:function(){this.init()}},"$store.state.user_conf.editor_mode":{immediate:!0,handler:function(t){this.id||(this.post.post_mode=t||"tinymce")}}}}},c0fb:function(t,e,i){},cc72:function(t,e,i){"use strict";var a={name:"publish_comment",props:["data"],data:function(){return{comment:this.data}},model:{prop:"data",event:"update"},watch:{data:function(t){this.comment=t},comment:{deep:!0,handler:function(t){this.$emit("update",t)}}},computed:{},methods:{},mounted:function(){},components:{}},n=(i("b6e6"),i("2877")),s=Object(n.a)(a,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-publish-comment"},[e("el-form-item",{attrs:{label:"评论开关"}},[e("el-switch",{attrs:{"active-color":"#13ce66","active-value":0,"inactive-value":1},model:{value:t.comment,callback:function(e){t.comment=e},expression:"comment"}})],1),e("div",{staticClass:"m-comment-extend"},[t._t("default")],2)],1)}),[],!1,null,"ca3e4fc0",null);e.a=s.exports},ccaf:function(t,e,i){},d0a1:function(t,e,i){"use strict";var a={name:"publish_title",props:["data","hideDiv","placeholder"],data:function(){return{title:this.data}},model:{prop:"data",event:"update"},watch:{data:function(t){this.title=t},title:{deep:!0,handler:function(t){this.$emit("update",t)}}},computed:{},methods:{},mounted:function(){},components:{}},n=i("2877"),s=Object(n.a)(a,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-publish-title"},[t.hideDiv?t._e():e("el-divider",{attrs:{"content-position":"left"}},[t._v("标题")]),e("el-input",{attrs:{maxlength:50,minlength:2,"show-word-limit":"",required:"",placeholder:t.placeholder||"请填写标题"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),t._t("default")],2)}),[],!1,null,null,null);e.a=s.exports},d0b4:function(t,e,i){"use strict";var a=i("6df1"),n={name:"publish_zlp",props:["data","client"],data:function(){return{zlp:this.data,zlps:a.std}},model:{prop:"data",event:"update"},watch:{data:function(t){this.zlp=t},zlp:{deep:!0,handler:function(t){this.$emit("update",t)}},client:{handler:function(t){t=t||"std",this.zlps=a[t]},immediate:!0}},computed:{},methods:{},mounted:function(){},components:{}},s=i("2877"),o=Object(s.a)(n,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-publish-zlp"},[e("el-form-item",{attrs:{label:"资料片"}},[e("el-select",{attrs:{filterable:"","allow-create":!0,placeholder:"请选择适应资料片"},model:{value:t.zlp,callback:function(e){t.zlp=e},expression:"zlp"}},t._l(t.zlps,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),t._t("default")],2)}),[],!1,null,"7579bf35",null);e.a=o.exports},d95e:function(t,e,i){"use strict";i("caad"),i("2532"),i("b0c0");var a=i("46d4"),n=i("65c2"),s={name:"publish_xf",props:["data","client"],data:function(){return{xf:this.data,exact_client:this.client||"std"}},model:{prop:"data",event:"update"},watch:{data:function(t){this.xf=t},xf:{deep:!0,handler:function(t){this.$emit("update",t)}},client:function(t){"wujie"===t&&(t="std"),this.exact_client=t||"std"}},computed:{xfmap:function(){return delete a["山居剑意"],a}},methods:{},filters:{xficon:function(t){return n.__imgPath+"image/xf/"+t+".png"}},mounted:function(){},components:{}},o=i("2877"),l=Object(o.a)(s,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-publish-xf"},[e("el-form-item",{attrs:{label:"心法"}},t._l(t.xfmap,(function(i,a){return e("el-radio",{directives:[{name:"show",rawName:"v-show",value:i.client.includes(t.exact_client),expression:"item.client.includes(exact_client)"}],key:a,attrs:{label:i.name},model:{value:t.xf,callback:function(e){t.xf=e},expression:"xf"}},[e("img",{staticClass:"u-pic",attrs:{src:t._f("xficon")(i.id),alt:i.name}}),e("span",{staticClass:"u-txt"},[t._v(t._s(i.name))])])})),1),t._t("default")],2)}),[],!1,null,null,null);e.a=l.exports},db12:function(t,e,i){"use strict";i("14d9"),i("a434");var a=i("1dfe"),n=i("647d"),s=i("85e4"),o=i("c9d2"),l={name:"PublishAuthors",props:["id","uid"],components:{UserPop:a.a},data:function(){return{list:[],visible:!1}},computed:{isSuper:function(){return o.a.getInfo().uid==this.uid}},watch:{id:{immediate:!0,handler:function(t){t&&this.loadAuthors()}}},methods:{openPop:function(){this.visible=!0},addAuthor:function(t){var e=this;Object(n.a)(this.id,t.ID).then((function(i){e.$notify({title:"添加成功",message:"联合创作者添加成功",type:"success"}),e.list.push({post_author_info:t,label:"撰稿",status:0})}))},loadAuthors:function(){var t=this;Object(n.b)(this.id).then((function(e){var i,a;t.list=null===(i=e.data)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.other_authors}))},update:function(t){var e=this;this.$prompt("修改展示项，例如：撰稿/修订/主创/校稿..","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(i){var a=i.value;Object(n.f)(e.id,t.post_author_info.ID,{label:a,r_edit:1}).then((function(){t.label=a,e.$notify({title:"修改成功",message:"备注更新成功",type:"success"})}))}))},remove:function(t,e){var i=this;Object(n.e)(this.id,t.post_author_info.ID).then((function(t){i.$notify({title:"删除成功",message:"成功移除联合创作者",type:"success"}),i.list.splice(e,1)}))}},filters:{showAvatar:function(t){return Object(s.showAvatar)(t)}},created:function(){},mounted:function(){}},c=(i("6f18"),i("2877")),r=Object(c.a)(l,(function(){var t=this,e=t._self._c;return t.id&&t.isSuper?e("div",{staticClass:"m-publish-authors"},[e("el-form-item",{attrs:{label:"联合创作"}},[e("div",{staticClass:"u-list"},[t._l(t.list,(function(i,a){return e("div",{key:a,staticClass:"u-item"},[i.status?t._e():e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"等待被邀请者确认",placement:"top"}},[e("i",{staticClass:"u-status el-icon-loading"})]),e("img",{staticClass:"u-avatar",attrs:{src:t._f("showAvatar")(i.post_author_info.user_avatar)}}),e("span",{staticClass:"u-name"},[t._v(" "+t._s(i.post_author_info.display_name)+" "),e("span",{staticClass:"u-label"},[t._v("("+t._s(i.label||"撰稿")+")")])]),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"修改备注",placement:"top"}},[e("i",{staticClass:"u-edit el-icon-edit",on:{click:function(e){return t.update(i)}}})]),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"移除",placement:"top"}},[e("i",{staticClass:"u-delete el-icon-delete",on:{click:function(e){return t.remove(i,a)}}})])],1)})),e("el-button",{attrs:{plain:"",size:"small",type:"primary"},on:{click:t.openPop}},[t._v("+ 添加联合创作者")])],2),e("UserPop",{attrs:{title:"添加用户"},on:{confirm:t.addAuthor},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}})],1)],1):t._e()}),[],!1,null,null,null);e.a=r.exports},ef77:function(t,e,i){"use strict";i("b0c0"),i("14d9");var a={name:"publish_header",props:["name"],data:function(){return{}},computed:{},methods:{goBack:function(){window.history.length?this.$router.go(-1):this.$router.push("/")}},mounted:function(){},components:{}},n=(i("b4e5"),i("2877")),s=Object(n.a)(a,(function(){var t=this._self._c;return t("div",{staticClass:"m-publish-header"},[t("el-page-header",{attrs:{content:this.name},on:{back:this.goBack}}),this._t("default")],2)}),[],!1,null,null,null);e.a=s.exports},f475:function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return s}));i("99af");var a=i("41cb");function n(t,e){var i=isNaN(t)?"name":"id";return Object(a.d)().get("/skill/".concat(i,"/").concat(t),{params:e}).then((function(t){return t.data})).catch((function(t){console.log(t)}))}function s(t){return Object(a.d)().get("/skill",{params:t})}},f4b8:function(t,e,i){}}]);
//# sourceMappingURL=chunk-42fbdd8a.4cd6222e.js.map
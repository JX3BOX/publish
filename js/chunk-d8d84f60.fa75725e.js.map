{"version":3,"sources":["webpack:///./src/post/quest.vue?9d10","webpack:///./src/service/quest.js","webpack:///src/post/quest.vue","webpack:///./src/post/quest.vue?8ff1","webpack:///./src/post/quest.vue","webpack:///./node_modules/@tinymce/tinymce-vue/lib/es2015/main/ts/TinyMCE.js","webpack:///./src/post/quest.vue?cd12","webpack:///./node_modules/@tinymce/tinymce-vue/lib/es2015/main/ts/Utils.js","webpack:///./node_modules/@tinymce/tinymce-vue/lib/es2015/main/ts/ScriptLoader.js","webpack:///./node_modules/@tinymce/tinymce-vue/lib/es2015/main/ts/components/EditorPropTypes.js","webpack:///./node_modules/@tinymce/tinymce-vue/lib/es2015/main/ts/components/Editor.js","webpack:///./node_modules/@tinymce/tinymce-vue/lib/es2015/main/ts/index.js","webpack:///./src/components/publish_header.vue?346e","webpack:///./src/components/publish_header.vue?dbea","webpack:///src/components/publish_header.vue","webpack:///./src/components/publish_header.vue"],"names":["get_list","params","$helper","method","url","component","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","_t","_v","post","id","search_handle","options","loading","model","value","callback","$$v","$set","expression","_l","source","key","Name","domProps","_s","processing","on","toPublish","getGlobal","window","global","getTinymce","tinymce","state","validEvents","isValidKey","map","event","toLowerCase","indexOf","initEditor","initEvent","ctx","editor","$props","initialValue","setContent","initialized","cache","$watch","val","prevVal","getContent","format","outputFormat","$listeners","input","modelEvents","normalizedEvents","Array","isArray","join","$emit","bindModelHandlers","listeners","Object","keys","filter","forEach","handler","substring","e","bindHandlers","unique","uuid","prefix","time","Date","now","Math","floor","random","String","normalizePluginArray","plugins","split","createState","scriptId","scriptLoaded","ScriptLoader","load","doc","push","getElementById","scriptTag","createElement","referrerPolicy","type","src","removeEventListener","addEventListener","head","appendChild","injectScriptTag","fn","reinitialize","editorProps","apiKey","cloudChannel","init","inline","Boolean","tagName","toolbar","disabled","tinymceScriptSrc","validator","prop","__assign","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","initialise","initPlugins","inputPlugins","element","finalInit","readonly","selector","elementId","concat","inlineEditor","setup","style","visibility","display","Editor","props","created","watch","setMode","mounted","$el","ownerDocument","channel","scriptSrc","beforeDestroy","remove","deactivated","_a","activated","render","h","renderInline","renderIframe","name","goBack"],"mappings":"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","file":"js/chunk-d8d84f60.fa75725e.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"m-publish-box\"},[_c('publish-header',{attrs:{\"name\":\"任务百科\"}},[_vm._t(\"header\")],2),_c('el-form',{staticClass:\"m-publish-post\"},[_c('div',{staticClass:\"m-publish-source\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"选择任务 *\")]),_c('el-select',{staticClass:\"u-source-id\",attrs:{\"filterable\":\"\",\"remote\":\"\",\"disabled\":!!_vm.post.id,\"placeholder\":\"输入任务名称（可适配中括号形式）「回车」进行搜索\",\"remote-method\":_vm.search_handle,\"loading\":_vm.options.loading},model:{value:(_vm.post.source_id),callback:function ($$v) {_vm.$set(_vm.post, \"source_id\", $$v)},expression:\"post.source_id\"}},_vm._l((_vm.options.sources),function(source){return _c('el-option',{key:source.id,attrs:{\"label\":source.Name,\"value\":source.id}},[_c('div',{staticClass:\"m-selector-item\"},[_c('i',{staticClass:\"el-icon-collection u-icon\"}),_c('span',{staticClass:\"u-name\",domProps:{\"textContent\":_vm._s(source.Name)}})])])}),1)],1),_c('div',{staticClass:\"m-publish-level\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"综合难度 *\")]),_c('el-rate',{staticClass:\"u-level\",model:{value:(_vm.post.level),callback:function ($$v) {_vm.$set(_vm.post, \"level\", $$v)},expression:\"post.level\"}})],1),_c('div',{staticClass:\"m-publish-remark\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"修订说明 *\")]),_c('el-input',{attrs:{\"maxlength\":200,\"minlength\":1,\"show-word-limit\":\"\",\"required\":\"\",\"placeholder\":\"请简单描述一下本次修订的说明\"},model:{value:(_vm.post.remark),callback:function ($$v) {_vm.$set(_vm.post, \"remark\", $$v)},expression:\"post.remark\"}})],1),_c('div',{staticClass:\"m-publish-content\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"攻略正文 *\")]),_c('Tinymce',{attrs:{\"attachmentEnable\":true,\"resourceEnable\":true,\"height\":400},model:{value:(_vm.post.content),callback:function ($$v) {_vm.$set(_vm.post, \"content\", $$v)},expression:\"post.content\"}})],1),_c('div',{staticClass:\"m-publish-commit\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}}),_c('el-button',{staticClass:\"u-publish\",attrs:{\"icon\":\"el-icon-s-promotion\",\"type\":\"primary\",\"disabled\":_vm.processing},on:{\"click\":_vm.toPublish}},[_vm._v(\"提交攻略 \")])],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { $helper } from \"@jx3box/jx3box-common/js/https.js\";\n\nfunction get_list(params) {\n    return $helper()({\n        method: \"GET\",\n        url: `/api/quests`,\n        params: params,\n    });\n}\n\nexport { get_list };\n","<template>\n  <div class=\"m-publish-box\">\n    <!-- 头部 -->\n    <publish-header name=\"任务百科\">\n      <slot name=\"header\"></slot>\n    </publish-header>\n\n    <el-form class=\"m-publish-post\">\n      <div class=\"m-publish-source\">\n        <el-divider content-position=\"left\">选择任务 *</el-divider>\n        <el-select\n            class=\"u-source-id\"\n            v-model=\"post.source_id\"\n            filterable\n            remote\n            :disabled=\"!!post.id\"\n            placeholder=\"输入任务名称（可适配中括号形式）「回车」进行搜索\"\n            :remote-method=\"search_handle\"\n            :loading=\"options.loading\"\n        >\n          <el-option\n              v-for=\"source in options.sources\"\n              :key=\"source.id\"\n              :label=\"source.Name\"\n              :value=\"source.id\"\n          >\n            <div class=\"m-selector-item\">\n              <i class=\"el-icon-collection u-icon\"></i>\n              <span class=\"u-name\" v-text=\"source.Name\"></span>\n            </div>\n          </el-option>\n        </el-select>\n      </div>\n\n      <div class=\"m-publish-level\">\n        <el-divider content-position=\"left\">综合难度 *</el-divider>\n        <el-rate v-model=\"post.level\" class=\"u-level\"></el-rate>\n      </div>\n\n      <div class=\"m-publish-remark\">\n        <el-divider content-position=\"left\">修订说明 *</el-divider>\n        <el-input\n            v-model=\"post.remark\"\n            :maxlength=\"200\"\n            :minlength=\"1\"\n            show-word-limit\n            required\n            placeholder=\"请简单描述一下本次修订的说明\"\n        ></el-input>\n      </div>\n\n      <div class=\"m-publish-content\">\n        <el-divider content-position=\"left\">攻略正文 *</el-divider>\n        <Tinymce\n            v-model=\"post.content\"\n            :attachmentEnable=\"true\"\n            :resourceEnable=\"true\"\n            :height=\"400\"\n        />\n      </div>\n\n      <div class=\"m-publish-commit\">\n        <el-divider content-position=\"left\"></el-divider>\n        <el-button\n            class=\"u-publish\"\n            icon=\"el-icon-s-promotion\"\n            type=\"primary\"\n            @click=\"toPublish\"\n            :disabled=\"processing\"\n        >提交攻略\n        </el-button>\n      </div>\n    </el-form>\n  </div>\n</template>\n\n<script>\n  import header from \"@/components/publish_header.vue\";\n  import Tinymce from \"@jx3box/jx3box-editor/src/Tinymce\";\n\n  // 本地依赖\n  import {WikiPost} from \"@jx3box/jx3box-common/js/helper\";\n  import User from \"@jx3box/jx3box-common/js/user\";\n  import {get_list} from \"../service/quest\";\n\n  export default {\n    name: \"quest\",\n    data() {\n      return {\n        //选项 - 加载可选项\n        options: {\n          sources: null,\n        },\n\n        //文章 - 主表数据\n        post: {\n          id: \"\", // 文章ID\n          content: \"\",\n          source_id: \"\",\n          level: 0,\n          remark: \"\",\n        },\n\n        // 状态控制\n        loading: false,\n        processing: false\n      };\n    },\n    computed: {},\n    methods: {\n      toPublish: function () {\n        if (!this.post.source_id) {\n          this.$message({\n            message: \"请选择要修订攻略的任务\",\n            type: \"warning\",\n          });\n          return;\n        }\n\n        if (!this.post.content) {\n          this.$message({message: \"要编写攻略正文哦\", type: \"warning\"});\n          return;\n        }\n\n        if (!(this.post.level >= 1 && this.post.level <= 5)) {\n          this.$message({\n            message: \"请选择适合的综合难度\",\n            type: \"warning\",\n          });\n          return;\n        }\n\n        if (!this.post.remark) {\n          this.$message({\n            message: \"请简单描述本次修订说明\",\n            type: \"warning\",\n          });\n          return;\n        }\n\n        this.processing = true;\n        WikiPost.save({\n          type: \"quest\",\n          source_id: this.post.source_id,\n          level: this.post.level,\n          user_nickname: User.getInfo().name,\n          content: this.post.content,\n          remark: this.post.remark,\n        }).then((data) => {\n          data = data.data;\n          if (data.code === 200) {\n            this.$message({\n              message: \"提交成功，请等待审核\",\n              type: \"success\",\n            });\n            setTimeout(() => {\n              this.$router.push({name: 'wiki_post', params: {type: 'quest'}})\n            }, 500);\n          } else {\n            this.$message({\n              message: `${data.message}`,\n              type: \"warning\",\n            });\n          }\n        }).finally(() => {\n          this.processing = false\n        });\n      },\n      // 任务搜索\n      search_handle(keyword = \"\") {\n        this.loading = true;\n        get_list({\n          keyword: keyword,\n          limit: 10,\n        }).then((res) => {\n          res = res.data;\n          if (res.code === 200)\n            this.options.sources = res.data.data;\n          this.loading = false;\n        });\n      },\n    },\n    created() {\n      // 初始化搜索列表\n      this.search_handle(\"\");\n      // 获取任务ID并通过watch获取攻略\n      let id = this.$route.params.source_id;\n      this.post.source_id = id ? parseInt(id) : null;\n    },\n    watch: {\n      \"post.source_id\": {\n        handler() {\n          if (!this.post.source_id) return;\n          this.loading = true;\n          WikiPost.newest(\"quest\", this.post.source_id, 0).then(\n              (res) => {\n                let data = res.data;\n                if (data.code === 200) {\n                  // 数据填充\n                  let post = data.data.post;\n                  let source = data.data.source;\n\n                  if (post) {\n                    this.post.source_id = parseInt(post.source_id);\n                    this.post.level = post.level || 1;\n                    this.post.remark = \"\";\n                    let content = post.content;\n                    content = content.replace(/(<p>)?\\s*◆任务难度 [★]+\\s*(<\\/p>)?/gi, \"\");\n                    content = content.replace(/(<p>)?\\s*◆花费时长 [★]+\\s*(<\\/p>)?/gi, \"\");\n                    content = content.replace(/(<p>)?\\s*◆任务攻略\\s*(<\\/p>)?/gi, \"\");\n                    this.post.content = content;\n                  } else {\n                    this.post.source_id = this.post.source_id ? parseInt(this.post.source_id) : \"\";\n                    this.post.level = 0;\n                    this.post.remark = \"\";\n                    this.post.content = \"\";\n                  }\n\n                  if (source) {\n                    // 将选择项恢复至下拉框\n                    let exist = false;\n                    this.options.sources = this.options.sources || [];\n                    for (let index in this.options.sources) {\n                      if (this.options.sources[index].id == source.id) {\n                        exist = true;\n                        break;\n                      }\n                    }\n                    if (!exist)\n                      this.options.sources.push(source);\n                  }\n                }\n              }\n          ).finally(() => {\n            this.loading = false\n          })\n        },\n      },\n    },\n    components: {\n      'publish-header': header,\n      Tinymce,\n    },\n  };\n</script>\n\n<style scoped lang=\"less\">\n  @import \"../assets/css/quest.less\";\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./quest.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./quest.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./quest.vue?vue&type=template&id=0a0f92ac&scoped=true&\"\nimport script from \"./quest.vue?vue&type=script&lang=js&\"\nexport * from \"./quest.vue?vue&type=script&lang=js&\"\nimport style0 from \"./quest.vue?vue&type=style&index=0&id=0a0f92ac&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0a0f92ac\",\n  null\n  \n)\n\nexport default component.exports","/**\n * Copyright (c) 2018-present, Ephox, Inc.\n *\n * This source code is licensed under the Apache 2 license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\nvar getGlobal = function () { return (typeof window !== 'undefined' ? window : global); };\nvar getTinymce = function () {\n    var global = getGlobal();\n    return global && global.tinymce ? global.tinymce : null;\n};\nexport { getTinymce };\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--10-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./quest.vue?vue&type=style&index=0&id=0a0f92ac&scoped=true&lang=less&\"","/**\n * Copyright (c) 2018-present, Ephox, Inc.\n *\n * This source code is licensed under the Apache 2 license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\nvar validEvents = [\n    'onActivate',\n    'onAddUndo',\n    'onBeforeAddUndo',\n    'onBeforeExecCommand',\n    'onBeforeGetContent',\n    'onBeforeRenderUI',\n    'onBeforeSetContent',\n    'onBeforePaste',\n    'onBlur',\n    'onChange',\n    'onClearUndos',\n    'onClick',\n    'onContextMenu',\n    'onCopy',\n    'onCut',\n    'onDblclick',\n    'onDeactivate',\n    'onDirty',\n    'onDrag',\n    'onDragDrop',\n    'onDragEnd',\n    'onDragGesture',\n    'onDragOver',\n    'onDrop',\n    'onExecCommand',\n    'onFocus',\n    'onFocusIn',\n    'onFocusOut',\n    'onGetContent',\n    'onHide',\n    'onInit',\n    'onKeyDown',\n    'onKeyPress',\n    'onKeyUp',\n    'onLoadContent',\n    'onMouseDown',\n    'onMouseEnter',\n    'onMouseLeave',\n    'onMouseMove',\n    'onMouseOut',\n    'onMouseOver',\n    'onMouseUp',\n    'onNodeChange',\n    'onObjectResizeStart',\n    'onObjectResized',\n    'onObjectSelected',\n    'onPaste',\n    'onPostProcess',\n    'onPostRender',\n    'onPreProcess',\n    'onProgressState',\n    'onRedo',\n    'onRemove',\n    'onReset',\n    'onSaveContent',\n    'onSelectionChange',\n    'onSetAttrib',\n    'onSetContent',\n    'onShow',\n    'onSubmit',\n    'onUndo',\n    'onVisualAid'\n];\nvar isValidKey = function (key) { return validEvents.map(function (event) { return event.toLowerCase(); }).indexOf(key.toLowerCase()) !== -1; };\nvar bindHandlers = function (initEvent, listeners, editor) {\n    Object.keys(listeners)\n        .filter(isValidKey)\n        .forEach(function (key) {\n        var handler = listeners[key];\n        if (typeof handler === 'function') {\n            if (key === 'onInit') {\n                handler(initEvent, editor);\n            }\n            else {\n                editor.on(key.substring(2), function (e) { return handler(e, editor); });\n            }\n        }\n    });\n};\nvar bindModelHandlers = function (ctx, editor) {\n    var modelEvents = ctx.$props.modelEvents ? ctx.$props.modelEvents : null;\n    var normalizedEvents = Array.isArray(modelEvents) ? modelEvents.join(' ') : modelEvents;\n    editor.on(normalizedEvents ? normalizedEvents : 'change input undo redo', function () {\n        ctx.$emit('input', editor.getContent({ format: ctx.$props.outputFormat }));\n    });\n};\nvar initEditor = function (initEvent, ctx, editor) {\n    var value = ctx.$props.value ? ctx.$props.value : '';\n    var initialValue = ctx.$props.initialValue ? ctx.$props.initialValue : '';\n    editor.setContent(value || (ctx.initialized ? ctx.cache : initialValue));\n    // Always bind the value listener in case users use :value instead of v-model\n    ctx.$watch('value', function (val, prevVal) {\n        if (editor && typeof val === 'string' && val !== prevVal && val !== editor.getContent({ format: ctx.$props.outputFormat })) {\n            editor.setContent(val);\n        }\n    });\n    // checks if the v-model shorthand is used (which sets an v-on:input listener) and then binds either\n    // specified the events or defaults to \"change keyup\" event and emits the editor content on that event\n    if (ctx.$listeners.input) {\n        bindModelHandlers(ctx, editor);\n    }\n    bindHandlers(initEvent, ctx.$listeners, editor);\n    ctx.initialized = true;\n};\nvar unique = 0;\nvar uuid = function (prefix) {\n    var time = Date.now();\n    var random = Math.floor(Math.random() * 1000000000);\n    unique++;\n    return prefix + '_' + random + unique + String(time);\n};\nvar isTextarea = function (element) {\n    return element !== null && element.tagName.toLowerCase() === 'textarea';\n};\nvar normalizePluginArray = function (plugins) {\n    if (typeof plugins === 'undefined' || plugins === '') {\n        return [];\n    }\n    return Array.isArray(plugins) ? plugins : plugins.split(' ');\n};\nvar mergePlugins = function (initPlugins, inputPlugins) {\n    return normalizePluginArray(initPlugins).concat(normalizePluginArray(inputPlugins));\n};\nvar isNullOrUndefined = function (value) { return value === null || value === undefined; };\nexport { bindHandlers, bindModelHandlers, initEditor, isValidKey, uuid, isTextarea, mergePlugins, isNullOrUndefined };\n","/**\n * Copyright (c) 2018-present, Ephox, Inc.\n *\n * This source code is licensed under the Apache 2 license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\nimport { uuid } from './Utils';\nvar createState = function () {\n    return {\n        listeners: [],\n        scriptId: uuid('tiny-script'),\n        scriptLoaded: false\n    };\n};\nvar CreateScriptLoader = function () {\n    var state = createState();\n    var injectScriptTag = function (scriptId, doc, url, callback) {\n        var scriptTag = doc.createElement('script');\n        scriptTag.referrerPolicy = 'origin';\n        scriptTag.type = 'application/javascript';\n        scriptTag.id = scriptId;\n        scriptTag.src = url;\n        var handler = function () {\n            scriptTag.removeEventListener('load', handler);\n            callback();\n        };\n        scriptTag.addEventListener('load', handler);\n        if (doc.head) {\n            doc.head.appendChild(scriptTag);\n        }\n    };\n    var load = function (doc, url, callback) {\n        if (state.scriptLoaded) {\n            callback();\n        }\n        else {\n            state.listeners.push(callback);\n            if (!doc.getElementById(state.scriptId)) {\n                injectScriptTag(state.scriptId, doc, url, function () {\n                    state.listeners.forEach(function (fn) { return fn(); });\n                    state.scriptLoaded = true;\n                });\n            }\n        }\n    };\n    // Only to be used by tests.\n    var reinitialize = function () {\n        state = createState();\n    };\n    return {\n        load: load,\n        reinitialize: reinitialize\n    };\n};\nvar ScriptLoader = CreateScriptLoader();\nexport { ScriptLoader };\n","/**\n * Copyright (c) 2018-present, Ephox, Inc.\n *\n * This source code is licensed under the Apache 2 license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\nexport var editorProps = {\n    apiKey: String,\n    cloudChannel: String,\n    id: String,\n    init: Object,\n    initialValue: String,\n    inline: Boolean,\n    modelEvents: [String, Array],\n    plugins: [String, Array],\n    tagName: String,\n    toolbar: [String, Array],\n    value: String,\n    disabled: Boolean,\n    tinymceScriptSrc: String,\n    outputFormat: {\n        type: String,\n        validator: function (prop) { return prop === 'html' || prop === 'text'; }\n    },\n};\n","/**\n * Copyright (c) 2018-present, Ephox, Inc.\n *\n * This source code is licensed under the Apache 2 license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { ScriptLoader } from '../ScriptLoader';\nimport { getTinymce } from '../TinyMCE';\nimport { initEditor, isTextarea, mergePlugins, uuid, isNullOrUndefined } from '../Utils';\nimport { editorProps } from './EditorPropTypes';\nvar renderInline = function (h, id, tagName) {\n    return h(tagName ? tagName : 'div', {\n        attrs: { id: id }\n    });\n};\nvar renderIframe = function (h, id) {\n    return h('textarea', {\n        attrs: { id: id },\n        style: { visibility: 'hidden' }\n    });\n};\nvar initialise = function (ctx) { return function () {\n    var finalInit = __assign(__assign({}, ctx.$props.init), { readonly: ctx.$props.disabled, selector: \"#\" + ctx.elementId, plugins: mergePlugins(ctx.$props.init && ctx.$props.init.plugins, ctx.$props.plugins), toolbar: ctx.$props.toolbar || (ctx.$props.init && ctx.$props.init.toolbar), inline: ctx.inlineEditor, setup: function (editor) {\n            ctx.editor = editor;\n            editor.on('init', function (e) { return initEditor(e, ctx, editor); });\n            if (ctx.$props.init && typeof ctx.$props.init.setup === 'function') {\n                ctx.$props.init.setup(editor);\n            }\n        } });\n    if (isTextarea(ctx.element)) {\n        ctx.element.style.visibility = '';\n        ctx.element.style.display = '';\n    }\n    getTinymce().init(finalInit);\n}; };\nexport var Editor = {\n    props: editorProps,\n    created: function () {\n        this.elementId = this.$props.id || uuid('tiny-vue');\n        this.inlineEditor = (this.$props.init && this.$props.init.inline) || this.$props.inline;\n        this.initialized = false;\n    },\n    watch: {\n        disabled: function () {\n            this.editor.setMode(this.disabled ? 'readonly' : 'design');\n        }\n    },\n    mounted: function () {\n        this.element = this.$el;\n        if (getTinymce() !== null) {\n            initialise(this)();\n        }\n        else if (this.element && this.element.ownerDocument) {\n            var channel = this.$props.cloudChannel ? this.$props.cloudChannel : '5';\n            var apiKey = this.$props.apiKey ? this.$props.apiKey : 'no-api-key';\n            var scriptSrc = isNullOrUndefined(this.$props.tinymceScriptSrc) ?\n                \"https://cdn.tiny.cloud/1/\" + apiKey + \"/tinymce/\" + channel + \"/tinymce.min.js\" :\n                this.$props.tinymceScriptSrc;\n            ScriptLoader.load(this.element.ownerDocument, scriptSrc, initialise(this));\n        }\n    },\n    beforeDestroy: function () {\n        if (getTinymce() !== null) {\n            getTinymce().remove(this.editor);\n        }\n    },\n    deactivated: function () {\n        var _a;\n        if (!this.inlineEditor) {\n            this.cache = this.editor.getContent();\n            (_a = getTinymce()) === null || _a === void 0 ? void 0 : _a.remove(this.editor);\n        }\n    },\n    activated: function () {\n        if (!this.inlineEditor && this.initialized) {\n            initialise(this)();\n        }\n    },\n    render: function (h) {\n        return this.inlineEditor ? renderInline(h, this.elementId, this.$props.tagName) : renderIframe(h, this.elementId);\n    }\n};\n","/**\n * Copyright (c) 2018-present, Ephox, Inc.\n *\n * This source code is licensed under the Apache 2 license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\nimport { Editor } from './components/Editor';\nexport default Editor;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"m-publish-header\"},[_c('el-page-header',{attrs:{\"content\":_vm.name},on:{\"back\":_vm.goBack}}),_vm._t(\"default\")],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_header.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_header.vue?vue&type=script&lang=js&\"","<template>\n    <div class=\"m-publish-header\">\n        <el-page-header @back=\"goBack\" :content=\"name\"></el-page-header>\n        <slot></slot>\n    </div>\n</template>\n\n<script>\n\nexport default {\n    name: \"publish_header\",\n    props: [\"name\"],\n    data: function() {\n        return {\n        };\n    },\n    computed: {},\n    methods: {\n        goBack: function() {\n            this.$router.push(\"/\");\n        },\n    },\n    mounted: function() {},\n    components: {},\n};\n</script>\n","import { render, staticRenderFns } from \"./publish_header.vue?vue&type=template&id=c15eddea&\"\nimport script from \"./publish_header.vue?vue&type=script&lang=js&\"\nexport * from \"./publish_header.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}
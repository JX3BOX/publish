(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-d3aae0f0"],{3408:function(t,e,i){"use strict";i("6f23")},"6f23":function(t,e,i){},e4f6:function(t,e,i){"use strict";i.d(e,"f",(function(){return s})),i.d(e,"c",(function(){return l})),i.d(e,"g",(function(){return n})),i.d(e,"d",(function(){return o})),i.d(e,"a",(function(){return c})),i.d(e,"h",(function(){return u})),i.d(e,"e",(function(){return r})),i.d(e,"b",(function(){return d}));var a=i("41cb");function s(t){return Object(a.b)().post("/api/cms/post/emotion",t)}function n(t,e){return Object(a.b)().put("/api/cms/post/emotion/".concat(t),e)}function l(t){return Object(a.b)().get("/api/cms/post/emotion/".concat(t))}function o(t){return Object(a.b)().get("/api/cms/post/emotions/my",{params:t})}function c(t){return Object(a.b)().delete("/api/cms/post/emotion/".concat(t))}function u(t){return Object(a.b)().post("/api/cms/upload",t)}function r(t){return Object(a.b)().get("/api/cms/post/jokes/my",{params:t})}function d(t){return Object(a.b)().delete("/api/cms/post/joke/".concat(t))}},ef77:function(t,e,i){"use strict";var a={name:"publish_header",props:["name"],data:function(){return{}},computed:{},methods:{goBack:function(){this.$router.push("/")}},mounted:function(){},components:{}},s=i("2877"),n=Object(s.a)(a,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"m-publish-header"},[e("el-page-header",{attrs:{content:this.name},on:{back:this.goBack}}),this._t("default")],2)}),[],!1,null,null,null);e.a=n.exports},f18d:function(t,e,i){"use strict";i.r(e);i("d3b7"),i("159b"),i("b0c0"),i("99af"),i("a434");var a=i("85e4"),s=i("ef77"),n=i("9530"),l=i("e4f6"),o={name:"emotion",components:{UploadImages:n.a,"publish-header":s.a},data:function(){return{loading:!1,processing:!1,supportTypes:"image/png, image/jpeg, image/gif, image/bmp, image/webp",list:[],data:{},dialogImageUrl:"",dialogVisible:!1}},computed:{id:function(){return~~this.$route.params.id},fileInput:function(){return this.$refs.uploadInput}},methods:{init:function(){var t=this;this.loading=!0,Object(l.c)(this.id).then((function(e){var i;t.data=null==e||null===(i=e.data)||void 0===i?void 0:i.data})).finally((function(){t.loading=!1}))},updateFileList:function(t){var e=t.list,i=[];e.forEach((function(t){t.is_img&&i.push({desc:t.name,url:t.url,original:0,author:""})})),this.list=this.list.concat(i)},previewHandle:function(t){console.log(t),this.dialogImageUrl=t.url,this.dialogVisible=!0},deleteHandle:function(t){this.list.splice(t,1)},publish:function(){var t=this;this.processing=!0,Object(l.f)(this.list).then((function(e){t.$message({message:"发布成功",type:"success"}),setTimeout((function(){location.href=Object(a.getLink)("emotion")}),500)})).finally((function(){t.processing=!1}))},update:function(){var t,e=this;null!==(t=this.data)&&void 0!==t&&t.url?(this.processing=!0,Object(l.g)(this.id,this.data).then((function(t){e.$message({message:"更新成功",type:"success"}),setTimeout((function(){location.href=Object(a.getLink)("emotion",e.id)}),500)})).finally((function(){e.processing=!1}))):this.$message({message:"图片不能为空",type:"warning"})},removePic:function(){this.data.url=""},select:function(){this.fileInput.dispatchEvent(new MouseEvent("click"))},upload:function(){var t=this,e=new FormData;e.append("file",this.fileInput.files[0]),Object(l.h)(e).then((function(e){t.data.url=e.data.data[0],t.$message({message:"上传成功",type:"success"}),t.fileInput.files=[]}))},handleRemove:function(){this.data.url=""}},watch:{"$route.params.id":{immediate:!0,handler:function(t){t&&this.init()}}},filters:{showThumbnail:function(t){return Object(a.getThumbnail)(t,146)}}},c=(i("3408"),i("2877")),u=Object(c.a)(o,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-publish-box m-publish-box-emotion"},[i("publish-header",{attrs:{name:"剑三表情"}}),i("el-form",{attrs:{"label-position":"left","label-width":"80px"}},[t.id?i("div",{staticClass:"m-publish-emotion m-publish-emotion-edit"},[i("el-form-item",{attrs:{label:"图片"}},[t.data&&t.data.url?i("div",{staticClass:"u-pic"},[i("img",{staticClass:"u-img",attrs:{src:t._f("showThumbnail")(t.data.url)}}),i("i",{staticClass:"u-mask"}),i("i",{staticClass:"u-preview",on:{click:function(e){return t.previewHandle(t.data)}}},[i("i",{staticClass:"el-icon-zoom-in"})])]):t._e(),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.data.url,expression:"!data.url"}],staticClass:"c-upload-logo"},[t.data&&t.data.url?i("div",{staticClass:"u-logo"},[i("img",{attrs:{src:t.data.url}}),i("i",{staticClass:"u-logo-mask"}),i("i",{staticClass:"u-logo-delete el-icon-delete",attrs:{title:"移除"},on:{click:t.handleRemove}})]):i("div",{staticClass:"u-upload el-upload el-upload--picture-card",on:{click:t.select}},[i("i",{staticClass:"el-icon-plus"})]),i("input",{ref:"uploadInput",staticClass:"u-upload-input",attrs:{type:"file"},on:{change:t.upload}})]),t.data&&t.data.url?i("el-button",{staticClass:"u-remove-btn",attrs:{icon:"el-icon-delete"},on:{click:t.removePic}},[t._v("移除")]):t._e()],1),i("el-form-item",{attrs:{label:"描述"}},[i("el-input",{attrs:{placeholder:"图片说明"},model:{value:t.data.desc,callback:function(e){t.$set(t.data,"desc",e)},expression:"data.desc"}})],1),i("el-form-item",{attrs:{label:"原创"}},[i("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:t.data.original,callback:function(e){t.$set(t.data,"original",t._n(e))},expression:"data.original"}})],1),i("el-form-item",{attrs:{label:"原作者"}},[i("el-input",{attrs:{placeholder:"（非必填）"},model:{value:t.data.author,callback:function(e){t.$set(t.data,"author",e)},expression:"data.author"}})],1),i("div",{staticClass:"m-publish-buttons"},[i("el-button",{attrs:{type:"primary",disabled:t.processing},on:{click:t.update}},[t._v("更    新")])],1)],1):i("div",{staticClass:"m-publish-emotion m-publish-emotion-create"},[i("div",{staticClass:"m-publish-emotion-bulk"},[i("h1",{staticClass:"u-title"},[t._v("上传表情")]),i("UploadImages",{attrs:{text:"批量上传图片",onlyImage:!0,desc:"一次最多同时上传10个文件（不超过5M）",accept:t.supportTypes},on:{insert:t.updateFileList}})],1),t.list&&t.list.length?i("div",{staticClass:"m-publish-emotion-list"},[i("div",{staticClass:"u-list"},t._l(t.list,(function(e,a){return i("div",{key:a,staticClass:"u-item"},[i("div",{staticClass:"u-div"},[i("i",{staticClass:"u-order"},[t._v(t._s(a+1))]),i("div",{staticClass:"u-op"},[i("el-button",{staticClass:"u-delete",attrs:{icon:"el-icon-delete",type:"info",size:"mini"},on:{click:function(e){return t.deleteHandle(a)}}},[t._v("删除")])],1)]),i("div",{staticClass:"u-pic"},[i("img",{staticClass:"u-img",attrs:{src:t._f("showThumbnail")(e.url)}}),i("i",{staticClass:"u-mask"}),i("i",{staticClass:"u-preview",on:{click:function(i){return t.previewHandle(e)}}},[i("i",{staticClass:"el-icon-zoom-in"})])]),i("div",{staticClass:"u-desc"},[i("el-input",{attrs:{placeholder:"图片说明"},model:{value:e.desc,callback:function(i){t.$set(e,"desc",i)},expression:"item.desc"}},[i("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("描述")])])],1),i("div",{staticClass:"u-extend"},[i("el-switch",{attrs:{"inactive-text":"原创","active-value":1,"inactive-value":0},model:{value:e.original,callback:function(i){t.$set(e,"original",t._n(i))},expression:"item.original"}}),e.original?t._e():i("el-input",{staticClass:"u-author",attrs:{placeholder:"（非必填）",size:"mini"},model:{value:e.author,callback:function(i){t.$set(e,"author",i)},expression:"item.author"}},[i("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("原作者")])])],1)])})),0),i("div",{staticClass:"m-publish-buttons"},[i("el-button",{attrs:{type:"primary",disabled:t.processing},on:{click:t.publish}},[t._v("发    布")])],1)]):t._e()])]),i("el-dialog",{staticClass:"m-publish-emotion-preview",attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1)}),[],!1,null,null,null);e.default=u.exports}}]);
//# sourceMappingURL=chunk-d3aae0f0.a9d848d6.js.map
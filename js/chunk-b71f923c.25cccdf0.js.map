{"version":3,"sources":["webpack:///./src/post/skill.vue?f70b","webpack:///./src/post/skill.vue","webpack:///./src/post/skill.vue?587d","webpack:///src/post/skill.vue","webpack:///./src/post/skill.vue?5640","webpack:///./src/components/publish_header.vue?4823","webpack:///./src/components/publish_header.vue?6f8c","webpack:///src/components/publish_header.vue","webpack:///./src/components/publish_header.vue?3a87","webpack:///./src/components/publish_header.vue","webpack:///./src/service/node.js"],"names":["name","data","options","sources","post","id","content","source_id","remark","loading","processing","latest","current","computed","client","$store","state","_this$$route$query","$route","query","post_id","isLatest","_this$current","_this$current$post","_this$latest","_this$latest$post","methods","toPublish","_this","String","user_nickname","User","getInfo","_data","pick","wiki","update","_objectSpread","then","$message","message","type","setTimeout","$router","push","params","finally","icon_url_filter","icon_id","iconLink","search_handle","_this2","keyword","arguments","length","undefined","getSkillList","Name","res","list","loadData","_this3","get","skill","source","parseInt","exist","index","SkillID","loadDataByPostId","_this4","getById","loadLatest","_this5","getLink","getLatest","_this$latest$post2","created","watch","handler","val","_this6","console","log","components","header","Tinymce","component","_vm","this","_c","_self","staticClass","attrs","_t","_v","model","value","callback","$$v","$set","expression","_l","item","key","IconID","domProps","_s","scopedSlots","_u","fn","on","_e","proxy","props","goBack","window","history","go","mounted","getSkill","condition","isNaN","$node","concat","catch","err","getMobileForceSkillList","force_id","mount_id"],"mappings":"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","file":"js/chunk-b71f923c.25cccdf0.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./skill.vue?vue&type=style&index=0&id=c9dc2eac&prod&scoped=true&lang=less\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"m-publish-box\"},[_c('publish-header',{attrs:{\"name\":\"技能百科\"}},[_vm._t(\"header\")],2),_c('el-form',{staticClass:\"m-publish-post\"},[_c('div',{staticClass:\"m-publish-source\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"选择技能 *\")]),_c('el-select',{staticClass:\"u-source-id\",attrs:{\"disabled\":!!_vm.post.id,\"filterable\":\"\",\"remote\":\"\",\"remote-method\":_vm.search_handle,\"loading\":_vm.options.loading},model:{value:(_vm.post.source_id),callback:function ($$v) {_vm.$set(_vm.post, \"source_id\", $$v)},expression:\"post.source_id\"}},_vm._l((_vm.options.sources),function(item,index){return _c('el-option',{key:item.SkillID + '' + index,attrs:{\"label\":item.Name,\"value\":item.SkillID}},[_c('div',{staticClass:\"m-selector-item\"},[_c('img',{staticClass:\"u-icon\",attrs:{\"src\":_vm.icon_url_filter(item.IconID),\"alt\":item.Name}}),_c('span',{staticClass:\"u-name\",domProps:{\"textContent\":_vm._s(item.Name)}})])])}),1)],1),_c('div',{staticClass:\"m-publish-remark\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"修订说明 *\")]),_c('el-input',{attrs:{\"maxlength\":200,\"minlength\":1,\"show-word-limit\":\"\",\"required\":\"\",\"placeholder\":\"请简单描述一下本次修订的说明\"},model:{value:(_vm.post.remark),callback:function ($$v) {_vm.$set(_vm.post, \"remark\", $$v)},expression:\"post.remark\"}})],1),_c('div',{staticClass:\"m-publish-content\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"百科正文 *\")]),_c('Tinymce',{attrs:{\"attachmentEnable\":true,\"resourceEnable\":true,\"height\":400},model:{value:(_vm.post.content),callback:function ($$v) {_vm.$set(_vm.post, \"content\", $$v)},expression:\"post.content\"}},[(!_vm.isLatest && _vm.latest.post && _vm.current.post)?_c('el-alert',{staticClass:\"m-latest-check\",attrs:{\"type\":\"warning\",\"show-icon\":\"\"},scopedSlots:_vm._u([{key:\"title\",fn:function(){return [_c('span',{staticClass:\"u-alert-title\"},[_vm._v(\"当前百科已经有更新的版本，你的攻略可能已经失效，请先进行比对。\")]),_c('el-link',{staticClass:\"u-view-latest\",attrs:{\"type\":\"primary\",\"icon\":\"el-icon-link\",\"href\":_vm.getLink(_vm.post.source_id),\"target\":\"_blank\"}},[_vm._v(\"查看最新攻略\")]),(_vm.latest.post)?_c('el-link',{staticClass:\"u-get-latest\",attrs:{\"icon\":\"el-icon-download\",\"type\":\"primary\"},on:{\"click\":_vm.getLatest}},[_vm._v(\"获取最新攻略\")]):_vm._e()]},proxy:true}],null,false,2238318328)}):_vm._e()],1)],1),_c('div',{staticClass:\"m-publish-commit\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}}),_c('el-button',{staticClass:\"u-publish\",attrs:{\"icon\":\"el-icon-s-promotion\",\"type\":\"primary\",\"disabled\":_vm.processing},on:{\"click\":_vm.toPublish}},[_vm._v(\"提交百科 \")])],1)])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./skill.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./skill.vue?vue&type=script&lang=js\"","<template>\n    <div class=\"m-publish-box\">\n        <!-- 头部 -->\n        <publish-header name=\"技能百科\">\n            <slot name=\"header\"></slot>\n        </publish-header>\n\n        <el-form class=\"m-publish-post\">\n            <div class=\"m-publish-source\">\n                <el-divider content-position=\"left\">选择技能 *</el-divider>\n                <el-select class=\"u-source-id\" v-model=\"post.source_id\" :disabled=\"!!post.id\" filterable\n                    remote :remote-method=\"search_handle\" :loading=\"options.loading\">\n                    <el-option\n                        v-for=\"(item, index) in options.sources\"\n                        :key=\"item.SkillID + '' + index\"\n                        :label=\"item.Name\"\n                        :value=\"item.SkillID\"\n                    >\n                        <div class=\"m-selector-item\">\n                            <img class=\"u-icon\" :src=\"icon_url_filter(item.IconID)\" :alt=\"item.Name\" />\n                            <span class=\"u-name\" v-text=\"item.Name\"></span>\n                        </div>\n                    </el-option>\n                </el-select>\n            </div>\n\n            <div class=\"m-publish-remark\">\n                <el-divider content-position=\"left\">修订说明 *</el-divider>\n                <el-input\n                    v-model=\"post.remark\"\n                    :maxlength=\"200\"\n                    :minlength=\"1\"\n                    show-word-limit\n                    required\n                    placeholder=\"请简单描述一下本次修订的说明\"\n                ></el-input>\n            </div>\n\n            <div class=\"m-publish-content\">\n                <el-divider content-position=\"left\">百科正文 *</el-divider>\n                <Tinymce v-model=\"post.content\" :attachmentEnable=\"true\" :resourceEnable=\"true\" :height=\"400\">\n                    <el-alert type=\"warning\" class=\"m-latest-check\" show-icon v-if=\"!isLatest && latest.post && current.post\">\n                        <template #title>\n                            <span class=\"u-alert-title\">当前百科已经有更新的版本，你的攻略可能已经失效，请先进行比对。</span>\n                            <el-link type=\"primary\" icon=\"el-icon-link\" :href=\"getLink(post.source_id)\" target=\"_blank\" class=\"u-view-latest\">查看最新攻略</el-link>\n                            <el-link @click=\"getLatest\" icon=\"el-icon-download\" class=\"u-get-latest\" type=\"primary\" v-if=\"latest.post\">获取最新攻略</el-link>\n                        </template>\n                    </el-alert>\n                </Tinymce>\n            </div>\n\n            <div class=\"m-publish-commit\">\n                <el-divider content-position=\"left\"></el-divider>\n                <el-button\n                    class=\"u-publish\"\n                    icon=\"el-icon-s-promotion\"\n                    type=\"primary\"\n                    @click=\"toPublish\"\n                    :disabled=\"processing\"\n                    >提交百科\n                </el-button>\n            </div>\n        </el-form>\n    </div>\n</template>\n\n<script>\nimport header from \"@/components/publish_header.vue\";\nimport Tinymce from \"@jx3box/jx3box-editor/src/Tinymce\";\n\n// 本地依赖\nimport { wiki } from \"@jx3box/jx3box-common/js/wiki_v2\";\nimport User from \"@jx3box/jx3box-common/js/user\";\nimport { iconLink, getLink } from \"@jx3box/jx3box-common/js/utils\";\nimport { getSkillList } from \"@/service/node\"\nexport default {\n    name: \"skill\",\n    data() {\n        return {\n            //选项 - 加载可选项\n            options: {\n                sources: null,\n            },\n\n            //文章 - 主表数据\n            post: {\n                id: \"\", // 文章ID\n                content: \"\",\n                source_id: \"\",\n                remark: \"\",\n            },\n\n            // 状态控制\n            loading: false,\n            processing: false,\n\n            latest: {},\n            current: {}\n        };\n    },\n    computed: {\n        client: function () {\n            return this.$store.state.client;\n        },\n        id: function () {\n            return this.$route.query?.post_id;\n        },\n        // 当前比最新的攻略是否更新\n        isLatest : function (){\n            if(!this.current?.post?.id || !this.latest?.post?.id) return false\n            return this.current.post.id == this.latest.post.id\n        }\n    },\n    methods: {\n        toPublish: function () {\n            if (!this.post.source_id) {\n                this.$message({\n                    message: \"请选择要修订百科的技能\",\n                    type: \"warning\",\n                });\n                return;\n            }\n\n            if (!this.post.content) {\n                this.$message({ message: \"要编写百科正文哦\", type: \"warning\" });\n                return;\n            }\n\n            if (!this.post.remark) {\n                this.$message({\n                    message: \"请简单描述本次修订说明\",\n                    type: \"warning\",\n                });\n                return;\n            }\n\n            this.processing = true;\n            const data = {\n                source_id: String(this.post.source_id),\n                user_nickname: User.getInfo().name,\n                content: this.post.content,\n                remark: this.post.remark,\n            };\n            if (this.id) {\n                const _data = pick(data, [\"level\", \"content\", \"remark\"]);\n                wiki.update(this.id, { ..._data, client: this.client })\n                    .then((data) => {\n                        data = data.data;\n                        this.$message({\n                            message: \"提交成功，请等待审核\",\n                            type: \"success\",\n                        });\n                        setTimeout(() => {\n                            this.$router.push({ name: \"wiki_post\", params: { type: \"skill\" } });\n                        }, 500);\n                    })\n                    .finally(() => {\n                        this.processing = false;\n                    });\n            } else {\n                wiki.post({ type: \"skill\", ...data, client: this.client })\n                    .then((data) => {\n                        data = data.data;\n                        this.$message({\n                            message: \"提交成功，请等待审核\",\n                            type: \"success\",\n                        });\n                        setTimeout(() => {\n                            this.$router.push({ name: \"wiki_post\", params: { type: \"skill\" } });\n                        }, 500);\n                    })\n                    .finally(() => {\n                        this.processing = false;\n                    });\n            }\n        },\n        icon_url_filter(icon_id) {\n            return iconLink(icon_id);\n        },\n        // 技能搜索\n        search_handle(keyword = \"\") {\n            this.loading = true;\n            getSkillList({ Name: keyword }).then((res) => {\n                this.options.sources = res.data.list;\n                this.loading = false;\n            });\n        },\n        loadData: function (client) {\n            if (!this.post.source_id) return;\n            this.loading = true;\n            return wiki\n                .get({ type: \"skill\", id: this.post.source_id }, { client })\n                .then((res) => {\n                    let data = res.data;\n                    // 数据填充\n                    let post = data.data.post;\n                    let skill = data.data.source;\n\n                    if (post) {\n                        this.post.source_id = parseInt(post.source_id);\n                        this.post.remark = post.remark;\n                        this.post.content = post.content;\n                    } else {\n                        this.post.source_id = this.post.source_id ? parseInt(this.post.source_id) : \"\";\n                        this.post.remark = \"\";\n                        this.post.content = \"\";\n                    }\n\n                    if (skill) {\n                        // 将选择项恢复至下拉框\n                        let exist = false;\n                        this.options.sources = this.options.sources || [];\n                        for (let index in this.options.sources) {\n                            if (this.options.sources[index].SkillID == skill.SkillID) {\n                                exist = true;\n                                break;\n                            }\n                        }\n                        if (!exist) this.options.sources.push(skill);\n                    }\n\n                    return post;\n                })\n                .finally(() => {\n                    this.loading = false;\n                });\n        },\n        loadDataByPostId: function () {\n            this.loading = true;\n            return wiki\n                .getById(this.id)\n                .then((res) => {\n                    this.current = res.data.data;\n                    let data = res.data;\n                    // 数据填充\n                    let post = data.data.post;\n                    let skill = data.data.source;\n\n                    if (post) {\n                        this.post.source_id = parseInt(post.source_id);\n                        this.post.remark = post.remark;\n                        this.post.content = post.content;\n                    } else {\n                        this.post.source_id = this.post.source_id ? parseInt(this.post.source_id) : \"\";\n                        this.post.remark = \"\";\n                        this.post.content = \"\";\n                    }\n\n                    if (skill) {\n                        // 将选择项恢复至下拉框\n                        let exist = false;\n                        this.options.sources = this.options.sources || [];\n                        for (let index in this.options.sources) {\n                            if (this.options.sources[index].SkillID == skill.SkillID) {\n                                exist = true;\n                                break;\n                            }\n                        }\n                        if (!exist) this.options.sources.push(skill);\n                    }\n\n                    return post;\n                })\n                .finally(() => {\n                    this.loading = false;\n                });\n        },\n        // 获取最新的攻略\n        loadLatest() {\n            if (!this.post.source_id) return;\n            wiki.get({ type: \"skill\", id: this.post.source_id }).then(res => {\n                this.latest = res.data.data\n            })\n        },\n        getLink(id) {\n            return getLink(\"skill\", id);\n        },\n        getLatest() {\n            this.post.content = this.latest.post?.content || ''\n        }\n    },\n    created() {\n        this.search_handle();\n        // 获取成就ID并通过watch获取攻略\n        let id = this.$route.params.id;\n        this.post.source_id = id ? parseInt(id) : null;\n\n        this.loadLatest()\n    },\n    watch: {\n        \"post.source_id\": {\n            handler: function (val) {\n\n                if (this.id) {\n                    this.loadDataByPostId();\n                    return;\n                }\n\n                if (this.client == \"std\") {\n                    this.loadData(\"std\");\n                } else {\n                    this.loadData(\"origin\").then((post) => {\n                        console.log(\"兼容获取\");\n                        if (!post) {\n                            this.loadData(\"std\");\n                        }\n                    });\n                }\n            },\n        },\n    },\n    components: {\n        \"publish-header\": header,\n        Tinymce,\n    },\n};\n</script>\n\n<style scoped lang=\"less\">\n@import \"../assets/css/achievement.less\";\n@import \"../assets/css/wiki.less\";\n</style>\n","import { render, staticRenderFns } from \"./skill.vue?vue&type=template&id=c9dc2eac&scoped=true\"\nimport script from \"./skill.vue?vue&type=script&lang=js\"\nexport * from \"./skill.vue?vue&type=script&lang=js\"\nimport style0 from \"./skill.vue?vue&type=style&index=0&id=c9dc2eac&prod&scoped=true&lang=less\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"c9dc2eac\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_header.vue?vue&type=style&index=0&id=36319e52&prod&lang=less\"","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_header.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_header.vue?vue&type=script&lang=js\"","<template>\n    <div class=\"m-publish-header\">\n        <el-page-header @back=\"goBack\" :content=\"name\"></el-page-header>\n        <slot></slot>\n    </div>\n</template>\n\n<script>\nexport default {\n    name: \"publish_header\",\n    props: [\"name\"],\n    data: function() {\n        return {\n        };\n    },\n    computed: {},\n    methods: {\n        goBack: function() {\n            if(window.history.length){\n                this.$router.go(-1);\n            }else{\n                this.$router.push('/')\n            }\n        },\n    },\n    mounted: function() {},\n    components: {\n    },\n};\n</script>\n\n<style lang=\"less\">\n    .m-publish-header{\n        .pr;\n    }\n    \n</style>","import { render, staticRenderFns } from \"./publish_header.vue?vue&type=template&id=36319e52\"\nimport script from \"./publish_header.vue?vue&type=script&lang=js\"\nexport * from \"./publish_header.vue?vue&type=script&lang=js\"\nimport style0 from \"./publish_header.vue?vue&type=style&index=0&id=36319e52&prod&lang=less\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"m-publish-header\"},[_c('el-page-header',{attrs:{\"content\":_vm.name},on:{\"back\":_vm.goBack}}),_vm._t(\"default\")],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { $node } from \"@jx3box/jx3box-common/js/https\";\n\nfunction getSkill(query, params) {\n    let condition = isNaN(query) ? \"name\" : \"id\";\n    return $node().get(`/skill/${condition}/${query}`, {\n        params: params,\n    }).then(res => {\n        return res.data;\n    }).catch((err) => {\n        console.log(err);\n    });\n}\n\nfunction getSkillList(params) {\n    return $node().get(`/skill`, {\n        params: params,\n    })\n}\n\nfunction getMobileForceSkillList(force_id) {\n    return $node().get(\"/v2/kungfu/panel\", {\n        params: {\n            mount_id: force_id,\n            client: 'wujie'\n        },\n    });\n}\n\nexport { getSkill, getSkillList, getMobileForceSkillList };\n"],"sourceRoot":""}
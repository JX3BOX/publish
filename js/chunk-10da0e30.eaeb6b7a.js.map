{"version":3,"sources":["webpack:///./src/service/revision.js","webpack:///./src/utils/atAuthorMixin.js","webpack:///./src/service/pay.js","webpack:///./src/components/publish_revision.vue?9776","webpack:///./src/components/publish_revision.vue","webpack:///./src/components/publish_revision.vue?8cda","webpack:///src/components/publish_revision.vue","webpack:///./src/components/publish_revision.vue?006a","webpack:///./src/components/publish_category.vue?166c","webpack:///./src/post/community.vue?b343","webpack:///./src/components/publish_collection.vue?bca8","webpack:///./src/service/collection.js","webpack:///./src/service/community.js","webpack:///./src/components/publish_collection.vue","webpack:///./src/components/publish_collection.vue?3f41","webpack:///src/components/publish_collection.vue","webpack:///./src/components/publish_collection.vue?fd52","webpack:///./src/components/publish_at_authors.vue","webpack:///./src/components/publish_at_authors.vue?b872","webpack:///src/components/publish_at_authors.vue","webpack:///./src/components/publish_at_authors.vue?0cd1","webpack:///./src/components/publish_header.vue?4823","webpack:///./src/utils/cmsMetaMixin.js","webpack:///./src/post/community.vue","webpack:///./src/components/publish_category.vue?636c","webpack:///src/components/publish_category.vue","webpack:///./src/components/publish_category.vue?7ca9","webpack:///./src/components/publish_category.vue","webpack:///./src/post/community.vue?d948","webpack:///src/post/community.vue","webpack:///./src/post/community.vue?1fc4","webpack:///./src/components/publish_title.vue","webpack:///./src/components/publish_title.vue?ad03","webpack:///src/components/publish_title.vue","webpack:///./src/components/publish_title.vue?fc78","webpack:///./src/components/publish_at_authors.vue?2a9f","webpack:///./src/components/publish_header.vue?6f8c","webpack:///src/components/publish_header.vue","webpack:///./src/components/publish_header.vue?3a87","webpack:///./src/components/publish_header.vue"],"names":["addRevision","postId","data","$cms","post","concat","getRevision","revisionId","get","getRevisions","params","putRevision","put","removeRevision","delete","removeRevisions","ids","_atUser","atAuthorMixin","isSuperAuthor","computed","userInfo","User","getInfo","mounted","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","sent","stop","methods","atUser","_callee2","id","atAuthor","_context2","sessionStorage","getItem","_ref","sendUserId","this","uid","accessUserId","JSON","parse","postType","post_type","$pay","mute","removeItem","t0","console","log","_x","apply","arguments","name","props","type","String","Number","default","visible","Boolean","enable","show","per","page","total","loading","checked","checkedAll","isIndeterminate","isPostMode","$route","query","mode","ready","filters","revisionName","val","version","formatDate","gmt","showTime","Date","formatRemark","str","length","slice","view","loadList","then","res","list","map","item","$set","finally","remark","_this2","$prompt","confirmButtonText","cancelButtonText","closeOnClickModal","inputValue","value","$message","success","catch","checkChange","push","filter","c","checkAll","use","routeName","$router","post_id","del","_this3","$confirm","$notify","title","message","delRevisions","_this4","join","watch","deep","handler","component","_vm","_c","_self","staticClass","attrs","on","_v","$event","slot","directives","rawName","expression","model","callback","$$v","_l","i","key","_s","post_title","_f","updated_at","user_info","display_name","_e","get_my_collections","method","url","createCollection","updateCollection","remove_collection","collection_id","appendToCollection","post_collection","getCollectionRaw","API_PREFIX","$next","update","updateAdmin","getMyList","pull","pullAdmin","getAllCommunity","setVisibility","status","getMyReplyList","getMyReply","deleteMyReply","updateMyReply","getMyCommentList","deleteMyComment","collections","copyCollections","isInit","search","prop","event","isEmpty","immediate","newval","$emit","loadCollections","keyword","undefined","cloneDeep","remoteMethod","visibleChange","components","_t","_m","index","authorIds","window","addEventListener","handleSession","beforeDestroy","removeEventListener","oVal","loadUsers","e","newVal","getUserInfoByIds","remove","_ids","split","splice","setItem","stringify","showAvatar","user_avatar","cmsMetaMixin","hasRead","open_white_list","visible_for_self","from","is_illegal","initExtend","profile","$store","state","level","_this$profile","getLevel","experience","localStorage","setHasRead","loadCommentConfig","category","getCommentConfig","_res$data$data","_res$data$data2","setCommentConfig","setCommentVisible","removeBase64Img","content","replace","isExtraLink","startsWith","test","created","client","_this$$route$query","init","post_mode","count","links","match","_step","_iterator","_createForOfIteratorHelper","s","n","done","link","err","f","_step2","_iterator2","options","Array","required","_this$options","_this$options$","updateCategory","mixins","Tinymce","publish_header","publish_title","publish_collection","publish_revision","publish_category","publish_at_authors","skins","processing","decoration_id","is_self_visit","is_from_phone","currentDecorationId","community_types","tags","buckets","extraImages","_objectSpread","extra_images","introduction","getIntroduction","getTopicBucket","navigator","userAgent","goShopping","open","preventDefault","stopPropagation","setSkin","amount","getDecoration","__imgPath","publish","afterPublish","setTimeout","location","href","result","getImgSrc","htmlString","matches","imgSrcRegex","imgSrcs","exec","_toConsumableArray","Promise","resolve","reject","imgs","Set","class","collection_collapse","staticStyle","hideDiv","placeholder","goBack","history","go"],"mappings":"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","file":"js/chunk-10da0e30.eaeb6b7a.js","sourcesContent":["import { $cms } from \"@jx3box/jx3box-common/js/https.js\";\r\n\r\nconst addRevision = (postId, data) => {\r\n    return $cms().post(`/api/cms/post/${postId}/revision`, data);\r\n};\r\n\r\nconst getRevision = (postId, revisionId) => {\r\n    return $cms().get(`/api/cms/post/${postId}/revision/${revisionId}`);\r\n};\r\n\r\nconst getRevisions = (postId, params) => {\r\n    return $cms().get(`/api/cms/post/${postId}/revisions`, {\r\n        params,\r\n    });\r\n};\r\n\r\nconst putRevision = (postId, revisionId, data) => {\r\n    return $cms().put(`/api/cms/post/${postId}/revision/${revisionId}`, data);\r\n};\r\n\r\nconst removeRevision = (postId, revisionId) => {\r\n    return $cms().delete(`/api/cms/post/${postId}/revision/${revisionId}`);\r\n};\r\n\r\nconst removeRevisions = (postId, ids) => {\r\n    return $cms().delete(`/api/cms/post/${postId}/revisions?list=${ids}`);\r\n};\r\n\r\nexport { addRevision, getRevision, getRevisions, putRevision, removeRevisions, removeRevision };\r\n","import { atAuthors } from \"@/service/pay.js\";\nimport User from \"@jx3box/jx3box-common/js/user\";\n\nexport const atAuthorMixin = {\n    data() {\n        return {\n            isSuperAuthor: false\n        }\n    },\n    computed: {\n        userInfo() {\n            return User.getInfo();\n        }\n    },\n    async mounted() {\n        this.isSuperAuthor = await User.isSuperAuthor();\n    },\n    methods: {\n        // at其他用户\n        atUser: async function (id){\n            try {\n                let atAuthor = sessionStorage.getItem('atAuthor');\n                if (atAuthor) {\n                    await atAuthors({ sendUserId: this.userInfo.uid, accessUserId: JSON.parse(atAuthor), postId: id || this.id, postType: this.post_type || this.post.post_type });\n                    sessionStorage.removeItem('atAuthor');\n                }\n            } catch (error) {\n                console.log(error);\n            }\n        }\n    }\n}\n","import { $pay } from \"@jx3box/jx3box-common/js/https\";\n\n// 文章中 at 某人\nfunction atAuthors({ sendUserId, accessUserId, postId, postType }){\n    return $pay({ mute: true }).get(`/api/horn/${sendUserId}/to/user/article/${postType}/${postId}`, {\n        params: {\n            accessUserId,\n        }\n    });\n}\n\nexport { atAuthors };\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_revision.vue?vue&type=style&index=0&id=faa85e78&prod&lang=less\"","var render = function render(){var _vm=this,_c=_vm._self._c;return (_vm.ready)?_c('div',{staticClass:\"m-revision\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\",\"icon\":\"el-icon-folder\"},on:{\"click\":_vm.view}},[_vm._v(\"历史版本\")]),_c('el-drawer',{staticClass:\"m-revision-drawer\",attrs:{\"title\":\"历史版本\",\"visible\":_vm.show,\"z-index\":\"2100\",\"append-to-body\":\"\"},on:{\"update:visible\":function($event){_vm.show=$event}}},[_c('h3',{staticClass:\"u-revision-title\",attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(\"历史版本\")]),_c('main',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticClass:\"m-revision-container\"},[_c('div',{staticClass:\"u-actions\"},[_c('el-checkbox',{attrs:{\"indeterminate\":_vm.isIndeterminate},on:{\"change\":_vm.checkAll},model:{value:(_vm.checkedAll),callback:function ($$v) {_vm.checkedAll=$$v},expression:\"checkedAll\"}},[_vm._v(\"全选\")]),_c('el-button',{staticClass:\"u-empty\",attrs:{\"size\":\"mini\",\"plain\":\"\",\"icon\":\"el-icon-delete\",\"disabled\":!_vm.checked || !_vm.checked.length},on:{\"click\":_vm.delRevisions}},[_vm._v(\"批量删除\")])],1),_c('div',{staticClass:\"m-revision-list\"},[(_vm.data && _vm.data.length)?_c('ul',{staticClass:\"u-list\"},[_vm._l((_vm.data),function(item,i){return _c('li',{key:i,staticClass:\"m-revision-item\"},[_c('span',{staticClass:\"u-name\"},[_c('el-checkbox',{staticClass:\"u-checkbox\",on:{\"change\":(val) => _vm.checkChange(val, item)},model:{value:(item.checked),callback:function ($$v) {_vm.$set(item, \"checked\", $$v)},expression:\"item.checked\"}}),_c('el-tooltip',{staticClass:\"item\",attrs:{\"effect\":\"dark\",\"content\":item.remark,\"placement\":\"top\",\"disabled\":!item.remark}},[_c('span',[_c('i',{staticClass:\"u-icon el-icon-tickets\"}),_c('span',{staticClass:\"u-remark\"},[_vm._v(_vm._s(item.remark ? _vm.formatRemark(item.remark) : item.post_title))])])]),_c('em',{staticClass:\"u-time\"},[_vm._v(_vm._s(_vm._f(\"formatDate\")(item.updated_at)))]),(item.user_info)?_c('span',{staticClass:\"u-creator\",attrs:{\"title\":\"创建人\"}},[_vm._v(_vm._s(item.user_info.display_name))]):_vm._e(),_c('i',{staticClass:\"u-edit el-icon-edit\",attrs:{\"title\":\"添加备注\"},on:{\"click\":function($event){return _vm.remark(item)}}})],1),_c('el-button-group',[_c('el-button',{attrs:{\"size\":\"mini\",\"icon\":\"el-icon-view\",\"title\":\"预览\"},on:{\"click\":function($event){return _vm.use(item)}}}),_c('el-button',{attrs:{\"size\":\"mini\",\"icon\":\"el-icon-delete\",\"title\":\"删除\"},on:{\"click\":function($event){return _vm.del(item)}}})],1)],1)}),_c('el-pagination',{staticClass:\"u-pagination\",attrs:{\"background\":\"\",\"hide-on-single-page\":\"\",\"layout\":\"prev,pager,next,->,total\",\"total\":_vm.total,\"page-size\":_vm.per,\"current-page\":_vm.page},on:{\"update:currentPage\":function($event){_vm.page=$event},\"update:current-page\":function($event){_vm.page=$event}}})],2):_c('el-alert',{staticClass:\"u-null\",attrs:{\"title\":\"当前没有任何历史版本\",\"type\":\"info\",\"show-icon\":\"\"}})],1)])])],1):_vm._e()\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_revision.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_revision.vue?vue&type=script&lang=js\"","<template>\n    <div class=\"m-revision\" v-if=\"ready\">\n        <el-button type=\"primary\" @click=\"view\" size=\"small\" icon=\"el-icon-folder\">历史版本</el-button>\n\n        <el-drawer title=\"历史版本\" :visible.sync=\"show\" z-index=\"2100\" class=\"m-revision-drawer\" append-to-body>\n            <h3 class=\"u-revision-title\" slot=\"title\">历史版本</h3>\n            <main class=\"m-revision-container\" v-loading=\"loading\">\n                <div class=\"u-actions\">\n                    <el-checkbox :indeterminate=\"isIndeterminate\" v-model=\"checkedAll\" @change=\"checkAll\">全选</el-checkbox>\n                    <el-button class=\"u-empty\" size=\"mini\" plain icon=\"el-icon-delete\" @click=\"delRevisions\" :disabled=\"!checked || !checked.length\">批量删除</el-button>\n                </div>\n                <div class=\"m-revision-list\">\n                    <ul class=\"u-list\" v-if=\"data && data.length\">\n                        <li class=\"m-revision-item\" v-for=\"(item, i) in data\" :key=\"i\">\n                            <span class=\"u-name\">\n                                <el-checkbox class=\"u-checkbox\" v-model=\"item.checked\" @change=\"(val) => checkChange(val, item)\"></el-checkbox>\n                                <el-tooltip class=\"item\" effect=\"dark\" :content=\"item.remark\" placement=\"top\" :disabled=\"!item.remark\">\n                                    <span>\n                                        <i class=\"u-icon el-icon-tickets\"></i>\n                                    <span class=\"u-remark\">{{ item.remark ? formatRemark(item.remark) : item.post_title }}</span>\n                                    </span>\n                                </el-tooltip>\n                                <em class=\"u-time\">{{ item.updated_at | formatDate }}</em>\n                                <span class=\"u-creator\" v-if=\"item.user_info\" title=\"创建人\">{{ item.user_info.display_name }}</span>\n                                <i class=\"u-edit el-icon-edit\" @click=\"remark(item)\" title=\"添加备注\"></i>\n                            </span>\n\n                            <el-button-group>\n                                <el-button size=\"mini\" icon=\"el-icon-view\" @click=\"use(item)\" title=\"预览\"></el-button>\n                                <el-button size=\"mini\" icon=\"el-icon-delete\" @click=\"del(item)\" title=\"删除\"></el-button>\n                            </el-button-group>\n                        </li>\n\n                        <el-pagination\n                            class=\"u-pagination\"\n                            background\n                            hide-on-single-page\n                            layout=\"prev,pager,next,->,total\"\n                            :total=\"total\"\n                            :page-size=\"per\"\n                            :current-page.sync=\"page\"\n                        ></el-pagination>\n                    </ul>\n\n                    <el-alert class=\"u-null\" v-else title=\"当前没有任何历史版本\" type=\"info\" show-icon></el-alert>\n                </div>\n            </main>\n        </el-drawer>\n    </div>\n</template>\n\n<script>\nimport { getRevisions, putRevision, removeRevision, removeRevisions } from \"@/service/revision\";\nimport { showTime } from \"@jx3box/jx3box-common/js/moment\";\nexport default {\n    name: \"publish_revision\",\n    props: {\n        postId: {\n            type: [String, Number],\n            default: 0,\n        },\n        visible: {\n            type: Boolean,\n            default: true,\n        },\n        enable: {\n            type: Boolean,\n            default: false,\n        },\n    },\n    data() {\n        return {\n            show: false,\n            data: [\n                // {\n                //     id: 1,\n                //     version: 1,\n                //     updated_at: \"2021-12-19 16:29\",\n                //     remark: \"\",\n                //     data: {},\n                //     checked: false,\n                // },\n            ],\n\n            per: 10,\n            page: 1,\n            total: 0,\n            loading: false,\n\n            checked: [],\n            checkedAll: false,\n            isIndeterminate: false,\n        };\n    },\n    computed: {\n        params() {\n            return {\n                page: this.page,\n                per: this.per,\n            };\n        },\n        isPostMode: function() {\n            return !this.$route.query.mode || this.$route.query.mode == \"default\";\n        },\n        ready: function() {\n            // 栏目启用 && 非新文 && 非草稿|历史版本模式\n            return this.enable && this.postId && this.isPostMode;\n        },\n    },\n    filters: {\n        revisionName(val) {\n            return `版本${val.version}`;\n        },\n        formatDate: function(gmt) {\n            return showTime(new Date(gmt));\n        },\n    },\n    methods: {\n        formatRemark: function(str) {\n            return str?.length > 10 ? str.slice(0, 10) + \"..\" : str;\n        },\n        view() {\n            if (!this.postId) return;\n            this.show = true;\n            this.loadList();\n        },\n        loadList() {\n            this.loading = true;\n            getRevisions(this.postId, this.params)\n                .then((res) => {\n                    this.data = res.data.data.list.map((item) => {\n                        this.$set(item, \"checked\", false);\n                        return item;\n                    });\n                    this.page = res.data.data.page;\n                    this.per = res.data.data.per;\n                    this.total = res.data.data.total;\n                })\n                .finally(() => {\n                    this.loading = false;\n                });\n        },\n        remark(item) {\n            this.$prompt(\"请输入备注\", \"提示\", {\n                confirmButtonText: \"确定\",\n                cancelButtonText: \"取消\",\n                closeOnClickModal: false,\n                inputValue: item.remark || \"\",\n            }).then(({ value }) => {\n                // item.remark = value\n                putRevision(this.postId, item.id, { remark: value })\n                    .then(() => {\n                        this.$message.success(\"备注添加成功\");\n                        item.remark = value;\n                        return true;\n                    })\n                    .catch(() => {\n                        return false;\n                    });\n            });\n        },\n        checkChange(val, item) {\n            if (val) {\n                this.checked.push(item.id);\n            } else {\n                this.checked = this.checked.filter((c) => c !== item.id);\n            }\n            this.checkedAll = this.checked.length === this.data.length;\n        },\n        checkAll(val) {\n            if (val) {\n                this.checked = this.data.map((item) => item.id);\n                this.data.map((item) => {\n                    item.checked = true;\n                    return item;\n                });\n            } else {\n                this.checked = [];\n                this.data.map((item) => {\n                    item.checked = false;\n                    return item;\n                });\n            }\n            this.isIndeterminate = false;\n\n            console.log(this.checked);\n        },\n        use(item) {\n            const routeName = this.$route.name;\n            this.$router.push(`/${routeName}/${item.post_id}/?mode=revision&id=${item.id}`);\n        },\n        del(item) {\n            this.$confirm(`确认删除【版本-${item.version}】吗？`, \"提示\", {\n                confirmButtonText: \"确定\",\n                cancelButtonText: \"取消\",\n                type: \"warning\",\n            }).then(() => {\n                removeRevision(this.postId, item.id).then(() => {\n                    this.$notify({\n                        type: \"success\",\n                        title: \"成功\",\n                        message: \"历史版本删除成功\",\n                    });\n\n                    this.loadList();\n                });\n            });\n        },\n        delRevisions() {\n            this.$confirm(`确认删除选中的历史版本？`, \"提示\", {\n                confirmButtonText: \"确定\",\n                cancelButtonText: \"取消\",\n                type: \"warning\",\n            }).then(() => {\n                const ids = this.checked.join(\",\");\n                removeRevisions(this.postId, ids).then(() => {\n                    this.$notify({\n                        type: \"success\",\n                        title: \"成功\",\n                        message: \"历史版本删除成功\",\n                    });\n\n                    this.checkedAll = false;\n                    this.checked = [];\n\n                    if (this.page === 1) {\n                        this.loadList();\n                    } else {\n                        this.page = 1;\n                    }\n\n                });\n            });\n        },\n    },\n    watch: {\n        params: {\n            deep: true,\n            handler() {\n                this.loadList();\n            },\n        },\n    },\n};\n</script>\n\n<style lang=\"less\">\n.m-revision {\n    .pa;\n    .rt(0);\n}\n.m-revision-drawer {\n    .size(100%);\n    .pf;\n    .rt(0);\n\n    .el-drawer {\n        min-width: 420px;\n    }\n\n    .u-revision-title {\n        margin: 0;\n    }\n    .m-revision-container {\n        padding: 0 10px;\n\n        .u-actions {\n            display: flex;\n            align-items: center;\n            .ml(15px);\n            min-height: 28px;\n        }\n        .u-empty {\n            .ml(10px);\n        }\n        .u-null {\n            .mt(10px);\n        }\n    }\n\n    .m-revision-list {\n        .u-list {\n            margin: 0;\n            padding: 0;\n            list-style: none;\n        }\n        .u-pagination {\n            .mt(20px);\n            text-align: center;\n        }\n    }\n\n    .m-revision-item {\n        display: flex;\n        justify-content: space-between;\n        height: 40px;\n        align-items: center;\n        padding: 5px;\n        .fz(12px, 28px);\n        border-bottom: 1px dashed #eee;\n        white-space: nowrap;\n\n        .u-checkbox {\n            .mr(5px);\n        }\n\n        .u-edit {\n            cursor: pointer;\n            color: @color-link !important;\n            .ml(5px);\n        }\n\n        .u-time {\n            color: #999;\n            .ml(5px);\n            font-style: normal;\n        }\n        .u-remark span {\n            color: #fba524;\n        }\n\n        .u-name {\n            .ml(10px);\n            i {\n                .fz(16px);\n                color: #888;\n                .y(-2px);\n                .mr(5px);\n            }\n        }\n\n        .u-creator {\n            margin-left: 5px;\n            margin-right: 5px;\n        }\n    }\n}\n@media screen and (max-width: @ipad) {\n    .m-revision-drawer {\n        .el-drawer {\n            .w(100%) !important;\n            overflow-y: auto;\n            min-width: 0;\n        }\n    }\n}\n@media screen and (max-width: @ip5) {\n    .m-revision-drawer .m-revision-list .m-revision-item {\n        .h(auto);\n        flex-wrap: wrap;\n    }\n}\n</style>\n","import { render, staticRenderFns } from \"./publish_revision.vue?vue&type=template&id=faa85e78\"\nimport script from \"./publish_revision.vue?vue&type=script&lang=js\"\nexport * from \"./publish_revision.vue?vue&type=script&lang=js\"\nimport style0 from \"./publish_revision.vue?vue&type=style&index=0&id=faa85e78&prod&lang=less\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_category.vue?vue&type=style&index=0&id=434df3b2&prod&lang=less\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./community.vue?vue&type=style&index=0&id=3ad1ac18&prod&lang=less\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_collection.vue?vue&type=style&index=0&id=2e1de9e7&prod&lang=less\"","import { $cms } from \"@jx3box/jx3box-common/js/https.js\";\n\nfunction get_my_collections(params) {\n    return $cms()({\n        method: \"GET\",\n        url: `/api/cms/post/collection/mine`,\n        params: params,\n    });\n}\n\n\nfunction createCollection(data){\n    return $cms().post(`/api/cms/post/collection`, data);\n}\n\nfunction updateCollection(id, data){\n    return $cms().put(`/api/cms/post/collection/${id}`, data);\n}\n\nfunction remove_collection(collection_id) {\n    return $cms().delete(`/api/cms/post/collection/${collection_id}`);\n}\n\nfunction appendToCollection(data) {\n    return $cms().post(`/api/cms/post/${data.post_type}-${data.post_id}/append-to-collection/${data.post_collection}`, {\n        title: data.post_title,\n    });\n}\n\nfunction getCollectionRaw(collection_id) {\n    return $cms()({\n        method: \"GET\",\n        url: `/api/cms/post/collection/${collection_id}/raw`,\n    });\n}\n\nexport { get_my_collections, remove_collection, appendToCollection, createCollection, updateCollection, getCollectionRaw };\n","import { $next } from \"@jx3box/jx3box-common/js/https\";\n\nconst API_PREFIX = `/api/next2`;\n// 发布\nfunction push(params) {\n    return $next().post(`${API_PREFIX}/community/discussion/topic`, params);\n}\n\nfunction update(id, params) {\n    return $next().put(`${API_PREFIX}/community/discussion/my/topic/item/${id}`, params);\n}\n\nfunction updateAdmin(id, params) {\n    return $next().put(`${API_PREFIX}/community/discussion/manage/topic/item/${id}/update`, params);\n}\n\nfunction getMyList(params) {\n    return $next().get(`${API_PREFIX}/community/discussion/my/topic/list`, { params });\n}\nfunction del(id) {\n    return $next().delete(`${API_PREFIX}/community/discussion/my/topic/item/${id}`);\n}\n\nfunction pull(id) {\n    return $next().get(`${API_PREFIX}/community/discussion/my/topic/item/${id}`);\n}\n\nfunction pullAdmin(id) {\n    return $next().get(`${API_PREFIX}/community/discussion/manage/topic/item/${id}`);\n}\n\nfunction getAllCommunity(params) {\n    return $next().get(`${API_PREFIX}/community/discussion/topic/list`, { params });\n}\n\n// 设置可见性\nfunction setVisibility(id, status) {\n    return $next().put(`${API_PREFIX}/community/discussion/my/topic/item/${id}/self-visit/${status}`);\n}\n\n// =============  我的回帖 =============\n\n// 获取回帖列表\nfunction getMyReplyList(params) {\n    return $next().get(`${API_PREFIX}/community/discussion/my/reply/list`, { params });\n}\n\n// 获取我的回帖\nfunction getMyReply(id) {\n    return $next().get(`${API_PREFIX}/community/discussion/my/reply/item/${id}`);\n}\n\n// 删除我的回帖\nfunction deleteMyReply(id) {\n    return $next().delete(`${API_PREFIX}/community/discussion/my/reply/item/${id}`);\n}\n\n// 更新我的回帖\nfunction updateMyReply(id, data) {\n    return $next().put(`${API_PREFIX}/community/discussion/my/reply/item/${id}`, data);\n}\n\n// =============  我的评论 =============\n\n// 获取评论列表\nfunction getMyCommentList(params) {\n    return $next().get(`${API_PREFIX}/community/discussion/my/comment/list`, { params });\n}\n\n// 删除我的评论\nfunction deleteMyComment(id) {\n    return $next().delete(`${API_PREFIX}/community/discussion/my/comment/item/${id}`);\n}\n\nexport {\n    push,\n    getMyList,\n    getAllCommunity,\n    setVisibility,\n    del,\n    pull,\n    update,\n    getMyReplyList,\n    getMyReply,\n    deleteMyReply,\n    updateMyReply,\n    getMyCommentList,\n    deleteMyComment,\n\n    pullAdmin,\n    updateAdmin,\n};\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"m-publish-collection-relation\"},[_c('h5',{staticClass:\"u-schema\"},[_c('a',{staticClass:\"u-add el-button el-button--primary el-button--mini\",attrs:{\"href\":\"/publish/#/collection\",\"target\":\"_blank\"}},[_vm._v(\"+ 创建小册\")]),_vm._t(\"default\"),_vm._m(0)],2),_c('el-select',{staticClass:\"u-collection\",attrs:{\"remote\":\"\",\"remote-method\":_vm.remoteMethod,\"loading\":_vm.loading,\"filterable\":\"\",\"clearable\":\"\",\"placeholder\":\"请选择一个小册（可选，非必填，可搜索）\"},on:{\"visible-change\":_vm.visibleChange},model:{value:(_vm.post_collection),callback:function ($$v) {_vm.post_collection=$$v},expression:\"post_collection\"}},[_vm._l((_vm.collections),function(item,index){return _c('el-option',{key:index,attrs:{\"label\":item.title,\"value\":item.id}})}),_c('div',{staticClass:\"u-collection-null\",attrs:{\"slot\":\"empty\"},slot:\"empty\"},[_c('div',[_vm._v(\" 没有找到匹配结果， \"),_c('a',{attrs:{\"href\":\"/publish/#/collection\",\"target\":\"_blank\"}},[_vm._v(\"创建小册\")])])])],2),(_vm.isEmpty)?_c('div',{staticClass:\"u-tip\"},[_c('i',{staticClass:\"el-icon-info\"}),_vm._v(\" 当前没有任何小册， \"),_c('a',{attrs:{\"href\":\"/publish/#/collection\",\"target\":\"_blank\"}},[_vm._v(\"创建小册\")])]):_vm._e()],1)\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('a',{staticClass:\"u-help u-icon-links\",attrs:{\"href\":\"/tool/20891\",\"target\":\"_blank\"}},[_c('i',{staticClass:\"el-icon-question\"}),_vm._v(\" 小册帮助指南 \")])\n}]\n\nexport { render, staticRenderFns }","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_collection.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_collection.vue?vue&type=script&lang=js\"","<template>\n    <div class=\"m-publish-collection-relation\">\n        <h5 class=\"u-schema\">\n            <!-- <span class=\"u-label\">关联小册</span> -->\n            <a class=\"u-add el-button el-button--primary el-button--mini\" href=\"/publish/#/collection\" target=\"_blank\">+ 创建小册</a>\n            <slot></slot>\n            <a class=\"u-help u-icon-links\" href=\"/tool/20891\" target=\"_blank\">\n                <i class=\"el-icon-question\"></i> 小册帮助指南\n            </a>\n        </h5>\n        <el-select\n            class=\"u-collection\"\n            v-model=\"post_collection\"\n            remote\n            :remote-method=\"remoteMethod\"\n            :loading=\"loading\"\n            filterable\n            clearable\n            placeholder=\"请选择一个小册（可选，非必填，可搜索）\"\n            @visible-change=\"visibleChange\"\n        >\n            <el-option\n                v-for=\"(item, index) in collections\"\n                :key=\"index\"\n                :label=\"item.title\"\n                :value=\"item.id\"\n            ></el-option>\n            <div slot=\"empty\" class=\"u-collection-null\">\n                <div>\n                    没有找到匹配结果，\n                    <a href=\"/publish/#/collection\" target=\"_blank\">创建小册</a>\n                </div>\n            </div>\n        </el-select>\n        <div class=\"u-tip\" v-if=\"isEmpty\">\n            <i class=\"el-icon-info\"></i> 当前没有任何小册，\n            <a href=\"/publish/#/collection\" target=\"_blank\">创建小册</a>\n        </div>\n    </div>\n</template>\n<script>\nimport { get_my_collections } from \"@/service/collection\";\nimport cloneDeep from \"lodash/cloneDeep\";\nexport default {\n    name: \"publish_collection\",\n    props: [\"data\"],\n    data: function () {\n        return {\n            post_collection: \"\",\n\n            collections: [],\n            copyCollections: [],\n\n            isInit: true,\n            loading: false,\n            search: \"\",\n        };\n    },\n    model: {\n        prop: \"data\", //向上同步数据\n        event: \"update\",\n    },\n    computed: {\n        isEmpty: function () {\n            return !this.search && !this.collections.length;\n        },\n    },\n    watch: {\n        data: {\n            immediate: true,\n            handler(newval) {\n                this.post_collection = Number(newval) || \"\";\n            },\n        },\n        post_collection: {\n            handler: function (newval) {\n                this.$emit(\"update\", newval);\n            },\n        },\n    },\n    methods: {\n        loadCollections: function (keyword = \"\") {\n            const params = {\n                keyword,\n            };\n            get_my_collections(params).then((res) => {\n                this.collections = res.data.data.list;\n\n                if (this.isInit) {\n                    this.copyCollections = cloneDeep(this.collections);\n                    this.isInit = false;\n                }\n            });\n        },\n        remoteMethod: function (keyword = \"\") {\n            this.search = keyword;\n            this.loading = true;\n            if (keyword !== \"\") {\n                const params = {\n                    keyword,\n                };\n                get_my_collections(params).then((res) => {\n                    this.collections = res.data.data.list;\n                    this.loading = false;\n                });\n            } else {\n                this.collections = cloneDeep(this.copyCollections);\n            }\n        },\n        visibleChange: function (val) {\n            if (val) {\n                this.collections = cloneDeep(this.copyCollections);\n            }\n        },\n    },\n    mounted: function () {\n        this.loadCollections();\n    },\n    components: {},\n};\n</script>\n\n\n<style lang=\"less\">\n.u-collection-null {\n    padding: 5px 10px;\n    .x;\n    .fz(13px,34px);\n    color: #999;\n    a {\n        box-shadow: 0 1px 0 @color-link;\n    }\n}\n.m-publish-collection-relation {\n    h5 {\n        margin: 20px 0;\n        font-size: 14px;\n        line-height: 18px;\n        font-weight: normal;\n    }\n\n    .u-icon-links {\n        margin-left: 10px;\n        font-size: 13px;\n        color: #0366d6;\n        box-shadow: 0 1px 0 #0366d6;\n\n        &:hover {\n            color: @pink;\n            box-shadow: 0 1px 0 #f39;\n        }\n    }\n\n    // .u-add{\n    //     .ml(5px);\n    // }\n    .u-help {\n        .fr;\n    }\n    .u-collapse {\n        .ml(20px);\n    }\n    .u-collection {\n        .w(100%);\n    }\n    .u-tip {\n        .fz(13px);\n        color: #999;\n        .mt(8px);\n        a {\n            box-shadow: 0 1px 0 @color-link;\n        }\n    }\n}\n</style>\n","import { render, staticRenderFns } from \"./publish_collection.vue?vue&type=template&id=2e1de9e7\"\nimport script from \"./publish_collection.vue?vue&type=script&lang=js\"\nexport * from \"./publish_collection.vue?vue&type=script&lang=js\"\nimport style0 from \"./publish_collection.vue?vue&type=style&index=0&id=2e1de9e7&prod&lang=less\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"m-publish-authors\"},[_c('el-form-item',{attrs:{\"label\":\"@圈一下\"}},[_c('div',{staticClass:\"u-list\"},_vm._l((_vm.list),function(item,i){return _c('div',{key:i,staticClass:\"u-item\"},[_c('img',{staticClass:\"u-avatar\",attrs:{\"src\":_vm._f(\"showAvatar\")(item.user_avatar)}}),_c('span',{staticClass:\"u-name\"},[_vm._v(\" \"+_vm._s(item.display_name)+\" \")]),_c('el-tooltip',{staticClass:\"item\",attrs:{\"effect\":\"dark\",\"content\":\"移除\",\"placement\":\"top\"}},[_c('i',{staticClass:\"u-delete el-icon-delete\",on:{\"click\":function($event){return _vm.remove(item,i)}}})])],1)}),0)])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_at_authors.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_at_authors.vue?vue&type=script&lang=js\"","<template>\n    <div class=\"m-publish-authors\">\n        <el-form-item label=\"@圈一下\">\n            <div class=\"u-list\">\n                <div class=\"u-item\" v-for=\"(item,i) in list\" :key=\"i\">\n                    <img class=\"u-avatar\" :src=\"item.user_avatar | showAvatar\" />\n                    <span class=\"u-name\">\n                        {{item.display_name}}\n                    </span>\n                    <el-tooltip class=\"item\" effect=\"dark\" content=\"移除\" placement=\"top\">\n                        <i class=\"u-delete el-icon-delete\" @click=\"remove(item,i)\"></i>\n                    </el-tooltip>\n                </div>\n            </div>\n        </el-form-item>\n    </div>\n</template>\n\n<script>\nimport { getUserInfoByIds } from \"@/service/user.js\";\nimport { showAvatar } from \"@jx3box/jx3box-common/js/utils\";\nexport default {\n    name: 'publish_at_authors',\n    data() {\n        return {\n            authorIds: [],\n            list: [],\n        }\n    },\n    mounted() {\n        window.addEventListener('setItemEvent', this.handleSession)\n    },\n    beforeDestroy() {\n        window.removeEventListener('setItemEvent', this.handleSession)\n    },\n    watch: {\n        authorIds: {\n            deep: true,\n            handler(val, oVal) {\n                if (val.length > oVal.length) {\n                    this.loadUsers();\n                }\n            }\n        }\n    },\n    methods: {\n        handleSession (e) {\n            if (e.key !== 'atAuthor') return\n            try {\n                const newVal = JSON.parse(e.newVal);\n                this.authorIds = newVal;\n            } catch(e) {\n                console.log(e)\n                this.authorIds = [];\n            }\n        },\n        loadUsers() {\n            getUserInfoByIds(this.authorIds).then(res => {\n                this.list = res.data.data;\n            })\n        },\n        remove(item, i) {\n            const _ids = this.authorIds.split(',')\n            _ids.splice(i, 1);\n            this.list.splice(i, 1);\n            _ids.length ? sessionStorage.setItem('atAuthor', JSON.stringify(_ids.join(','))) : sessionStorage.removeItem('atAuthor');\n        }\n    },\n    filters: {\n        showAvatar: function (val) {\n            return showAvatar(val);\n        },\n    },\n}\n</script>\n\n<style lang=\"less\" scoped>\n.m-publish-authors {\n    .el-form-item__content {\n        .fz(14px,16px) !important;\n    }\n\n    .u-list {\n        padding: 6px 0;\n        // display: flex;\n        .clearfix;\n        .el-button,.u-item{\n            .fl;\n        }\n        .u-item {\n            display: flex;\n            align-items: center;\n            border: 1px solid #dcdfe6;\n            padding: 2px 8px;\n            // background-color: #f5f7fa;\n            .r(3px);\n            .mr(10px);\n            // flex-shrink: 0;\n            .mb(10px);\n            .h(32px);\n            box-sizing: border-box;\n        }\n        .u-avatar {\n            .size(24px);\n            .y;\n            .mr(5px);\n            .r(100%);\n        }\n        .u-name {\n            .mr(5px);\n            .bold;\n        }\n        .u-delete,\n        .u-edit {\n            // .ml(10px);\n            color: #888;\n            .pointer;\n            padding: 5px 4px;\n        }\n        .u-delete:hover {\n            color: #f00;\n        }\n    }\n}\n</style>\n","import { render, staticRenderFns } from \"./publish_at_authors.vue?vue&type=template&id=07522ff3&scoped=true\"\nimport script from \"./publish_at_authors.vue?vue&type=script&lang=js\"\nexport * from \"./publish_at_authors.vue?vue&type=script&lang=js\"\nimport style0 from \"./publish_at_authors.vue?vue&type=style&index=0&id=07522ff3&prod&lang=less&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"07522ff3\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_header.vue?vue&type=style&index=0&id=36319e52&prod&lang=less\"","import {setCommentConfig, getCommentConfig, setCommentVisible} from \"@/service/next\"\nimport User from \"@jx3box/jx3box-common/js/user\";\nexport const cmsMetaMixin = {\n    data: function() {\n        return {\n            hasRead: 0,\n\n            open_white_list: 0,\n            visible_for_self: 0,\n            from: \"\",\n\n            // 是否违规\n            is_illegal: false,\n        };\n    },\n    mounted: function() {\n        this.initExtend();\n    },\n    computed: {\n        profile() {\n            return this.$store.state.profile;\n        },\n        level() {\n            return User.getLevel(this.profile?.experience)\n        }\n    },\n    methods: {\n        initExtend() {\n            // 从localStorage中获取hasRead\n            this.hasRead = ~~localStorage.getItem(\"jx3box_has_read\") || 0;\n        },\n        setHasRead() {\n            // 设置hasRead\n            localStorage.setItem(\"jx3box_has_read\", this.hasRead);\n        },\n        loadCommentConfig(category, id) {\n            getCommentConfig(category, id).then((res) => {\n                this.open_white_list = res.data.data?.open_white_list || 0;\n                this.visible_for_self = res.data.data?.visible_for_self || 0;\n            });\n        },\n        setCommentConfig(category, id) {\n            setCommentConfig(category, id, this.open_white_list ? 'open': 'close');\n            setCommentVisible(category, id, this.visible_for_self ? 'open': 'close');\n        },\n        // 去除post_content中的base64图片\n        removeBase64Img(content) {\n            // img左右可能是转义符 &lt;img&gt; 或者 <img>\n            return content.replace(/(&lt;|<)img[^>]*?src=\"data:image[^>]*?(&gt;|>)/gi, \"\");\n        },\n        isExtraLink(url) {\n            // 除了相对路径和*.jx3box.com都是外链\n            if (!url) return false;\n            if (url.startsWith(\"/\")) return false;\n            const domainPattern = /^https?:\\/\\/([^\\/]+\\.)?jx3box\\.com/;\n            if (domainPattern.test(url)) return false;\n            return true;\n        }\n    },\n    created: function() {\n        // 根据访问域名设置默认客户端版本\n        this.post.client = this.$store.state.client;\n    },\n    watch: {\n        $route: {\n            immediate: true,\n            deep: true,\n            handler() {\n                const from = this.$route.query?.from;\n                if (from) {\n                    this.from = from;\n                }\n                this.init();\n            },\n        },\n        // 当为一个新作品时，根据用户偏好修改默认编辑器\n        \"$store.state.user_conf.editor_mode\": {\n            immediate : true,\n            handler : function(mode) {\n                if (!this.id) {\n                    this.post.post_mode = mode || \"tinymce\";\n                }\n            },\n        },\n        \"post.post_content\": {\n            handler: function(val) {\n                if (this.level > 2) {\n                    this.is_illegal = false;\n                    return\n                }\n                // 统计外链数量\n                let count = 0;\n                const regex = /(?:https?:\\/\\/)?([a-zA-Z0-9.-]+\\.[a-zA-Z]{2,})(\\/[a-zA-Z0-9._~:\\/?#[\\]@!$&'()*+,;=-]*)?/gm;\n\n                let links = val.match(regex);\n                if (links) {\n                    for (let link of links) {\n                        if (this.isExtraLink(link)) {\n                            count++;\n                        }\n                    }\n                }\n\n                // 如果外链数量大于5，标记为违规\n                this.is_illegal = count >= 5;\n            }\n        },\n        \"post.content\": {\n            handler: function(val) {\n                if (this.level > 2) {\n                    this.is_illegal = false;\n                    return\n                }\n                // 统计外链数量\n                let count = 0;\n                const regex = /(?:https?:\\/\\/)?([a-zA-Z0-9.-]+\\.[a-zA-Z]{2,})(\\/[a-zA-Z0-9._~:\\/?#[\\]@!$&'()*+,;=-]*)?/gm;\n\n                let links = val.match(regex);\n                if (links) {\n                    for (let link of links) {\n                        if (this.isExtraLink(link)) {\n                            count++;\n                        }\n                    }\n                }\n\n                // 如果外链数量大于5，标记为违规\n                this.is_illegal = count >= 5;\n            }\n        },\n    },\n};\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticClass:\"m-publish-box p-community\"},[_c('publish-header',{attrs:{\"name\":\"魔盒论坛\"}},[_c('publish-revision',{attrs:{\"enable\":true,\"post-id\":_vm.id}})],1),_c('el-form',{attrs:{\"label-position\":\"left\",\"label-width\":\"80px\"}},[_c('publish-title',{model:{value:(_vm.post.title),callback:function ($$v) {_vm.$set(_vm.post, \"title\", $$v)},expression:\"post.title\"}}),_c('div',{staticClass:\"m-publish-info\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"信息\")]),_c('publish-category',{attrs:{\"options\":_vm.tags},model:{value:(_vm.post.category),callback:function ($$v) {_vm.$set(_vm.post, \"category\", $$v)},expression:\"post.category\"}})],1),_c('div',{staticClass:\"m-publish-info m-publish-extraimg\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"魔卡 \"),_c('el-tooltip',{staticClass:\"box-item\",attrs:{\"effect\":\"dark\",\"content\":\"使用魔卡让你的贴贴闪闪发光!\",\"placement\":\"top\"}},[_c('i',{staticClass:\"el-icon-question\"})]),_c('a',{staticClass:\"u-buy el-button el-button--primary el-button--mini is-round\",attrs:{\"href\":\"/vip/mall/list?category=virtual&sub_category=palu\",\"target\":\"_blank\"}},[_c('i',{staticClass:\"el-icon-shopping-cart-full\"}),_vm._v(\" 兑换魔卡\")])],1),(_vm.skins.length)?_c('div',{staticClass:\"u-imgs u-skin-imgs\"},_vm._l((_vm.skins),function(item,i){return _c('div',{key:i,class:`u-imgs-item u-skin ${_vm.post.decoration_id === item.id && 'active'}`,attrs:{\"title\":\"点击使用卡片皮肤，再次点击取消选择\"},on:{\"click\":function($event){return _vm.setSkin(item)}}},[_c('el-image',{attrs:{\"src\":item.url,\"fit\":\"fill\"}}),_c('div',{staticClass:\"u-mark\"},[_c('i',{staticClass:\"el-icon-check\"}),_vm._v(\" 已选择\")]),_c('div',{staticClass:\"u-amount\"},[_vm._v(\"数量 : \"+_vm._s(item.amount))])],1)}),0):_c('div',{staticClass:\"u-null\"},[_vm._v(\" 你还没有任何魔卡，\"),_c('a',{attrs:{\"href\":\"/vip/mall/list?category=virtual&sub_category=palu\",\"target\":\"_blank\"}},[_vm._v(\"点击前往\")]),_vm._v(\"使用积分兑换。 \")])],1),_c('div',{staticClass:\"m-publish-content\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"正文\")]),_c('Tinymce',{directives:[{name:\"show\",rawName:\"v-show\",value:('tinymce'),expression:\"'tinymce'\"}],attrs:{\"attachmentEnable\":true,\"resourceEnable\":true},model:{value:(_vm.post.content),callback:function ($$v) {_vm.$set(_vm.post, \"content\", $$v)},expression:\"post.content\"}})],1),_c('div',{staticClass:\"m-publish-append\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"小册\")]),_c('publish-collection',{attrs:{\"defaultCollapse\":_vm.post.collection_collapse},model:{value:(_vm.post.collection_id),callback:function ($$v) {_vm.$set(_vm.post, \"collection_id\", $$v)},expression:\"post.collection_id\"}})],1),_c('div',{staticClass:\"m-publish-extend\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"设置\")]),_c('el-form-item',{attrs:{\"label\":\"阅读权限\"}},[_c('el-radio-group',{model:{value:(_vm.post.is_self_visit),callback:function ($$v) {_vm.$set(_vm.post, \"is_self_visit\", $$v)},expression:\"post.is_self_visit\"}},[_c('el-radio',{attrs:{\"label\":\"0\"}},[_vm._v(\"公开\")]),_c('el-radio',{attrs:{\"label\":\"1\"}},[_vm._v(\"仅自己可见\")])],1)],1)],1),_c('div',{staticClass:\"m-publish-extend\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"临时\")]),_c('publish-at-authors')],1),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.extraImages.length),expression:\"extraImages.length\"}],staticClass:\"m-publish-extraimg\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"附图\")]),_c('div',{staticClass:\"u-imgs\"},_vm._l((_vm.extraImages),function(item,i){return _c('div',{key:i,class:`u-imgs-item`},[_c('el-image',{staticStyle:{\"width\":\"148px\",\"height\":\"148px\"},attrs:{\"src\":item,\"fit\":\"cover\",\"preview-src-list\":[item]}}),_c('div',{staticClass:\"u-mark\"},[_vm._v(\"封面\")])],1)}),0)],1),_c('div',{staticClass:\"m-publish-doc\"},[(_vm.is_illegal)?_c('el-alert',{staticClass:\"u-illegal-alert\",attrs:{\"closable\":false,\"show-icon\":\"\",\"type\":\"warning\",\"title\":\"检测到您的内容存在不合规，将无法发布成功，并有禁言风险。\"}}):_vm._e(),_c('el-checkbox',{attrs:{\"true-label\":1,\"false-label\":0},model:{value:(_vm.hasRead),callback:function ($$v) {_vm.hasRead=$$v},expression:\"hasRead\"}},[_vm._v(\"我已阅读并了解\"),_c('a',{attrs:{\"href\":\"/notice/119\",\"target\":\"_blank\"},on:{\"click\":function($event){$event.stopPropagation();}}},[_vm._v(\"《创作发布规范》\")])])],1),_c('div',{staticClass:\"m-publish-buttons\"},[[_c('el-button',{attrs:{\"type\":\"primary\",\"disabled\":_vm.processing || !_vm.hasRead},on:{\"click\":function($event){return _vm.publish('publish', true)}}},[_vm._v(\"发    布\")])]],2)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_category.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_category.vue?vue&type=script&lang=js\"","<template>\n    <div class=\"m-category-list\">\n        <span class=\"u-category\">类别</span>\n        <el-radio-group v-model=\"category\" @input=\"updateCategory\">\n            <el-tooltip v-for=\"item in options\" :key=\"item.name\" effect=\"dark\" :content=\"item.remark\" placement=\"top-start\">\n                <el-radio border :label=\"item.name\">{{ item.name }}</el-radio>\n            </el-tooltip>\n        </el-radio-group>\n    </div>\n</template>\n\n<script>\nexport default {\n    props: {\n        options: {\n            type: Array,\n            required: true,\n        },\n        value: {\n            type: [String, Number],\n            default: \"\",\n        },\n    },\n    data() {\n        return {\n            category: this.value,\n        };\n    },\n    watch: {\n        // 监听外部传递的 value 属性的变化\n        value(newVal) {\n            this.category = newVal;\n        },\n        options: {\n            deep: true,\n            immediate: true,\n            handler() {\n                if (!this.value) {\n                    this.category = this.options?.[0]?.name;\n                    this.$emit(\"update\", this.category);\n                }\n            }\n        }\n    },\n    model: {\n        prop: \"value\",\n        event: \"update\",\n    },\n    methods: {\n        // 当 radio-group 内部的 category 变化时，更新到外部的 value 上\n        updateCategory(newVal) {\n            this.$emit(\"update\", newVal);\n        },\n    },\n};\n</script>\n\n<style lang=\"less\">\n.m-category-list {\n    .flex;\n    .u-category {\n        min-width: 80px;\n        .fz(14px);\n        align-items: center;\n    }\n    .el-radio-group {\n        flex: 1;\n        // gap: 12px; /* 设置网格项之间的间隔 */\n        // display: grid;\n        // grid-auto-flow: row; /* 默认值，项目会按行填充 */\n        // grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));\n        // width: 100%; /* 或者设置为特定的宽度 */\n        .el-radio {\n            .w(120px);\n            .mb(10px);\n        }\n    }\n}\n\n@media screen and (max-width: @phone) {\n    .m-category-list {\n        flex-wrap: wrap;\n\n        .el-radio-group {\n            flex: unset;\n            display: grid;\n            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));\n            margin-top: 10px;\n        }\n    }\n}\n</style>\n","import { render, staticRenderFns } from \"./publish_category.vue?vue&type=template&id=434df3b2\"\nimport script from \"./publish_category.vue?vue&type=script&lang=js\"\nexport * from \"./publish_category.vue?vue&type=script&lang=js\"\nimport style0 from \"./publish_category.vue?vue&type=style&index=0&id=434df3b2&prod&lang=less\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"m-category-list\"},[_c('span',{staticClass:\"u-category\"},[_vm._v(\"类别\")]),_c('el-radio-group',{on:{\"input\":_vm.updateCategory},model:{value:(_vm.category),callback:function ($$v) {_vm.category=$$v},expression:\"category\"}},_vm._l((_vm.options),function(item){return _c('el-tooltip',{key:item.name,attrs:{\"effect\":\"dark\",\"content\":item.remark,\"placement\":\"top-start\"}},[_c('el-radio',{attrs:{\"border\":\"\",\"label\":item.name}},[_vm._v(_vm._s(item.name))])],1)}),1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./community.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./community.vue?vue&type=script&lang=js\"","<template>\n    <div class=\"m-publish-box p-community\" v-loading=\"loading\">\n        <!-- 头部 -->\n        <publish-header name=\"魔盒论坛\">\n            <publish-revision :enable=\"true\" :post-id=\"id\"></publish-revision>\n        </publish-header>\n\n        <el-form label-position=\"left\" label-width=\"80px\">\n            <!-- 标题 -->\n            <publish-title v-model=\"post.title\"></publish-title>\n\n            <!-- 信息 -->\n            <div class=\"m-publish-info\">\n                <el-divider content-position=\"left\">信息</el-divider>\n                <!-- 客户端 -->\n                <!-- <publish-client v-model=\"post.client\" :showMobile=\"true\"></publish-client> -->\n                <!-- 类型 -->\n                <publish-category v-model=\"post.category\" :options=\"tags\"></publish-category>\n            </div>\n\n            <div class=\"m-publish-info m-publish-extraimg\">\n                <el-divider content-position=\"left\"\n                    >魔卡\n                    <el-tooltip class=\"box-item\" effect=\"dark\" content=\"使用魔卡让你的贴贴闪闪发光!\" placement=\"top\">\n                        <i class=\"el-icon-question\"></i>\n                    </el-tooltip>\n                    <a\n                        class=\"u-buy el-button el-button--primary el-button--mini is-round\"\n                        href=\"/vip/mall/list?category=virtual&sub_category=palu\"\n                        target=\"_blank\"\n                        ><i class=\"el-icon-shopping-cart-full\"></i> 兑换魔卡</a\n                    >\n                </el-divider>\n                <div class=\"u-imgs u-skin-imgs\" v-if=\"skins.length\">\n                    <div\n                        @click=\"setSkin(item)\"\n                        :class=\"`u-imgs-item u-skin ${post.decoration_id === item.id && 'active'}`\"\n                        v-for=\"(item, i) in skins\"\n                        :key=\"i\"\n                        title=\"点击使用卡片皮肤，再次点击取消选择\"\n                    >\n                        <el-image :src=\"item.url\" fit=\"fill\" />\n                        <div class=\"u-mark\"><i class=\"el-icon-check\"></i> 已选择</div>\n                        <div class=\"u-amount\">数量 : {{ item.amount }}</div>\n                    </div>\n                </div>\n                <div v-else class=\"u-null\">\n                    你还没有任何魔卡，<a href=\"/vip/mall/list?category=virtual&sub_category=palu\" target=\"_blank\"\n                        >点击前往</a\n                    >使用积分兑换。\n                </div>\n            </div>\n\n            <!-- 正文 -->\n            <div class=\"m-publish-content\">\n                <el-divider content-position=\"left\">正文</el-divider>\n                <Tinymce v-model=\"post.content\" :attachmentEnable=\"true\" :resourceEnable=\"true\" v-show=\"'tinymce'\" />\n            </div>\n\n            <!-- 附加 -->\n\n            <div class=\"m-publish-append\">\n                <el-divider content-position=\"left\">小册</el-divider>\n                <publish-collection v-model=\"post.collection_id\" :defaultCollapse=\"post.collection_collapse\">\n                </publish-collection>\n            </div>\n\n            <!-- 扩展 -->\n            <div class=\"m-publish-extend\">\n                <el-divider content-position=\"left\">设置</el-divider>\n                <el-form-item label=\"阅读权限\">\n                    <el-radio-group v-model=\"post.is_self_visit\">\n                        <el-radio label=\"0\">公开</el-radio>\n                        <el-radio label=\"1\">仅自己可见</el-radio>\n                    </el-radio-group>\n                </el-form-item>\n            </div>\n\n            <!-- 临时 -->\n            <div class=\"m-publish-extend\">\n                <el-divider content-position=\"left\">临时</el-divider>\n                <publish-at-authors></publish-at-authors>\n            </div>\n\n            <!-- 附图 -->\n            <div class=\"m-publish-extraimg\" v-show=\"extraImages.length\">\n                <el-divider content-position=\"left\">附图</el-divider>\n                <div class=\"u-imgs\">\n                    <div :class=\"`u-imgs-item`\" v-for=\"(item, i) in extraImages\" :key=\"i\">\n                        <el-image :src=\"item\" fit=\"cover\" style=\"width: 148px; height: 148px\" :preview-src-list=\"[item]\" />\n                        <div class=\"u-mark\">封面</div>\n                    </div>\n                </div>\n            </div>\n\n            <div class=\"m-publish-doc\">\n                <el-alert class=\"u-illegal-alert\" v-if=\"is_illegal\" :closable=\"false\" show-icon type=\"warning\" title=\"检测到您的内容存在不合规，将无法发布成功，并有禁言风险。\"></el-alert>\n                <el-checkbox v-model=\"hasRead\" :true-label=\"1\" :false-label=\"0\"\n                    >我已阅读并了解<a href=\"/notice/119\" @click.stop target=\"_blank\">《创作发布规范》</a></el-checkbox\n                >\n            </div>\n\n            <!-- 按钮 -->\n            <div class=\"m-publish-buttons\">\n                <template>\n                    <el-button type=\"primary\" @click=\"publish('publish', true)\" :disabled=\"processing || !hasRead\"\n                        >发 &nbsp;&nbsp; 布</el-button\n                    >\n                </template>\n            </div>\n        </el-form>\n    </div>\n</template>\n\n<script>\nimport { __imgPath } from \"@jx3box/jx3box-common/data/jx3box.json\";\n// 公共模块\nimport community_types from \"@/assets/data/community.json\";\n\nimport { push, pull, update, setVisibility, pullAdmin, updateAdmin } from \"@/service/community.js\";\n\n// 本地模块\nimport Tinymce from \"@jx3box/jx3box-editor/src/Tinymce\";\n\nimport publish_header from \"@/components/publish_header.vue\";\nimport publish_title from \"@/components/publish_title.vue\";\nimport publish_collection from \"@/components/publish_collection\";\nimport publish_revision from \"@/components/publish_revision.vue\";\nimport publish_category from \"@/components/publish_category.vue\";\nimport publish_at_authors from \"@/components/publish_at_authors.vue\";\n\n// 数据逻辑\nimport { getTopicBucket } from \"@/service/cms.js\";\nimport { cmsMetaMixin } from \"@/utils/cmsMetaMixin\";\nimport { atAuthorMixin } from \"@/utils/atAuthorMixin\";\nimport { getDecoration } from \"@jx3box/jx3box-common-ui/service/cms\";\nimport { appendToCollection } from \"@/service/collection.js\";\n\nexport default {\n    name: \"community\",\n    mixins: [cmsMetaMixin, atAuthorMixin],\n    components: {\n        Tinymce,\n        \"publish-header\": publish_header,\n        \"publish-title\": publish_title,\n        \"publish-collection\": publish_collection,\n        \"publish-revision\": publish_revision,\n        \"publish-category\": publish_category,\n        // \"publish-client\": publish_client,\n        \"publish-at-authors\": publish_at_authors,\n    },\n    data: function () {\n        return {\n            skins: [],\n            // 加载状态\n            loading: false,\n            // 发布状态\n            processing: false,\n\n            // 内容\n            post: {\n                // 文章ID\n                id: \"\",\n                client: \"all\",\n                // 皮肤id\n                decoration_id: \"\",\n                // 分类\n                category: \"\",\n                // 标题\n                title: \"\",\n                // 内容\n                content: \"\",\n\n                // 小册id\n                collection_id: \"\",\n\n                is_self_visit: \"0\",\n\n                is_from_phone: 0\n            },\n            currentDecorationId: \"\",\n            // 选项\n            community_types,\n            tags: [],\n            buckets: [],\n\n            post_type: \"community\",\n            extraImages: [],\n        };\n    },\n    computed: {\n        // extraImages() {\n        //     const imgs = this.getImgSrc(this.post.content);\n\n        //     return [...new Set(imgs)];\n        // },\n\n        id: function () {\n            return ~~this.post.id;\n        },\n        data: function () {\n            return {\n                ...this.post,\n                category: this.post.category,\n                collection_id: this.post.collection_id || undefined,\n                decoration_id: this.post.decoration_id || undefined,\n                extra_images: this.extraImages,\n                introduction: this.getIntroduction(this.post.content),\n            };\n        },\n    },\n    mounted() {\n        this.getTopicBucket();\n        const id = this.$route.params.id;\n        if (id) {\n            this.post.id = id;\n            this.loadCommentConfig(\"community\", id);\n        }\n        this.post.client = \"all\";\n\n        // 判断提交是否来自手机\n        if (window.navigator.userAgent.match(/(iPhone|iPod|Android|ios)/i) && !this.post.is_from_phone) {\n            this.post.is_from_phone = 1;\n        }\n    },\n    methods: {\n        goShopping(e) {\n            window.open(\"/vip/mall/list?category=virtual&sub_category=palu\", \"_blank\");\n            e.preventDefault();\n            e.stopPropagation();\n        },\n        setSkin(data) {\n            if (data.amount <= 0 && data.id != this.currentDecorationId) {\n                this.$message({\n                    message: \"该皮肤已经被使用完了\",\n                    type: \"warning\",\n                });\n                return;\n            }\n            if (this.post.decoration_id == data.id) {\n                this.post.decoration_id = \"\";\n            } else {\n                this.post.decoration_id = data.id;\n            }\n        },\n        getDecoration() {\n            getDecoration({ type: \"palu\" })\n                .then((res) => {\n                    const list = res.data.data || [];\n                    const skins = list.filter((item) => item.amount > 0 || item.id == this.currentDecorationId);\n                    this.skins = skins.map((item) => {\n                        return {\n                            val: item.val,\n                            id: item.id,\n                            amount: item.amount,\n                            url: __imgPath + `decoration/palu/${item.val}.png`,\n                        };\n                    });\n                })\n                .catch(() => {\n                    this.skins = [];\n                });\n        },\n        getIntroduction(str) {\n            // 使用正则表达式匹配HTML标签并将其替换为空字符串\n            const withoutTags = str.replace(/<[^>]*>|\\n|&nbsp;| &nbsp;/g, \"\");\n\n            // 获取前100个字符，如果字符串长度小于200，则获取全部字符\n            return withoutTags.slice(0, 200);\n        },\n        // 初始化\n        init: function () {\n            // 尝试加载\n            sessionStorage.removeItem(\"atAuthor\");\n            const id = this.$route.params.id;\n            if (!id) {\n                this.getDecoration();\n                return;\n            }\n            const fn = this.from === 'admin' ? pullAdmin : pull;\n            fn(id).then((res) => {\n                const data = res.data.data;\n                this.currentDecorationId = data.decoration_id;\n                this.post = {\n                    ...data,\n                    title: data.title,\n                    content: data.content,\n                    collection_id: data.collection_id,\n                    is_self_visit: String(data.is_self_visit),\n                };\n                this.getDecoration();\n            });\n        },\n        // 发布\n        publish: function () {\n            this.loading = true;\n            if (this.data.id) {\n                const fn = this.from === 'admin' ? updateAdmin : update;\n                fn(this.data.id, this.data)\n                    .then((res) => {\n                        this.$message({\n                            message: \"更新成功\",\n                            type: \"success\",\n                        });\n\n                        this.atUser(this.data.id);\n                        // 设置可见性\n                        setVisibility(this.data.id, this.post.is_self_visit);\n\n                    }).then(() => {\n                        this.afterPublish({\n                            id: this.data.id,\n                            collection_id: this.data.collection_id,\n                            title: this.data.title,\n                        }).then(() => {\n                            // 跳转\n                        setTimeout(() => {\n                            location.href = `/community/${this.post.id}`;\n                        }, 500);\n                        })\n                    }).finally(() => {\n                        this.loading = false;\n                    });\n            } else {\n                push(this.data)\n                    .then((res) => {\n                        const result = res.data.data\n                        this.$message({\n                            message: \"发布成功\",\n                            type: \"success\",\n                        });\n\n                        const id = res.data.data.id;\n\n                        setVisibility(id, this.post.is_self_visit);\n\n                        this.atUser(id);\n\n                        return result;\n                        // 跳转\n                    }).then(result => {\n                        this.afterPublish(result).then(() => {\n                            setTimeout(() => {\n                                location.href = `/community/${result.id}`;\n                            }, 500);\n                        })\n                    }).finally(() => {\n                        this.loading = false;\n                    });\n            }\n\n            // t\n        },\n        getImgSrc: function (htmlString) {\n            // 创建一个正则表达式来匹配没有class属性的<img>标签，并且捕获src属性的值\n            const imgSrcRegex = /<img\\s+(?![^>]*\\bclass\\b)[^>]*?src=\"([^\"]*)\"/g;\n            let matches;\n            const imgSrcs = [];\n\n            // 使用正则表达式全局匹配HTML字符串中的所有<img>标签\n            while ((matches = imgSrcRegex.exec(htmlString)) !== null) {\n                // matches[1] 是正则表达式中捕获组的内容，即src的值\n                imgSrcs.push(matches[1]);\n            }\n\n            return imgSrcs;\n        },\n        getTopicBucket() {\n            getTopicBucket({ type: \"community\" }).then((res) => {\n                const data = res.data.data;\n                this.tags = [...data];\n            });\n        },\n        // 跳转前操作\n        afterPublish: function (result) {\n            if (!~~result.collection_id) {\n                return new Promise((resolve, reject) => {\n                    resolve(true);\n                });\n            }\n            return appendToCollection({\n                post_type: 'community',\n                post_id: result.id,\n                post_collection: result.collection_id,\n                post_title: result.title,\n            });\n        },\n    },\n    watch: {\n        'post.content': {\n            handler: function (val) {\n                const imgs = this.getImgSrc(val);\n\n                this.extraImages = [...new Set(imgs)];\n            },\n            immediate: true,\n        }\n    },\n};\n</script>\n\n<style lang=\"less\">\n.m-publish-extraimg {\n    .u-buy {\n        margin-left: 10px;\n        padding: 5px 8px;\n        background-color: #444;\n        border-color: #444;\n    }\n    .u-null {\n        .fz(12px);\n        color: #999;\n        a {\n            text-decoration: underline;\n        }\n    }\n    .u-imgs {\n        display: flex;\n        overflow-x: auto;\n        gap: 8px;\n    }\n    .u-imgs-item {\n        min-width: 148px;\n        overflow: hidden;\n        border-radius: 6px;\n        box-sizing: border-box;\n        height: 148px;\n        cursor: pointer;\n        position: relative;\n        border: 2px solid transparent;\n        transition: 0.35s;\n        background-color: @bg-light;\n        &:hover {\n            border-color: #0366d6;\n        }\n        &.active {\n            border-color: #0366d6;\n            .u-mark {\n                display: block;\n            }\n        }\n        img {\n            width: 100%;\n        }\n        .u-mark {\n            display: none;\n            position: absolute;\n            top: 2px;\n            right: 2px;\n            padding: 4px 8px;\n            font-size: 12px;\n            background-color: #0366d6;\n            color: white;\n            border-radius: 4px;\n        }\n    }\n    .u-skin-imgs {\n        overflow-x: scroll;\n        padding-bottom: 20px;\n        .u-imgs-item {\n            position: relative;\n            width: 260px;\n            height: 50px;\n            box-shadow: rgba(50, 50, 93, 0.25) 0px 2px 5px -1px, rgba(0, 0, 0, 0.3) 0px 1px 3px -1px;\n            .el-image {\n                width: 100%;\n                height: 100%;\n            }\n            .u-mark {\n                left: 2px;\n                right: initial !important;\n            }\n        }\n        .u-amount {\n            font-size: 12px;\n            position: absolute;\n            .rb(0);\n            background-color: rgba(0, 0, 0, 0.6);\n            color: #fff;\n            padding: 2px 2px 2px 6px;\n            border-bottom-right-radius: 2px;\n        }\n    }\n}\n</style>\n","import { render, staticRenderFns } from \"./community.vue?vue&type=template&id=3ad1ac18\"\nimport script from \"./community.vue?vue&type=script&lang=js\"\nexport * from \"./community.vue?vue&type=script&lang=js\"\nimport style0 from \"./community.vue?vue&type=style&index=0&id=3ad1ac18&prod&lang=less\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"m-publish-title\"},[(!_vm.hideDiv)?_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_vm._v(\"标题\")]):_vm._e(),_c('el-input',{attrs:{\"maxlength\":50,\"minlength\":2,\"show-word-limit\":\"\",\"required\":\"\",\"placeholder\":_vm.placeholder || '请填写标题'},model:{value:(_vm.title),callback:function ($$v) {_vm.title=$$v},expression:\"title\"}}),_vm._t(\"default\")],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_title.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_title.vue?vue&type=script&lang=js\"","<template>\n    <div class=\"m-publish-title\">\n        <el-divider content-position=\"left\" v-if=\"!hideDiv\">标题</el-divider>\n        <el-input\n            v-model=\"title\"\n            :maxlength=\"50\"\n            :minlength=\"2\"\n            show-word-limit\n            required\n            :placeholder=\"placeholder || '请填写标题'\"\n        ></el-input>\n        <slot></slot>\n    </div>\n</template>\n<script>\nexport default {\n    name: \"publish_title\",\n    props: [\"data\",\"hideDiv\",\"placeholder\"],\n    data: function () {\n        return {\n            title: this.data,\n        };\n    },\n    model: {\n        prop: \"data\",   //向上同步数据\n        event: \"update\",\n    },\n    watch: {\n        data: function(newval) {\n            this.title = newval;\n        },\n        title: {\n            deep: true,\n            handler: function(newval) {\n                this.$emit(\"update\", newval);\n            },\n        },\n    },\n    computed: {},\n    methods: {},\n    mounted: function () {},\n    components: {},\n};\n</script>\n","import { render, staticRenderFns } from \"./publish_title.vue?vue&type=template&id=d0fa58d6\"\nimport script from \"./publish_title.vue?vue&type=script&lang=js\"\nexport * from \"./publish_title.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_at_authors.vue?vue&type=style&index=0&id=07522ff3&prod&lang=less&scoped=true\"","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_header.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./publish_header.vue?vue&type=script&lang=js\"","<template>\n    <div class=\"m-publish-header\">\n        <el-page-header @back=\"goBack\" :content=\"name\"></el-page-header>\n        <slot></slot>\n    </div>\n</template>\n\n<script>\nexport default {\n    name: \"publish_header\",\n    props: [\"name\"],\n    data: function() {\n        return {\n        };\n    },\n    computed: {},\n    methods: {\n        goBack: function() {\n            if(window.history.length){\n                this.$router.go(-1);\n            }else{\n                this.$router.push('/')\n            }\n        },\n    },\n    mounted: function() {},\n    components: {\n    },\n};\n</script>\n\n<style lang=\"less\">\n    .m-publish-header{\n        .pr;\n    }\n    \n</style>","import { render, staticRenderFns } from \"./publish_header.vue?vue&type=template&id=36319e52\"\nimport script from \"./publish_header.vue?vue&type=script&lang=js\"\nexport * from \"./publish_header.vue?vue&type=script&lang=js\"\nimport style0 from \"./publish_header.vue?vue&type=style&index=0&id=36319e52&prod&lang=less\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"m-publish-header\"},[_c('el-page-header',{attrs:{\"content\":_vm.name},on:{\"back\":_vm.goBack}}),_vm._t(\"default\")],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }"],"sourceRoot":""}
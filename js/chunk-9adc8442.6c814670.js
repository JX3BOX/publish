(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-9adc8442"],{"180e":function(t,e,n){},3455:function(t){t.exports=JSON.parse('{"publish":"公开","draft":"草稿","pending":"待审核","dustbin":"已删除"}')},"63d8":function(t,e,n){"use strict";n.r(e);n("4de4"),n("d3b7"),n("ac1f"),n("841c");var a=[function(){var t=this._self._c;return t("i",{staticClass:"u-icon"},[t("img",{attrs:{src:n("d850")}})])}],i=(n("99af"),n("caad"),n("fb6a"),n("2532"),n("81fc")),c=n("fb92"),s=n("3455"),o=n("2ef0"),u={name:"work",props:[],data:function(){return{loading:!1,data:[],total:1,page:1,per:10,content:"",client:"",search:"",statusMap:s,activeTab:"topic"}},computed:{type:function(){return this.$route.params.type},params:function(){return{type:this.type,title:this.search||void 0,pageSize:this.per,index:this.page,client:this.client}},publishLink:function(){return"./#/community"},showWujie:function(){return["bps","pvp","bbs"].includes(this.type)}},watch:{type:{deep:!0,immediate:!0,handler:function(t){this.page=1}},params:{deep:!0,immediate:!0,handler:function(t){this.loadPosts()}},activeTab:{immediate:!0,handler:function(){this.page=1,this.loadPosts()}}},methods:{getStatusCn:function(t){switch(t){case 1:return"正常";case 2:return"待审核";case 3:return"审核未通过";default:return"未知状态"}},loadPosts:function(){var t=this;if(this.loading=!0,this.data=[],"topic"==this.activeTab)Object(i.e)(this.params).then((function(e){t.data=e.data.data.list,t.total=e.data.data.page.total})).finally((function(){t.loading=!1}));else{var e=Object(o.pick)(this.params,["pageSize","index"]);this.search&&(e.content=this.search),Object(i.g)(e).then((function(e){t.data=e.data.data.list,t.total=e.data.data.page.total})).finally((function(){t.loading=!1}))}},edit:function(t){var e="topic"==this.activeTab?"community":"community_reply",n=this.$router.resolve({name:e,params:{id:t.id}});window.open(n.href,"_blank")},del:function(t){var e=this;this.$alert("确定要删除吗？","确认信息",{confirmButtonText:"确定",callback:function(n){"confirm"==n&&("topic"==e.activeTab?i.a:i.c)(t.id).then((function(){e.$message({type:"success",message:"删除成功"}),e.page=1,e.loadPosts()}))}})},draft:function(t,e){var n=this;push(t,{publish_status:"draft"}).then((function(t){n.$message({type:"success",message:"操作成功"}),n.data[e].post_status="draft"}))},publish:function(t,e){var n=this;push(t,{publish_status:"publish"}).then((function(t){n.$message({type:"success",message:"操作成功"}),n.data[e].post_status="publish"}))},postLink:function(t){return"topic"==this.activeTab?"/community/".concat(t.id):"/community/".concat(t.topic_id)},filter:function(t){this.page=1,this[t.type]=t.val},isSimpleType:function(t){return simpleTypes.includes(t)},getContent:function(t){var e,n=t.content;return n?"#".concat(t.floor," 回复：").concat(null==t||null===(e=t.topic)||void 0===e?void 0:e.title)+n.slice(0,12)+"...":""}},filters:{dateFormat:function(t){return Object(c.a)(new Date(t))},typeFormat:function(t){return __postType[t]},visibleFormat:function(t){return console.log(t),__visibleMap[~~t]},statusFormat:function(t){return s[t]}}},r=(n("eec7"),n("2877")),l=Object(r.a)(u,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-dashboard-work m-dashboard-cms p-cms-community"},[e("div",{staticClass:"m-dashboard-work-header"},[e("h2",{staticClass:"u-title"},[t._v("论坛")]),e("a",{staticClass:"u-publish el-button el-button--primary el-button--small",attrs:{href:t.publishLink}},[e("i",{staticClass:"el-icon-document"}),t._v(" 发布作品 ")])]),e("el-tabs",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[e("el-tab-pane",{attrs:{label:"主题",name:"topic"}}),e("el-tab-pane",{attrs:{label:"回帖",name:"reply"}})],1),e("el-input",{staticClass:"m-dashboard-work-search",attrs:{placeholder:"请输入搜索内容"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}},[e("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("关键词")]),e("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1),"topic"==t.activeTab?e("div",{staticClass:"m-dashboard-work-filter"},[e("clientBy",{staticClass:"u-client",attrs:{showWujie:t.showWujie},on:{filter:t.filter}})],1):t._e(),e("div",{staticClass:"m-dashboard-box"},[t.data&&t.data.length?e("ul",{staticClass:"m-dashboard-box-list"},t._l(t.data,(function(n,a){return e("li",{key:a},[t._m(0,!0),e("a",{staticClass:"u-title",attrs:{target:"_blank",href:t.postLink(n)}},["topic"==t.activeTab?e("span",[t._v(t._s(n.title||n.content||"无标题"))]):e("span",{staticClass:"u-title_content",domProps:{innerHTML:t._s(t.getContent(n))}})]),e("div",{staticClass:"u-desc"},[e("time",{staticClass:"u-desc-subitem"},[e("i",{staticClass:"el-icon-finished"}),t._v(" 发布 : "+t._s(t._f("dateFormat")(n.created_at))+" ")]),e("time",{staticClass:"u-desc-subitem"},[e("i",{staticClass:"el-icon-refresh"}),t._v(" 更新 : "+t._s(t._f("dateFormat")(n.updated_at))+" ")]),e("time",{staticClass:"u-desc-subitem"},[e("i",{staticClass:"el-icon-receiving"}),t._v(" 状态 : "+t._s(t.getStatusCn(n.status))+" ")])]),e("el-button-group",{staticClass:"u-action"},[e("el-button",{attrs:{size:"mini",icon:"el-icon-edit",title:"编辑"},on:{click:function(e){return t.edit(n)}}}),e("el-button",{attrs:{size:"mini",icon:"el-icon-delete",title:"删除"},on:{click:function(e){return t.del(n)}}})],1)],1)})),0):e("el-alert",{staticClass:"m-dashboard-box-null",attrs:{title:"没有找到相关条目",type:"info",center:"","show-icon":""}}),e("el-pagination",{staticClass:"m-dashboard-box-pages",attrs:{background:"","page-size":t.per,"hide-on-single-page":!0,"current-page":t.page,layout:"total, prev, pager, next, jumper",total:t.total},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e}}})],1)],1)}),a,!1,null,null,null);e.default=l.exports},"81fc":function(t,e,n){"use strict";n.d(e,"i",(function(){return i})),n.d(e,"e",(function(){return s})),n.d(e,"a",(function(){return o})),n.d(e,"h",(function(){return u})),n.d(e,"j",(function(){return c})),n.d(e,"g",(function(){return r})),n.d(e,"f",(function(){return l})),n.d(e,"c",(function(){return d})),n.d(e,"k",(function(){return p})),n.d(e,"d",(function(){return m})),n.d(e,"b",(function(){return f}));n("99af");var a=n("41cb");function i(t){return Object(a.c)().post("".concat("/api/next2","/community/discussion/topic"),t)}function c(t,e){return Object(a.c)().put("".concat("/api/next2","/community/discussion/my/topic/item/").concat(t),e)}function s(t){return Object(a.c)().get("".concat("/api/next2","/community/discussion/my/topic/list"),{params:t})}function o(t){return Object(a.c)().delete("".concat("/api/next2","/community/discussion/my/topic/item/").concat(t))}function u(t){return Object(a.c)().get("".concat("/api/next2","/community/discussion/my/topic/item/").concat(t))}function r(t){return Object(a.c)().get("".concat("/api/next2","/community/discussion/my/reply/list"),{params:t})}function l(t){return Object(a.c)().get("".concat("/api/next2","/community/discussion/my/reply/item/").concat(t))}function d(t){return Object(a.c)().delete("".concat("/api/next2","/community/discussion/my/reply/item/").concat(t))}function p(t,e){return Object(a.c)().put("".concat("/api/next2","/community/discussion/my/reply/item/").concat(t),e)}function m(t){return Object(a.c)().get("".concat("/api/next2","/community/discussion/my/comment/list"),{params:t})}function f(t){return Object(a.c)().delete("".concat("/api/next2","/community/discussion/my/comment/item/").concat(t))}},d850:function(t,e,n){t.exports=n.p+"img/repo.e8c2e45e.svg"},eec7:function(t,e,n){"use strict";n("180e")},fb92:function(t,e,n){"use strict";n("99af");function a(t){return t<10?"0"+t:t}e.a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=t.getFullYear(),c=t.getMonth()+1,s=t.getDate(),o=n?"".concat(i).concat(e).concat(a(c)).concat(e).concat(a(s)):"".concat(i).concat(e).concat(c).concat(e).concat(s);return o}}}]);
//# sourceMappingURL=chunk-9adc8442.6c814670.js.map